
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pyREX.analysis package &#8212; pyREX 0.8 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="pyREX.decoy package" href="pyREX.decoy.html" />
    <link rel="prev" title="pyREX package" href="pyREX.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="pyrex-analysis-package">
<h1>pyREX.analysis package<a class="headerlink" href="#pyrex-analysis-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-pyREX.analysis.analysis">
<span id="pyrex-analysis-analysis-module"></span><h2>pyREX.analysis.analysis module<a class="headerlink" href="#module-pyREX.analysis.analysis" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="pyREX.analysis.analysis.PLOT">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.analysis.</span></code><code class="sig-name descname"><span class="pre">PLOT</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.analysis.PLOT" title="Permalink to this definition">¶</a></dt>
<dd><p>General plot function for analysis.py</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xdata</strong> (<em>array/list</em>) – </p></li>
<li><p><strong>ydata</strong> (<em>array/list</em>) – </p></li>
<li><p><strong>xlabel</strong> (<em>str</em>) – </p></li>
<li><p><strong>ylabel</strong> (<em>str</em>) – </p></li>
<li><p><strong>title</strong> (<em>None/str</em>) – </p></li>
<li><p><strong>xlim</strong> (<em>None/list</em>) – </p></li>
<li><p><strong>ylim</strong> (<em>None/list</em>) – </p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Kwargs:</dt><dd><p># see args of misc.figure()</p>
<p>“alpha”: 0.3
“color”: “r”
“lw”: 1.5
“ms”: 1
“marker”: “.”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>fig (matplotlib.figure.Figure)
ax (ax/list of axes ~ matplotlib.axes._subplots.Axes)</p>
</dd>
</dl>
<p class="rubric">Example</p>
<dl class="simple">
<dt>&gt;&gt; PLOT(TIME, RMSD, xlabel=”time (ns)”, ylabel=r”RMSD ($AA$)”, title=”RMSD plot”,</dt><dd><p>xlim=[50, 500], ylim=[0, 20])</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.analysis.align_resids">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.analysis.</span></code><code class="sig-name descname"><span class="pre">align_resids</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mobile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.analysis.align_resids" title="Permalink to this definition">¶</a></dt>
<dd><p>Align resids of mobile and ref by comparing universe.residues.resnames and
shifting the resids of reference (usually smaller than mobile).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mobile</strong> (<em>MDA universe</em>) – </p></li>
<li><p><strong>ref</strong> (<em>MDA universe</em>) – </p></li>
<li><p><strong>norm</strong> (<em>bool</em>) – apply analysis.norm_resids()</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Kwargs:</dt><dd><p>cprint_color (None/str): colored print color</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.analysis.alignto">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.analysis.</span></code><code class="sig-name descname"><span class="pre">alignto</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mobile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mass'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol_mass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.analysis.alignto" title="Permalink to this definition">¶</a></dt>
<dd><dl>
<dt>Modified version of MDAnalysis.analysis.align.alignto()</dt><dd><p>-&gt; now works properly with two different selection strings</p>
</dd>
<dt>Description:</dt><dd><p>Perform a spatial superposition by minimizing the RMSD.</p>
<p>Spatially align the group of atoms <cite>mobile</cite> to <cite>reference</cite> by doing a
RMSD fit on <cite>sel1</cite> of mobile atoms and <cite>sel1</cite> of referece atoms.</p>
<p>The superposition is done in the following way:</p>
<ol class="arabic simple">
<li><p>A rotation matrix is computed that minimizes the RMSD between
the coordinates of <cite>mobile.select_atoms(sel1)</cite> and
<cite>reference.select_atoms(sel2)</cite>; before the rotation, <cite>mobile</cite> is
translated so that its center of geometry (or center of mass)
coincides with the one of <cite>reference</cite>. (See below for explanation of
how <em>sel1</em> and <em>sel2</em> are derived from <cite>select</cite>.)</p></li>
<li><p>All atoms in <code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code> that
contain <cite>mobile</cite> are shifted and rotated. (See below for how
to change this behavior through the <cite>subselection</cite> keyword.)</p></li>
</ol>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mobile</strong> (<em>MDA universe</em>) – mobile structure</p></li>
<li><p><strong>ref</strong> (<em>MDA universe</em>) – reference structure</p></li>
<li><p><strong>sel1</strong> (<em>str</em>) – selection string of mobile structure</p></li>
<li><p><strong>sel2</strong> (<em>str</em>) – selection string of reference structure</p></li>
<li><p><strong>weights</strong> (<em>None/str/array</em>) – <p>None: weigh each atom equally
“mass”: weigh atoms based on mass
array: If a float array of the same length as <cite>mobile</cite> is provided,</p>
<blockquote>
<div><p>use each element of the <cite>array_like</cite> as a weight for the
corresponding atom in <cite>mobile</cite>.</p>
</div></blockquote>
</p></li>
<li><p><strong>tol_mass</strong> (<em>float</em>) – Reject match if the atomic masses for matched atoms
differ by more than <cite>tol_mass</cite>, default [0.1]</p></li>
<li><p><strong>strict</strong> (<em>bool</em>) – <dl class="simple">
<dt>True: Will raise <code class="xref py py-exc docutils literal notranslate"><span class="pre">SelectionError</span></code> if a single atom does not</dt><dd><p>match between the two selections.</p>
</dd>
<dt>False:  Will try to prepare a matching selection by dropping</dt><dd><p>residues with non-matching atoms.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">ching_atoms()</span></code> for details.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>RMSD before spatial alignment
new_rmsd (float): RMSD after spatial alignment</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>old_rmsd (float)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.analysis.dump_structure">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.analysis.</span></code><code class="sig-name descname"><span class="pre">dump_structure</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_as</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./structures'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'protein'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.analysis.dump_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Dump structures for a list of frames with the file name “save_as”.
Automatically prepends frame number to the extension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>MDA universe/atomgrp</em>) – universe containing the structure</p></li>
<li><p><strong>frames</strong> (<em>array/list</em>) – </p></li>
<li><p><strong>save_as</strong> (<em>str</em>) – save name or realpath to save file
Note: frame number will be prepended to the extension</p></li>
<li><p><strong>default_dir</strong> (<em>str</em>) – </p></li>
<li><p><strong>sel</strong> (<em>str</em>) – selection string</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>realpath to directory, where structures were dumped</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dirpath (str)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.analysis.get_Distance_Matrices">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.analysis.</span></code><code class="sig-name descname"><span class="pre">get_Distance_Matrices</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mobile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[None,</span> <span class="pre">None,</span> <span class="pre">None]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'protein</span> <span class="pre">and</span> <span class="pre">name</span> <span class="pre">CA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flatten</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.analysis.get_Distance_Matrices" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate distance matrices for mobile and return them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mobile</strong> (<em>MDA universe/list</em>) – (MDA universe): structure with trajectory
(list): list with paths to structure files (.pdb)</p></li>
<li><p><strong>sss</strong> (<em>list</em>) – [start, stop, step]
start (None/int): start frame
stop (None/int): stop frame
step (None/int): step size</p></li>
<li><p><strong>sel</strong> (<em>str</em>) – selection string</p></li>
<li><p><strong>flatten</strong> (<em>bool</em>) – returns flattened distance matrices</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – show progress bar</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Kwargs:</dt><dd><p>dtype (dtype): float (default)
aliases for sss items:</p>
<blockquote>
<div><p>start (None/int): start frame
stop (None/int): stop frame
step (None/int): step size</p>
</div></blockquote>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>array of distance matrices</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>DM (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.analysis.get_FASTA">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.analysis.</span></code><code class="sig-name descname"><span class="pre">get_FASTA</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdb_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.analysis.get_FASTA" title="Permalink to this definition">¶</a></dt>
<dd><p>get FASTA sequence for each polypeptide of pdb_file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pdb_file</strong> (<em>str</em>) – path to pdb_file</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – print sequences</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list with FASTA sequences (one per polypeptide)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>FASTA (list)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.analysis.get_RMSD">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.analysis.</span></code><code class="sig-name descname"><span class="pre">get_RMSD</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mobile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'backbone'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'backbone'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mass'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alt_return</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.analysis.get_RMSD" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the RMSD between mobile and ref after superimposing (translation and rotation).
Alias function of MDAnalysis.analysis.rms.RMSD. See help(MDAnalysis.analysis.rms.RMSD) for more information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mobile</strong> (<em>MDA universe/atomgrp</em>) – mobile structure</p></li>
<li><p><strong>ref</strong> (<em>MDA universe/atomgrp</em>) – reference structure</p></li>
<li><p><strong>sel1</strong> (<em>str</em>) – selection string of mobile structure</p></li>
<li><p><strong>sel2</strong> (<em>str</em>) – selection string of reference structure</p></li>
<li><p><strong>weights</strong> (<em>bool/str/array_like</em>) – <p>weights during superposition of mobile and reference
None: no weights
“mass”: atom masses as weights
array_like: If a float array of the same length as “mobile” is provided, use</p>
<blockquote>
<div><p>each element of the “array_like” as a weight for the corresponding
atom in “mobile”.</p>
</div></blockquote>
</p></li>
<li><p><strong>plot</strong> (<em>bool</em>) – create plot</p></li>
<li><p><strong>alt_return</strong> (<em>bool</em>) – <p>alternative return datatype
True:</p>
<blockquote>
<div><dl class="simple">
<dt>ftr_tuple = RMSD()    # tuple of arrays with shape (length, )</dt><dd><p># ftr: frame, time, rmsd</p>
</dd>
</dl>
<p>frame= ftr_tuple[0]
time = ftr_tuple[1]
rmsd = ftr_tuple[2]</p>
</div></blockquote>
<dl>
<dt>False:</dt><dd><dl class="simple">
<dt>ftr_array = get_RMSD()    # single array  with shape (length, 3)</dt><dd><p># ftr: frame, time, rmsd</p>
</dd>
</dl>
<p>frame= ftr_array[:,0]
time = ftr_array[:,1]
rmsd = ftr_array[:,2]</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Kwargs:</dt><dd><p>see help(misc.figure)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p>ftr_tuple (tuple)    # ftr: frame, time, rmsd
if alt_return == False:</p>
<blockquote>
<div><p>ftr_array (array)    # ftr: frame, time, rmsd</p>
</div></blockquote>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>if alt_return == True</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.analysis.get_RMSF">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.analysis.</span></code><code class="sig-name descname"><span class="pre">get_RMSF</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mobile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'protein</span> <span class="pre">and</span> <span class="pre">name</span> <span class="pre">CA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.analysis.get_RMSF" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the RMSF of mobile.
Alias function of MDAnalysis.analysis.rms.RMSF.
See help(MDAnalysis.analysis.rms.get_RMSF) for more information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mobile</strong> (<em>MDA universe/atomgrp</em>) – mobile structure</p></li>
<li><p><strong>sel</strong> (<em>str</em>) – selection string</p></li>
<li><p><strong>plot</strong> (<em>bool</em>) – create plot</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>RMSF (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.analysis.get_matching_selection">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.analysis.</span></code><code class="sig-name descname"><span class="pre">get_matching_selection</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mobile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'protein</span> <span class="pre">and</span> <span class="pre">name</span> <span class="pre">CA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.analysis.get_matching_selection" title="Permalink to this definition">¶</a></dt>
<dd><p>Get matching selection strings of mobile and reference after resids alignment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mobile</strong> (<em>MDA universe</em>) – </p></li>
<li><p><strong>ref</strong> (<em>MDA universe</em>) – </p></li>
<li><p><strong>sel</strong> (<em>str</em>) – selection string</p></li>
<li><p><strong>norm</strong> (<em>bool</em>) – apply analysis.norm_resids()</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>matching selection string (mobile)
sel2 (str): matching selection string (ref)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>sel1 (str)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.analysis.get_resids_shift">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.analysis.</span></code><code class="sig-name descname"><span class="pre">get_resids_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mobile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.analysis.get_resids_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Compares universe.residues.resnames between mobile and ref in order to get resids shift.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mobile</strong> (<em>MDA universe</em>) – </p></li>
<li><p><strong>ref</strong> (<em>MDA universe</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>shift value of ref residues to match mobile residues</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>shift (int)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.analysis.get_time_conversion">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.analysis.</span></code><code class="sig-name descname"><span class="pre">get_time_conversion</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.analysis.get_time_conversion" title="Permalink to this definition">¶</a></dt>
<dd><p>get/print time conversion of MDA universe &lt;u&gt;</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>u</strong> (<em>MDA universe</em>) – </p>
</dd>
</dl>
<dl class="simple">
<dt>Kwargs:</dt><dd><p>#see args and kwargs of misc.cprint()</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.analysis.get_trendline">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.analysis.</span></code><code class="sig-name descname"><span class="pre">get_trendline</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.analysis.get_trendline" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduces &lt;xdata, ydata&gt; by &lt;compress&gt; factor and returns trendline data.
(Trendline: sum and normalize each &lt;compress&gt; elements of input data)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xdata</strong> (<em>list/array</em>) – </p></li>
<li><p><strong>ydata</strong> (<em>list/array</em>) – </p></li>
<li><p><strong>compress</strong> (<em>int</em>) – compress factor (sum and normalize &lt;compress&gt; elements)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>trend_xdata (list/array)
trend_ydata (list/array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.analysis.norm_and_align_universe">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.analysis.</span></code><code class="sig-name descname"><span class="pre">norm_and_align_universe</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mobile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.analysis.norm_and_align_universe" title="Permalink to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>Norm reference and mobile universe</p></li>
<li><p>Align mobile universe on reference universe (matching atom ids and res ids)</p></li>
</ul>
<dl class="simple">
<dt>For additional information, type:</dt><dd><ul class="simple">
<li><p>help(&lt;PKG_name&gt;.norm_ids)</p></li>
<li><p>help(&lt;PKG_name&gt;.norm_resids)</p></li>
<li><p>help(&lt;PKG_name&gt;.norm_universe)</p></li>
<li><p>help(&lt;PKG_name&gt;.norm_and_align_universe)</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mobile</strong> (<em>MDA universe/atomgrp</em>) – </p></li>
<li><p><strong>ref</strong> (<em>MDA universe/atomgrp</em>) – </p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.analysis.norm_ids">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.analysis.</span></code><code class="sig-name descname"><span class="pre">norm_ids</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.analysis.norm_ids" title="Permalink to this definition">¶</a></dt>
<dd><p>Modify existing MDA universe/atomgrp and normalize ids according to:
min(universe.atoms.ids) = 1</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>MDA universe/atomgrp</em>) – structure</p></li>
<li><p><strong>info</strong> (<em>str</em>) – additional info for print message
- ‘reference’
- ‘mobile’</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – </p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>&gt;&gt; ref = mda.Universe(&lt;top&gt;)
&gt;&gt; print(ref.atoms.ids)
[0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19]</p>
<p>&gt;&gt; norm_ids(ref, ‘reference’)
Norming atom ids of reference…</p>
<p>&gt;&gt; print(ref.atoms.ids)
[1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20]</p>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.analysis.norm_resids">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.analysis.</span></code><code class="sig-name descname"><span class="pre">norm_resids</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.analysis.norm_resids" title="Permalink to this definition">¶</a></dt>
<dd><p>Modify existing MDA universe/atomgrp and normalize resids according to:
min(universe.residues.resids) = 1</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>MDA universe/atomgrp</em>) – structure</p></li>
<li><p><strong>info</strong> (<em>str</em>) – additional info for print message
- ‘reference’
- ‘topology’</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>&gt;&gt; ref = mda.Universe(&lt;top&gt;)
&gt;&gt; print(ref.residues.resids)
[0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19]</p>
<p>&gt;&gt; norm_resids(u, ‘reference’)
Norming resids of reference…</p>
<p>&gt;&gt; print(ref.residues.resids)
[1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20]</p>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.analysis.norm_universe">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.analysis.</span></code><code class="sig-name descname"><span class="pre">norm_universe</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.analysis.norm_universe" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Executes the functions:</dt><dd><ul class="simple">
<li><p>norm_ids(u, info)</p></li>
<li><p>norm_resids(u, info)</p></li>
</ul>
</dd>
<dt>For additional information, type:</dt><dd><ul class="simple">
<li><p>help(&lt;PKG_name&gt;.norm_ids)</p></li>
<li><p>help(&lt;PKG_name&gt;.norm_resids)</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>MDA universe/atomgrp</em>) – structure</p></li>
<li><p><strong>info</strong> (<em>str</em>) – additional info for print message
- ‘reference’
- ‘mobile’</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.analysis.plot_HEATMAP">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.analysis.</span></code><code class="sig-name descname"><span class="pre">plot_HEATMAP</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_as</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.analysis.plot_HEATMAP" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Note: if data is incomplete:</dt><dd><dl class="simple">
<dt>-&gt; use min/max values or np.nan for missing values</dt><dd><p>and the keyword argument annot=True or annot=False</p>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>arrays</em>) – </p></li>
<li><p><strong>save_as</strong> (<em>str</em>) – save name or realpath to save file</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Kwargs:</dt><dd><p># see args of misc.figure()
annot (bool/list): toggle annotation within the heatmap squares.</p>
<blockquote>
<div><p>if a list is provided, annotates the list content.</p>
</div></blockquote>
<p>cmap (str): color map string
n_colors (None/int)
cbar_min / vmin (None/int/float): min value of colorbar and heatmap
cbar_max / vmax (None/int/float): max value of colorbar and heatmap
cbar_label (None/str)
title (None/str)
xlabel (None/str)
ylabel (None/str)
xticklabels (None/list)
yticklabels (None/list)
show_ticks (bool): toggle (label) ticks</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>fig (matplotlib.figure.Figure)
ax (ax ~ matplotlib.axes._subplots.Axes)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.analysis.plot_HEATMAP_REX_RMSD">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.analysis.</span></code><code class="sig-name descname"><span class="pre">plot_HEATMAP_REX_RMSD</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">REX_RMSD_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['RdBu_r',</span> <span class="pre">50,</span> <span class="pre">0,</span> <span class="pre">8]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auto_convert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_as</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.analysis.plot_HEATMAP_REX_RMSD" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>REX_RMSD_dir</strong> (<em>str</em>) – directory to REX_RMSD files</p></li>
<li><p><strong>cps</strong> (<em>list</em>) – color_palette_settings
[0]: color_palette name (str)
[1]: n_colors (int)
[2]: heatmap vmin (int/float)
[3]: heatmap vmax (int/float)</p></li>
<li><p><strong>auto_convert</strong> (<em>bool</em>) – <dl class="simple">
<dt>convert “displayed” RMSD and xticks for plot</dt><dd><p>returned values stay unconverted</p>
</dd>
<dt>if True:</dt><dd><p>RMSD: RMSD (nm) -&gt; RMSD (angstrom)
xticks: frame -&gt; time (ns)</p>
</dd>
</dl>
</p></li>
<li><p><strong>save_as</strong> (<em>str</em>) – save name or realpath to save file</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Kwargs:</dt><dd><p># see args of misc.figure()
title (None/str)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>time values of first REX_RMSD file
RMSD (list of arrays): RMSD values of each REX_RMSD file</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>TIME (list)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.analysis.plot_RMSD">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.analysis.</span></code><code class="sig-name descname"><span class="pre">plot_RMSD</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">RMSD_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[None,</span> <span class="pre">None,</span> <span class="pre">10]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_as</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.analysis.plot_RMSD" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>RMSD_file</strong> (<em>str</em>) – path to RMSD file</p></li>
<li><p><strong>sss</strong> (<em>list</em>) – [start, stop, step]
start (None/int): start frame
stop (None/int): stop frame
step (None/int): step size</p></li>
<li><p><strong>verbose</strong> (<em>None/bool</em>) – None: print step to user (as a reminder)
True: print start, step, stop to user
False: no print</p></li>
<li><p><strong>save_as</strong> (<em>str</em>) – save name or realpath to save file</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Kwargs:</dt><dd><p># see args of misc.figure()
alpha (float)
color (str)
cut_min (None/int/float): min value for cutoff
cut_max (None/int/float): max value for cutoff
start (None/int): start frame
stop (None/int): stop frame
step (None/int): step size
filedir (str): default directory where to save figure
title (None/str)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>fig (matplotlib.figure.Figure)
ax (ax/list of axes ~ matplotlib.axes._subplots.Axes)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.analysis.plot_deltahist">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.analysis.</span></code><code class="sig-name descname"><span class="pre">plot_deltahist</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">RMSD_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RMSD_ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[None,</span> <span class="pre">None,</span> <span class="pre">None]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_all_hist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_as</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.analysis.plot_deltahist" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>RMSD_file</strong> (<em>str</em>) – path to RMSD file</p></li>
<li><p><strong>RMSD_ref</strong> (<em>str</em>) – path to RMSD reference file</p></li>
<li><p><strong>sss</strong> (<em>list</em>) – [start, stop, step]
start (None/int): start frame
stop (None/int): stop frame
step (None/int): step size</p></li>
<li><p><strong>show_all_hist</strong> (<em>bool</em>) – True:  show ref hist, non-ref hist and delta hist
False: show only delta hist</p></li>
<li><p><strong>title</strong> (<em>str</em>) – </p></li>
<li><p><strong>save_as</strong> (<em>str</em>) – save name or realpath to save file</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Kwargs:</dt><dd><p># see args of misc.figure()
alpha (float)
colors (list): two string elements in list: color_positive, color_negative</p>
<blockquote>
<div><p>Example: [“g”, “r”]</p>
</div></blockquote>
<p>color_positive (str)
color_negative (str)
ec (None/str): edge color
start (None/int): start frame
stop (None/int): stop frame
step (None/int): step size
cut_min (None/int/float): min value for cutoff (here: alias of vmin)
cut_max (None/int/float): max value for cutoff (here: alias of vmax)
apply_cut_limits (bool): apply plt.xlim(cut_min, cut_max) if orientation is “vertical”</p>
<blockquote>
<div><p>apply plt.ylim(cut_min, cut_max) if orientation is “horizontal”</p>
</div></blockquote>
<p>bins (None/list): use bins if passed, else construct bins based on n_bins, vmin, vmax, vbase
n_bins (int): number of bins
n_bins_autoadd (int): autocorrect n_bins (default: 1), because code requires 1 extra bin.
vmin (None/int/float): min value of histogram/bins
vmax (None/int/float): max value of histogram/bins
vbase (int): rounding base of vmin, vmax.</p>
<blockquote>
<div><p>see misc.round_down(number,base) or misc.round_up(number,base)</p>
</div></blockquote>
<p>logscale (bool): apply logscale on the “count” axis
minorticks (bool): turns minorticks (~logscale) for hist figure on/off
norm (bool): normalize histogram
orientation (str): “vertical”, “horizontal”
title (None/str)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>fig (matplotlib.figure.Figure)
ax (ax/list of axes ~ matplotlib.axes._subplots.Axes)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.analysis.plot_hist">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.analysis.</span></code><code class="sig-name descname"><span class="pre">plot_hist</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[None,</span> <span class="pre">None,</span> <span class="pre">None]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_as</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.analysis.plot_hist" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>list/array/list of lists</em>) – input data. Dimensions of each list must
be equal if multiple lists are provided.</p></li>
<li><p><strong>sss</strong> (<em>list</em>) – [start, stop, step]
start (None/int): start frame
stop (None/int): stop frame
step (None/int): step size</p></li>
<li><p><strong>save_as</strong> (<em>str</em>) – save name or realpath to save file</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Kwargs:</dt><dd><p># see args of misc.figure()
start (None/int): start frame
stop (None/int): stop frame
step (None/int): step size
cut_min (None/int/float): min value for cutoff
cut_max (None/int/float): max value for cutoff
apply_cut_limits (bool): apply plt.xlim(cut_min, cut_max) if orientation is “vertical”</p>
<blockquote>
<div><p>apply plt.ylim(cut_min, cut_max) if orientation is “horizontal”</p>
</div></blockquote>
<p>align_bins (str): ‘center’, ‘edge’ (default, left edge alignment)
bins (None/list): use bins if passed, else construct bins based on n_bins, vmin, vmax, vbase
n_bins (int): number of bins
n_bins_autoadd (int): autocorrect n_bins (default: 1), because code requires 1 extra bin.
vmin (None/int/float): min value of histogram/bins
vmax (None/int/float): max value of histogram/bins
vbase (int): rounding base of vmin, vmax.</p>
<blockquote>
<div><p>see misc.round_down(number,base) or misc.round_up(number,base)</p>
</div></blockquote>
<p>logscale (bool): apply logscale on the “count” axis
minorticks (bool): turns minorticks (~logscale) for hist figure on/off
norm (bool): normalize histogram
orientation (str): “vertical”, “horizontal”
alpha (int/float)
colors (list of str/sns.colorpalette)
ec (None/str): edge color
title (None/str)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p>fig (matplotlib.figure.Figure)
ax (ax/list of axes ~ matplotlib.axes._subplots.Axes)</p>
<p>hist (tuple): n, bins, patches
or HIST (list): list of hist, i.e. list of (n, bins, patches) tuples</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.analysis.plot_trendline">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.analysis.</span></code><code class="sig-name descname"><span class="pre">plot_trendline</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.analysis.plot_trendline" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot trendline of &lt;xdata, ydata&gt; and return trendline object
Remove trendline via trendline.remove()</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xdata</strong> (<em>list/array</em>) – </p></li>
<li><p><strong>ydata</strong> (<em>list/array</em>) – </p></li>
<li><p><strong>compress</strong> (<em>int</em>) – compress factor (sum and normalize &lt;compress&gt; elements)</p></li>
<li><p><strong>fignum</strong> (<em>int</em>) – figure number (get with plt.gcf().number)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Kwargs:</dt><dd><p>“alpha”: 1.0
“color”: “black”
“ls”: “-”
“lw”: 2.0
“ms”: 1
“marker”: “</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>trendline object</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>trendline (matplotlib.lines.Line2D)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.analysis.remove_trendline">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.analysis.</span></code><code class="sig-name descname"><span class="pre">remove_trendline</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trendline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.analysis.remove_trendline" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.analysis.shift_resids">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.analysis.</span></code><code class="sig-name descname"><span class="pre">shift_resids</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.analysis.shift_resids" title="Permalink to this definition">¶</a></dt>
<dd><p>Shift mda.universe.residues by &lt;shift&gt; value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>MDA universe</em>) – </p></li>
<li><p><strong>shift</strong> (<em>None/int</em>) – shift value</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.analysis.shortest_RES_distances">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.analysis.</span></code><code class="sig-name descname"><span class="pre">shortest_RES_distances</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.analysis.shortest_RES_distances" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates shortest RES distances (all atom level) of universe u.
Attention: Displayed RES ids always start with 1</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>MDA universe/atomgrp</em>) – structure path</p></li>
<li><p><strong>u</strong> – structure</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>NxN Matrix with shortest RES distances</dt><dd><dl class="simple">
<dt>i.e.: SD[0][0] is shortest distance RES0-RES0</dt><dd><p>SD[0][1] is shortest distance RES0-RES1
SD[0][2] is shortest distance RES0-RES2
etc.</p>
</dd>
</dl>
</dd>
<dt>SD_d (np.array, dtype=object): detailed List with:</dt><dd><p>[d_min, (RES_pair), (ATM_pair), (ATM_names)]</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>SD (np.arrray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.analysis.true_select_atoms">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.analysis.</span></code><code class="sig-name descname"><span class="pre">true_select_atoms</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'protein'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.analysis.true_select_atoms" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Create “true selection” (atomgroup copy in NEW universe) after applying</dt><dd><ul class="simple">
<li><p>norm_ids()</p></li>
<li><p>norm_resids()</p></li>
</ul>
</dd>
</dl>
<p>Note that atom indices are reassigned according to range(0, len(u.atoms))</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>MDA universe/atomgrp</em>) – structure path or PDB id</p></li>
<li><p><strong>u</strong> – structure</p></li>
<li><p><strong>sel</strong> (<em>str</em>) – selection string</p></li>
<li><p><strong>ignh</strong> (<em>bool</em>) – ignore hydrogen (mass &lt; 1.2)</p></li>
<li><p><strong>norm</strong> (<em>bool</em>) – apply analysis.norm_universe()</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>“true selection” / atomgroup copy in NEW universe</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>a (&lt;AtomGroup&gt;)</p>
</dd>
</dl>
<p>Additional Info:
mda.select_atoms() remembers information about the original configuration which is sometimes NOT WANTED.</p>
<p>EXAMPLE:
# Init universe
u = mda.Universe(&lt;top&gt;)</p>
<p># select_atoms() behaviour
&gt;&gt; a = u.select_atoms(“protein and type C”)
&gt;&gt; a
&lt;AtomGroup with 72 atoms&gt;
&gt;&gt; a.residues.atoms
&lt;AtomGroup with 964 atoms&gt;</p>
<p># true_select_atoms() behaviour
&gt;&gt; a = ana.true_select_atoms(u, sel=”protein and type C”)
&gt;&gt; a
&lt;Universe with 72 atoms&gt;
&gt;&gt; a.residue.atoms
&lt;AtomGroup with 72 atoms&gt;</p>
</dd></dl>

</div>
<div class="section" id="module-pyREX.analysis.contacts">
<span id="pyrex-analysis-contacts-module"></span><h2>pyREX.analysis.contacts module<a class="headerlink" href="#module-pyREX.analysis.contacts" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="pyREX.analysis.contacts.get_Native_Contacts">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.contacts.</span></code><code class="sig-name descname"><span class="pre">get_Native_Contacts</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'protein'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.contacts.get_Native_Contacts" title="Permalink to this definition">¶</a></dt>
<dd><p>Get set (unique RES pairs) and list (detailed RES pairs) with native contacts.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>len(NC) &lt; len(NC_d) because NC contains only unique RES pairs
whereas NC_d contains each ATOM pair.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref</strong> (<em>MDA universe/atomgrp</em>) – reference path</p></li>
<li><p><strong>ref</strong> – reference structure</p></li>
<li><p><strong>d_cutoff</strong> (<em>float</em>) – distance cutoff for nat. contacts</p></li>
<li><p><strong>sel</strong> (<em>str</em>) – selection string</p></li>
<li><p><strong>method</strong> (<em>str</em>) – ‘1’ or ‘Contact_Matrix’: mda.contact_matrix() with d_cutoff
‘2’ or ‘Capped_Distance’: mda.lib.distances.capped_distance() with d_cutoff #TODO
‘3’ or ‘Shadow_Map’ #TODO</p></li>
<li><p><strong>norm</strong> (<em>bool</em>) – apply analysis.norm_universe()</p></li>
<li><p><strong>ignh</strong> (<em>bool</em>) – ignore hydrogen</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – print “Note: Please verify that your selection is</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>NCs (only unique RES pairs)
NC_d (list): detailed list of NCs containing (RES pairs), (ATOM numbers), (ATOM names)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>NC (list)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.contacts.get_Qbias">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.contacts.</span></code><code class="sig-name descname"><span class="pre">get_Qbias</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mobile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[None,</span> <span class="pre">None,</span> <span class="pre">None]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.contacts.get_Qbias" title="Permalink to this definition">¶</a></dt>
<dd><p>Get QValue for formed biased contacts.</p>
<p>Note 1: selection of get_Qbias() is hardcoded to sel=’protein and name CA’.
Reason: bias contacts are unique RES PAIRS and grow ‘slowly’, but going from</p>
<blockquote>
<div><p>sel=’protein and name CA’ to sel=’protein’ increases the atom count
significantly. Most of them will count as non-native and thus make
the Qbias value very low.</p>
</div></blockquote>
<dl class="simple">
<dt>Note 2: MDAnalysis’ qvalue algorithm includes selfcontacts. Comparison of both methods</dt><dd><p>yields better results when include_selfcontacts (bool, see kwargs) is set to
True. However this improves the calculated Qbias value artificially (e.g. even
when all used bias contacts are never formed, Qbias will not be zero due to the
selfcontact counts)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mobile</strong> (<em>MDA universe</em>) – mobile structure with trajectory</p></li>
<li><p><strong>bc</strong> (<em>list</em>) – list with bias contacts to analyze</p></li>
<li><p><strong>sss</strong> (<em>list</em>) – [start, stop, step]
start (None/int): start frame
stop (None/int): stop frame
step (None/int): step size</p></li>
<li><p><strong>d_cutoff</strong> (<em>float</em>) – cutoff distance</p></li>
<li><p><strong>norm</strong> (<em>bool</em>) – norm universe before calculation.</p></li>
<li><p><strong>plot</strong> (<em>bool</em>) – </p></li>
<li><p><strong>warn</strong> (<em>bool</em>) – print important warnings about usage of this function.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – </p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Kwargs:</dt><dd><p>dtype (dtype): data type of returned contact matrix CM
include_selfcontacts (bool): sets norm of QBIAS. Default is False.</p>
<blockquote>
<div><p>True: includes selfcontacts on main diagonal of CM (max count &gt; len(bc))
False: ignores selfcontacts on main diagonal of CM (max count == len(bc))</p>
</div></blockquote>
<p>start (None/int): start frame
stop (None/int): stop frame
step (None/int): step size
color (str)
save_plot (bool)
save_as (str): “Qbias.png”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>FRAMES (np.array)
QBIAS (np.array): fraction of formed bias contacts
CM (np.array): array of distance matrices</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.contacts.get_Qnative">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.contacts.</span></code><code class="sig-name descname"><span class="pre">get_Qnative</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mobile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'protein</span> <span class="pre">and</span> <span class="pre">name</span> <span class="pre">CA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[None,</span> <span class="pre">None,</span> <span class="pre">None]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.contacts.get_Qnative" title="Permalink to this definition">¶</a></dt>
<dd><p>Get QValue for native contacts.</p>
<ol class="arabic simple">
<li><p>norms and aligns mobile to ref so that atomgroups have same resids</p></li>
<li><p>performs native contact analysis</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mobile</strong> (<em>MDA universe</em>) – mobile structure with trajectory</p></li>
<li><p><strong>ref</strong> (<em>MDA universe</em>) – reference structure</p></li>
<li><p><strong>sel</strong> (<em>str</em>) – selection string</p></li>
<li><p><strong>sss</strong> (<em>list</em>) – [start, stop, step]
start (None/int): start frame
stop (None/int): stop frame
step (None/int): step size</p></li>
<li><p><strong>d_cutoff</strong> (<em>float</em>) – cutoff distance</p></li>
<li><p><strong>plot</strong> (<em>bool</em>) – </p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – </p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Kwargs:</dt><dd><p>sel1 (str): selection string for contacting group (1 to 1 mapping)
sel2 (str): selection string for contacting group (1 to 1 mapping)</p>
<blockquote>
<div><p>Note: ignores sel (arg) if sel1 or sel2 (kwargs) are passed</p>
</div></blockquote>
<dl class="simple">
<dt>method (str): method for QValues calculation</dt><dd><p>‘radius_cut’: native if d &lt; d_cutoff
‘soft_cut’: see help(MDAnalysis.analysis.contacts.soft_cut_q)
‘hardcut’: native if d &lt; d_ref</p>
</dd>
</dl>
<p>start (None/int): start frame
stop (None/int): stop frame
step (None/int): step size
color (str)
save_plot (bool)
save_as (str): “Qnative.png”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>FRAMES (list)
QNATIVE (list): fraction of native contacts</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.contacts.get_formed_contactpairs">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.contacts.</span></code><code class="sig-name descname"><span class="pre">get_formed_contactpairs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'protein</span> <span class="pre">and</span> <span class="pre">name</span> <span class="pre">CA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.contacts.get_formed_contactpairs" title="Permalink to this definition">¶</a></dt>
<dd><p>get formed contact pairs by converting a contact matrix cm into a list with
tuples (RESi,RESj).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>mda.Universe</em>) – used to obtain topology information</p></li>
<li><p><strong>cm</strong> (<em>np.array</em>) – single contact matrix of size (n_atoms, n_atoms)</p></li>
<li><p><strong>sel</strong> (<em>str</em>) – selection string</p></li>
<li><p><strong>norm</strong> (<em>bool</em>) – norm universe before obtaining topology information</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Kwargs:</dt><dd><p>include_selfcontacts (bool): include contacts on main diagonal of cm. Default is False.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list with contact pairs (RESi,RESj)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>CP (list)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.contacts.plot_Contact_Map">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.contacts.</span></code><code class="sig-name descname"><span class="pre">plot_Contact_Map</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DCA_fin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_DCA</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'protein'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdbid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdbid'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.contacts.plot_Contact_Map" title="Permalink to this definition">¶</a></dt>
<dd><p>Create contact map based on the reference pdb structure.
If DCA file is passed, correct/wrong contacts are visualized in green/red.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref</strong> (<em>MDA universe/atomgrp</em>) – reference path</p></li>
<li><p><strong>ref</strong> – reference structure</p></li>
<li><p><strong>DCA_fin</strong> (<em>None/str</em>) – DCA input file (path)</p></li>
<li><p><strong>n_DCA</strong> (<em>None/int</em>) – number of used DCA contacts</p></li>
<li><p><strong>d_cutoff</strong> (<em>float</em>) – distance cutoff for nat. contacts</p></li>
<li><p><strong>sel</strong> (<em>str</em>) – selection string</p></li>
<li><p><strong>pdbid</strong> (<em>str</em>) – pdbid which is used for plot title</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Kwargs:</dt><dd><p>DCA_cols (tuple): columns containing the RES pairs in DCA_fin
DCA_skiprows (int): ignore header rows of DCA_fin</p>
<blockquote>
<div><p>-1 or “auto”: auto detect</p>
</div></blockquote>
<dl class="simple">
<dt>filter_DCA (bool):</dt><dd><p>True: ignore DCA pairs with <a href="#id3"><span class="problematic" id="id4">|i-j|</span></a> &lt; 3
False: use all DCA pairs w/o applying filter</p>
</dd>
<dt>RES_range (None):  [RES_min, RES_max] range. Ignore invalid RES ids</dt><dd><p>None: do not narrow down RES range</p>
</dd>
</dl>
<p>ignh (bool): ignore hydrogen (mass &lt; 1.2)
norm (bool): apply analysis.norm_universe()
save_plot (bool)
# see args of misc.figure()</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>fig (matplotlib.figure.Figure)
ax (ax/list of axes ~ matplotlib.axes._subplots.Axes)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.contacts.plot_DCA_TPR">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.contacts.</span></code><code class="sig-name descname"><span class="pre">plot_DCA_TPR</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DCA_fin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_DCA</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'protein'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdbid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdbid'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.contacts.plot_DCA_TPR" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots true positive rate for number of used DCA contacts.</p>
<dl class="simple">
<dt>Method:</dt><dd><ul class="simple">
<li><p>calculates shortest RES distance of the selection
(only heavy atoms if ignh is True)</p></li>
<li><p>if distance is below threshold: DCA contact is true</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref</strong> (<em>MDA universe/atomgrp</em>) – reference path</p></li>
<li><p><strong>ref</strong> – reference structure</p></li>
<li><p><strong>DCA_fin</strong> (<em>str</em>) – DCA input file (path)</p></li>
<li><p><strong>n_DCA</strong> (<em>int</em>) – number of used DCA contacts</p></li>
<li><p><strong>d_cutoff</strong> (<em>float</em>) – distance cutoff for nat. contacts</p></li>
<li><p><strong>sel</strong> (<em>str</em>) – selection string</p></li>
<li><p><strong>pdbid</strong> (<em>str</em>) – pdbid; used for plot title and figure name</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Kwargs:</dt><dd><p>DCA_cols (tuple/list): columns containing the RES pairs in DCA_fin
DCA_skiprows (int): ignore header rows of DCA_fin</p>
<blockquote>
<div><p>-1 or “auto”: auto detect</p>
</div></blockquote>
<dl class="simple">
<dt>filter_DCA (bool):</dt><dd><p>True: ignore DCA pairs with <a href="#id5"><span class="problematic" id="id6">|i-j|</span></a> &lt; 4
False: use all DCA pairs w/o applying filter</p>
</dd>
<dt>RES_range (None):  [RES_min, RES_max] range. Ignore invalid RES ids</dt><dd><p>None: do not narrow down RES range</p>
</dd>
</dl>
<p>ignh (bool): ignore hydrogen (mass &lt; 1.2)
norm (bool): apply analysis.norm_universe()
TPR_layer (str): plot TPR curve in foreground or background layer</p>
<blockquote>
<div><p>“fg”, “foreground”, “bg”, “background”</p>
</div></blockquote>
<p>color (str)
shade_area (bool): shade area between L/2 and L ranked contacts
shade_color (str)
shade_alpha (float)
hline_color (None/str): color of 75p threshold (horizontal line)
hline_ls (str): linestyle of hline (default: “-“)
nDCA_opt_color (None/str): color of optimal/recommended nDCA threshold</p>
<blockquote>
<div><p>nDCA_opt = misc.round_up(3/4*len(ref.residues), base=5))
(vertical line ~ nDCA_opt)
(horizontal line ~ TPR(nDCA_opt))</p>
</div></blockquote>
<p>nDCA_opt_ls (str): linestyle of nDCA_opt (default: “–”)
save_plot (bool)
save_log (bool)
figsize (tuple)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>fig (matplotlib.figure.Figure)
ax (ax/list of axes ~ matplotlib.axes._subplots.Axes)</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyREX.analysis.dihedrals">
<span id="pyrex-analysis-dihedrals-module"></span><h2>pyREX.analysis.dihedrals module<a class="headerlink" href="#module-pyREX.analysis.dihedrals" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="pyREX.analysis.dihedrals.get_chi1_values">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.dihedrals.</span></code><code class="sig-name descname"><span class="pre">get_chi1_values</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'protein'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[None,</span> <span class="pre">None,</span> <span class="pre">None]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.dihedrals.get_chi1_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Get chi1 dihedral values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>MDA universe</em>) – </p></li>
<li><p><strong>sel</strong> (<em>str</em>) – selection string</p></li>
<li><p><strong>sss</strong> (<em>list</em>) – [start, stop, step]
start (None/int): start frame
stop (None/int): stop frame
step (None/int): step size</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – print warning “All ALA, CYS, GLY, PRO, SER, THR, and VAL
residues have been removed from the selection.”</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Kwargs:</dt><dd><p>start (None/int): start frame
stop (None/int): stop frame
step (None/int): step size</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>chi1_values (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.dihedrals.get_chi2_values">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.dihedrals.</span></code><code class="sig-name descname"><span class="pre">get_chi2_values</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'protein'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[None,</span> <span class="pre">None,</span> <span class="pre">None]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.dihedrals.get_chi2_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Get chi2 dihedral values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>MDA universe</em>) – </p></li>
<li><p><strong>sel</strong> (<em>str</em>) – selection string</p></li>
<li><p><strong>sss</strong> (<em>list</em>) – [start, stop, step]
start (None/int): start frame
stop (None/int): stop frame
step (None/int): step size</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – print warning “All ALA, CYS, GLY, PRO, SER, THR, and VAL
residues have been removed from the selection.”</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Kwargs:</dt><dd><p>start (None/int): start frame
stop (None/int): stop frame
step (None/int): step size</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>chi2_values (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.dihedrals.get_janin">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.dihedrals.</span></code><code class="sig-name descname"><span class="pre">get_janin</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'protein'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[None,</span> <span class="pre">None,</span> <span class="pre">None]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.dihedrals.get_janin" title="Permalink to this definition">¶</a></dt>
<dd><p>get Janin information (chi1 &amp; chi2 dihedral values, n_frames, etc).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>chi1/chi2 angles are not defined for ALA, CYS, GLY, PRO, SER, THR, VAL</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>MDA universe</em>) – </p></li>
<li><p><strong>sel</strong> (<em>str</em>) – selection string</p></li>
<li><p><strong>sss</strong> (<em>list</em>) – [start, stop, step]
start (None/int): start frame
stop (None/int): stop frame
step (None/int): step size</p></li>
<li><p><strong>plot</strong> (<em>bool</em>) – </p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – print warning “All ALA, CYS, GLY, PRO, SER, THR, and VAL
residues have been removed from the selection.”</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Kwargs:</dt><dd><p>start (None/int): start frame
stop (None/int): stop frame
step (None/int): step size
color (str): “black”
marker (str): “.”
ref (bool):</p>
<blockquote>
<div><dl class="simple">
<dt>True: Adds a general Janin plot which shows allowed (dark</dt><dd><p>blue ~ 90% data points) and marginally allowed regions (light
blue ~ 99% data points).
-&gt; lookup MDAnalysis online documentation about dihedrals.</p>
</dd>
</dl>
</div></blockquote>
<dl class="simple">
<dt>num (None/int): figure number</dt><dd><p>None: create new figure</p>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><dl class="simple">
<dt>class contains, e.g.</dt><dd><ul class="simple">
<li><p>atom groups</p></li>
<li><p>angles</p></li>
<li><p>frames</p></li>
<li><p>times</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>janin (MDAnalysis.analysis.dihedrals.Janin)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.dihedrals.get_omega_values">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.dihedrals.</span></code><code class="sig-name descname"><span class="pre">get_omega_values</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'protein'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[None,</span> <span class="pre">None,</span> <span class="pre">None]</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.dihedrals.get_omega_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Get omega dihedral values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>MDA universe</em>) – </p></li>
<li><p><strong>sel</strong> (<em>str</em>) – selection string</p></li>
<li><p><strong>sss</strong> (<em>list</em>) – [start, stop, step]
start (None/int): start frame
stop (None/int): stop frame
step (None/int): step size</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>omega_values (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.dihedrals.get_phi_values">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.dihedrals.</span></code><code class="sig-name descname"><span class="pre">get_phi_values</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'protein'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[None,</span> <span class="pre">None,</span> <span class="pre">None]</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.dihedrals.get_phi_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Get phi dihedral values.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>phi/psi angles are not defined for first and last residues.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>MDA universe</em>) – </p></li>
<li><p><strong>sel</strong> (<em>str</em>) – selection string</p></li>
<li><p><strong>sss</strong> (<em>list</em>) – [start, stop, step]
start (None/int): start frame
stop (None/int): stop frame
step (None/int): step size</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>phi (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.dihedrals.get_psi_values">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.dihedrals.</span></code><code class="sig-name descname"><span class="pre">get_psi_values</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'protein'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[None,</span> <span class="pre">None,</span> <span class="pre">None]</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.dihedrals.get_psi_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Get psi dihedral values.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>phi/psi angles are not defined for first and last residues.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>MDA universe</em>) – </p></li>
<li><p><strong>sel</strong> (<em>str</em>) – selection string</p></li>
<li><p><strong>sss</strong> (<em>list</em>) – [start, stop, step]
start (None/int): start frame
stop (None/int): stop frame
step (None/int): step size</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>psi_values (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.dihedrals.get_ramachandran">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.dihedrals.</span></code><code class="sig-name descname"><span class="pre">get_ramachandran</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'protein'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[None,</span> <span class="pre">None,</span> <span class="pre">None]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.dihedrals.get_ramachandran" title="Permalink to this definition">¶</a></dt>
<dd><p>get Ramachandran information (phi &amp; psi dihedral values, n_frames, etc).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>phi/psi angles are not defined for first and last residues.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>MDA universe</em>) – </p></li>
<li><p><strong>sel</strong> (<em>str</em>) – selection string</p></li>
<li><p><strong>sss</strong> (<em>list</em>) – [start, stop, step]
start (None/int): start frame
stop (None/int): stop frame
step (None/int): step size</p></li>
<li><p><strong>plot</strong> (<em>bool</em>) – </p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Kwargs:</dt><dd><p>start (None/int): start frame
stop (None/int): stop frame
step (None/int): step size
color (str): “black”
marker (str): “.”
ref (bool):</p>
<blockquote>
<div><dl class="simple">
<dt>True: Adds a general Ramachandran plot which shows allowed (dark</dt><dd><p>blue ~ 90% data points) and marginally allowed regions (light
blue ~ 99% data points).
-&gt; lookup MDAnalysis online documentation about dihedrals.</p>
</dd>
</dl>
</div></blockquote>
<dl class="simple">
<dt>num (None/int): figure number</dt><dd><p>None: create new figure</p>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><dl class="simple">
<dt>class contains, e.g.</dt><dd><ul class="simple">
<li><p>atom groups</p></li>
<li><p>angles</p></li>
<li><p>frames</p></li>
<li><p>times</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>rama (MDAnalysis.analysis.dihedrals.Ramachandran)</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyREX.analysis.gdt">
<span id="pyrex-analysis-gdt-module"></span><h2>pyREX.analysis.gdt module<a class="headerlink" href="#module-pyREX.analysis.gdt" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="pyREX.analysis.gdt.GDT">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.gdt.</span></code><code class="sig-name descname"><span class="pre">GDT</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mobile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'protein</span> <span class="pre">and</span> <span class="pre">name</span> <span class="pre">CA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'protein</span> <span class="pre">and</span> <span class="pre">name</span> <span class="pre">CA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[None,</span> <span class="pre">None,</span> <span class="pre">None]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.5,</span> <span class="pre">10,</span> <span class="pre">0.5]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_resids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.gdt.GDT" title="Permalink to this definition">¶</a></dt>
<dd><p>GDT: Global Distance Test</p>
<p>Algorithm to identify how good “mobile” matches to “reference” by calculating the sets
of residues which do not deviate more than a specified (pairwise) CA distance cutoff.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>sel1 = mobile.select_atoms(sel1)
sel2 = ref.select_atoms(sel2)
weights=”mass”  # hardcoded weights for alignment</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mobile</strong> (<em>MDA universe/atomgrp</em>) – mobile structure with trajectory</p></li>
<li><p><strong>ref</strong> (<em>MDA universe/atomgrp</em>) – reference structure</p></li>
<li><p><strong>sel1</strong> (<em>str</em>) – selection string of mobile structure</p></li>
<li><p><strong>sel2</strong> (<em>str</em>) – selection string of reference structure</p></li>
<li><p><strong>sss</strong> (<em>list</em>) – [start, stop, step]
start (None/int): start frame
stop (None/int): stop frame
step (None/int): step size</p></li>
<li><p><strong>cutoff</strong> (<em>list</em>) – parameters describing GDT
cutoff[0]: min_cutoff (float)
cutoff[1]: max_cutoff (float)
cutoff[2]: step_cutoff (float)</p></li>
<li><p><strong>true_resids</strong> (<em>bool</em>) – offset resids of “GDT_resids” to correct codestyle resids into real resids
True: return true resids in output “GDT_resids”
False: return codestyle resids in output “GDT_resids”</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Kwargs:</dt><dd><dl class="simple">
<dt>aliases for sss items:</dt><dd><p>start (None/int): start frame
stop (None/int): stop frame
step (None/int): step size</p>
</dd>
<dt>aliases for cutoff items:</dt><dd><p>min_cutoff (float)
max_cutoff (float)
step_cutoff (float)</p>
</dd>
</dl>
<p>disable (bool): disable progress bar</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><dl class="simple">
<dt>GDT_Px for each cutoff distance in GDT_cutoff, where GDT_Px denotes</dt><dd><p>percent of residues under distance cutoff &lt;= x Angstrom</p>
</dd>
<dt>GDT_resids (list): resids within cutoff</dt><dd><dl class="simple">
<dt>if true_resids == True:</dt><dd><p>true resids; possible values are: minRES &lt;= value &lt;= maxRES</p>
</dd>
<dt>if true_resids == False:</dt><dd><p>codestyle resids; possible values are 0 &lt;= value &lt;= len(mobile.select_atoms(sel)))</p>
</dd>
</dl>
</dd>
</dl>
<p>GDT_cutoff (list): cutoff distances in Angstrom
RMSD (list): (RMSD before alignment, RMSD after elignment)
FRAME (list): analyzed frames</p>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>GDT_percent (list)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.gdt.GDT_continuous_segments">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.gdt.</span></code><code class="sig-name descname"><span class="pre">GDT_continuous_segments</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">GDT_resids</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.gdt.GDT_continuous_segments" title="Permalink to this definition">¶</a></dt>
<dd><p>Note: multiple frame function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>GDT_resids</strong> (<em>array</em>) – output of analysis.GDT()</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of continuous segments for each frame</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>SEGMENTS (list)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.gdt.GDT_match_cutoff_dim">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.gdt.</span></code><code class="sig-name descname"><span class="pre">GDT_match_cutoff_dim</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">GDT_percent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GDT_cutoff</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.gdt.GDT_match_cutoff_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Match GDT_cutoff array to the dimension of GDT_percent.
Used in combination with analysis.PLOT() function to plot multiple curves on one canvas.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>GDT_percent</strong> (<em>list/array</em>) – output of gdt.GDT()</p></li>
<li><p><strong>GDT_cutoff</strong> (<em>list/array</em>) – output of gdt.GDT()</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>GDT_cutoff with same dimension as GDT_percent</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>GDT_cutoff (list/array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.gdt.GDT_rank_percent">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.gdt.</span></code><code class="sig-name descname"><span class="pre">GDT_rank_percent</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">GDT_percent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.gdt.GDT_rank_percent" title="Permalink to this definition">¶</a></dt>
<dd><p>Ranks GDT_percent based on the sum of GDT_Px for all x in cutoff.
(Higher sum means better accuracy during protein alignment)</p>
<p>(Ranked) Psum can be view analogous to GDT scores but using all cutoffs
instead of specific ones</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>GDT_percent</strong> (<em>list</em>) – output of gdt.GDT()</p></li>
<li><p><strong>norm</strong> (<em>bool</em>) – norms Psum during sum of GDT_Px</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>ranked percent sum
RANKED_Psum_ndx (list): related indices of ranked percent sum</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>RANKED_Psum (list)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.gdt.GDT_rank_scores">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.gdt.</span></code><code class="sig-name descname"><span class="pre">GDT_rank_scores</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">GDT_percent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ranking_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GDT_TS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.gdt.GDT_rank_scores" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>GDT_percent</strong> (<em>list</em>) – output of analysis.GDT()</p></li>
<li><p><strong>ranking_order</strong> (<em>None/str</em>) – (None): output ranking orded by frame number
“Frame”: output ranking ordered by frame number
“GDT_TS”: output ranking ordered by GDT_TS
“GDT_HA”: output ranking ordered by GDT_HA</p></li>
<li><p><strong>prec</strong> (<em>None/int</em>) – (None) or -1: rounding off
(int): rounding to &lt;prec&gt; decimals</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>ranked array with GDT_TS values
GDT_HA_ranked (array): ranked array with GDT_HA values
GDT_ndx_ranked (array): array with corresponding index values</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>GDT_TS_ranked (array)</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>u = mda.Universe(&lt;top&gt;, &lt;traj&gt;)
r = mda.universe(&lt;ref&gt; )
GDT_cutoff, GDT_percent, GDT_resids, FRAME = gdt.GDT(u, r)
GDT_TS_ranked, GDT_HA_ranked, GDT_ndx_ranked = gdt.GDT_rank_scores(GDT_percent, ranking_order=”GDT_TS”)</p>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.gdt.get_GDT_HA">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.gdt.</span></code><code class="sig-name descname"><span class="pre">get_GDT_HA</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">GDT_percent</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.gdt.get_GDT_HA" title="Permalink to this definition">¶</a></dt>
<dd><p>GDT_HA: GlobalDistanceTest_HighAccuracy
Possible values: 0 &lt;= GDT_HA &lt;= 100</p>
<dl class="simple">
<dt>Calculate GDT_HA for any given GDT_percent array according to:</dt><dd><p>GDT_HA = (GDT_P0.5 + GDT_P1 + GDT_P2 + GDT_P4)/4,</p>
</dd>
</dl>
<p>where GDT_Px denotes the percentage of residues with distance cutoff &lt;= x Angstrom</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>GDT_percent</strong> (<em>list/array</em>) – output of analysis.GDT()</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>GDT_HA (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.gdt.get_GDT_TS">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.gdt.</span></code><code class="sig-name descname"><span class="pre">get_GDT_TS</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">GDT_percent</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.gdt.get_GDT_TS" title="Permalink to this definition">¶</a></dt>
<dd><p>GDT_TS: GlobalDistanceTest_TotalScore
Possible values: 0 &lt;= GDT_TS &lt;= 100</p>
<dl class="simple">
<dt>Calculate GDT_TS for any given GDT_percent array according to:</dt><dd><p>GDT_TS = (GDT_P1 + GDT_P2 + GDT_P4 + GDT_P8)/4,</p>
</dd>
</dl>
<p>where GDT_Px denotes the percentage of residues with distance cutoff &lt;= x Angstrom</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>GDT_percent</strong> (<em>list/array</em>) – output of gdt.GDT()</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>GDT_TS (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.gdt.get_Pair_Distances">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.gdt.</span></code><code class="sig-name descname"><span class="pre">get_Pair_Distances</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mobile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'protein</span> <span class="pre">and</span> <span class="pre">name</span> <span class="pre">CA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'protein</span> <span class="pre">and</span> <span class="pre">name</span> <span class="pre">CA'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.gdt.get_Pair_Distances" title="Permalink to this definition">¶</a></dt>
<dd><p>Aligns mobile to ref and calculates PairDistances (e.g. CA-CA distances).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mobile</strong> (<em>MDA universe/atomgrp</em>) – mobile structure with trajectory</p></li>
<li><p><strong>ref</strong> (<em>MDA universe/atomgrp</em>) – reference structure</p></li>
<li><p><strong>sel1</strong> (<em>str</em>) – selection string of mobile structure</p></li>
<li><p><strong>sel2</strong> (<em>str</em>) – selection string of reference structure</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PAIR_DISTANCES
RMSD (tuple): (RMSD before alignment, RMSD after alignment)
_resids_mobile (array)
_resids_ref (array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.gdt.get_array_percent">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.gdt.</span></code><code class="sig-name descname"><span class="pre">get_array_percent</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.gdt.get_array_percent" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Get percentage and indices of dist_array that fulfil the condition:</dt><dd><p>dist_array &lt;= cutoff</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dist_array</strong> (<em>array</em>) – distance array</p></li>
<li><p><strong>cutoff</strong> (<em>int/float</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>percent of dist_array (condition: dist_array &lt;= cutoff)
ndx (array): indices of dist_array (condition:
dist_array &lt;= cutoff)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>p (float)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.gdt.get_continuous_segments">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.gdt.</span></code><code class="sig-name descname"><span class="pre">get_continuous_segments</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.gdt.get_continuous_segments" title="Permalink to this definition">¶</a></dt>
<dd><p>Note: single frame function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>array</strong> (<em>array</em>) – ordered array with integers representing resids ~ single frame
e.g.: array = [5, 6, 7, 12, 13, 18, 19, 20]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of continuous segments</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>SEGMENTS (list)</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>&gt;&gt; gdt.get_continuous_segments([1,2,3,22,23,50,51,52])
[[1, 2, 3], [22, 23], [50, 51, 52]]</p>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.gdt.plot_GDT">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.gdt.</span></code><code class="sig-name descname"><span class="pre">plot_GDT</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">GDT_percent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GDT_cutoff</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.gdt.plot_GDT" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a GDT_PLOT.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>GDT_percent</strong> (<em>list/array</em>) – output of gdt.GDT()</p></li>
<li><p><strong>GDT_cutoff</strong> (<em>list/array</em>) – output of gdt.GDT()</p></li>
<li><p><strong>title</strong> (<em>str</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Kwargs:</dt><dd><p># see args of misc.figure()</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>fig (matplotlib.figure.Figure)
ax (ax/list of axes ~ matplotlib.axes._subplots.Axes)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.gdt.plot_LA">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.gdt.</span></code><code class="sig-name descname"><span class="pre">plot_LA</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mobile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GDT_TS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GDT_HA</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GDT_ndx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'protein</span> <span class="pre">and</span> <span class="pre">name</span> <span class="pre">CA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'protein</span> <span class="pre">and</span> <span class="pre">name</span> <span class="pre">CA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndx_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GDT_HA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_cbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_frames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_scores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_as</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.gdt.plot_LA" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Create LocalAccuracy Plot (heatmap) with:</dt><dd><p>xdata = Residue ID
ydata = Frame Number
color = color-coded Pair Distance</p>
</dd>
<dt>Note: be sure that you pass not too many data points otherwise this</dt><dd><p>function will just squeeze them in.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mobile</strong> (<em>MDA universe/atomgrp</em>) – mobile structure with trajectory</p></li>
<li><p><strong>ref</strong> (<em>MDA universe/atomgrp</em>) – reference structure</p></li>
<li><p><strong>GDT_TS</strong> (<em>array</em>) – array with GDT_TS values</p></li>
<li><p><strong>GDT_HA</strong> (<em>array</em>) – array with GDT_HA values</p></li>
<li><p><strong>GTD_ndx</strong> (<em>array</em>) – array with corresponding index values (representative for frame numbers)</p></li>
<li><p><strong>sel1</strong> (<em>str</em>) – selection string of mobile structure (calculation of PairDistances)</p></li>
<li><p><strong>sel2</strong> (<em>str</em>) – selection string of reference structure (calculation of PairDistances)</p></li>
<li><p><strong>ndx_offset</strong> (<em>int</em>) – offset/shift of GDT_ndx to match real “mobile” frames.
Look up “start” parameter during execution of analysis.GDT()</p></li>
<li><p><strong>rank_num</strong> (<em>int</em>) – plot only &lt;rank_num&gt; best ranked frames</p></li>
<li><p><strong>cmap</strong> (<em>str</em>) – <dl class="simple">
<dt>“GDT_TS” or “TS”: color map with new colors at values (0,  1, 2, 4, 8)</dt><dd><p>and vmin, vmax = (0, 10).</p>
</dd>
<dt>”GDT_HA” or “HA”: color map with new colors at values (0, .5, 1, 2, 4)</dt><dd><p>and vmin, vmax = (0, 5).</p>
</dd>
<dt>other cmap names: see help(plt.colormaps) or alternatively</dt><dd><p><a class="reference external" href="https://matplotlib.org/examples/color/colormaps_reference.html">https://matplotlib.org/examples/color/colormaps_reference.html</a></p>
</dd>
</dl>
</p></li>
<li><p><strong>show_cbar</strong> (<em>bool</em>) – show/hide colorbar</p></li>
<li><p><strong>show_scores</strong> (<em>bool</em>) – show/hide frames</p></li>
<li><p><strong>show_scores</strong> – show/hide GDT_TS and GDT_HA scores</p></li>
<li><p><strong>save_as</strong> (<em>str</em>) – save name or realpath to save file</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Kwargs:</dt><dd><p># see args of misc.figure()
prec (None/int): rounding of scores</p>
<blockquote>
<div><p>(None): rounding off
(int):  rounding on</p>
</div></blockquote>
<p>cbar_label/label (str)
cbar_fontweight/fontweight (str): “normal”, “bold”
cbar_location/location (str): “right”, “bottom”, “left”, “top”
cbar_orientation/orientation (str): “horizontal”, “vertical”
cbar_min / vmin (None/int): min value of colorbar and heatmap
cbar_max / vmax (None/int): max value of colorbar and heatmap
text_pos_Frame (list): [x0, y0] position of the “Frame” text box (label)
text_pos_TS (list): [x0, y0] position of the “TS” text box (label)
text_pos_HA (list): [x0, y0] position of the “HA” text box (label)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p>fig (matplotlib.figure.Figure)
ax (ax/list of axes ~ matplotlib.axes._subplots.Axes)
LA_data (tuple):</p>
<blockquote>
<div><p>LA_data[0]: PairDistances (list)
LA_data[1]: Frames (list)</p>
</div></blockquote>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p># obtain data
GDT = gdt.GDT(u, r, sss=[None,None,None])
GDT_percent, GDT_resids, GDT_cutoff, RMSD, FRAME = GDT</p>
<p># rank data
SCORES = gdt.GDT_rank_scores(GDT_percent, ranking_order=”GDT_HA”)
GDT_TS_ranked, GDT_HA_ranked, GDT_ndx_ranked = SCORES</p>
<p># edit text box positions of labels “Frame”, “TS”, “HA”
text_pos_kws = {“text_pos_Frame”: [-8.8, -0.3],</p>
<blockquote>
<div><p>“text_pos_TS”: [-4.2, -0.3],
“text_pos_HA”: [-1.9, -0.3]}</p>
</div></blockquote>
<p># plot
gdt.plot_LA(mobile, ref, SCORES[0], SCORES[1], SCORES[2], <a href="#id1"><span class="problematic" id="id2">**</span></a>text_pos_kws)</p>
</dd></dl>

<dl class="py function">
<dt id="pyREX.analysis.gdt.rank_scores">
<code class="sig-prename descclassname"><span class="pre">pyREX.analysis.gdt.</span></code><code class="sig-name descname"><span class="pre">rank_scores</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">GDT_TS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GDT_HA</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ranking_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GDT_TS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyREX.analysis.gdt.rank_scores" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>GDT_TS</strong> (<em>array</em>) – GlobalDistanceTest_TotalScore</p></li>
<li><p><strong>GDT_HA</strong> (<em>array</em>) – GlobalDistanceTest_HighAccuracy</p></li>
<li><p><strong>ranking_order</strong> (<em>None/str</em>) – (None): output ranking ordered by frame number
“FRAME”: output ranking ordered by frame number
“GDT_TS”: output ranking ordered by GDT_TS
“GDT_HA”: output ranking ordered by GDT_HA</p></li>
<li><p><strong>prec</strong> (<em>None/int</em>) – (None) or -1: rounding off
(int):  rounding on to &lt;prec&gt; decimals</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>ranked array with GDT_TS scores
GDT_HA_ranked (array): ranked array with GDT_HA scores
GDT_ndx_ranked (array): corresponding element indices of scores</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>GDT_TS_ranked (array)</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyREX.analysis">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyREX.analysis" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">pyREX</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">pyREX</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="pyREX.html">pyREX package</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="modules.html">pyREX</a><ul>
  <li><a href="pyREX.html">pyREX package</a><ul>
      <li>Previous: <a href="pyREX.html" title="previous chapter">pyREX package</a></li>
      <li>Next: <a href="pyREX.decoy.html" title="next chapter">pyREX.decoy package</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Arthur Voronin.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.5.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/pyREX.analysis.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>