

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>pyrexMD.misc &mdash; pyrexMD 1.1
 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/style.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #343131" >
          

          
            <a href="../../index.html" class="icon icon-home"> pyrexMD
          

          
          </a>

          
            
            
              <div class="version">
                1.1

              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../about_pyrexMD.html">About pyrexMD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quick_guide.html">Quick Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">API Docs</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">pyrexMD</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
          <li><a href="../pyrexMD.html">pyrexMD</a> &raquo;</li>
        
      <li>pyrexMD.misc</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pyrexMD.misc</h1><div class="highlight"><pre>
<span></span><span class="c1"># @Author: Arthur Voronin</span>
<span class="c1"># @Date:   17.04.2021</span>
<span class="c1"># @Filename: misc.py</span>
<span class="c1"># @Last modified by:   arthur</span>
<span class="c1"># @Last modified time: 29.06.2021</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This module is a collection of miscellaneous functions.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># miscellaneous</span>
<span class="kn">import</span> <span class="nn">PIL</span>
<span class="kn">import</span> <span class="nn">pdf2image</span>
<span class="kn">import</span> <span class="nn">pickle</span> <span class="k">as</span> <span class="nn">pl</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.gridspec</span> <span class="k">as</span> <span class="nn">gridspec</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">termcolor</span>


<div class="viewcode-block" id="apply_matplotlib_rc_settings"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.apply_matplotlib_rc_settings">[docs]</a><span class="k">def</span> <span class="nf">apply_matplotlib_rc_settings</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    apply matplotlib rc settings:</span>

<span class="sd">      - render math text including greek letters in italic font by default</span>
<span class="sd">      - render math text including greek letters in non-italic font using \\mathrm{}</span>
<span class="sd">      - does not require an external LaTeX installation</span>

<span class="sd">    Code:</span>

<span class="sd">      - matplotlib.rcParams[&#39;font.size&#39;] = 12</span>
<span class="sd">      - matplotlib.rcParams[&#39;font.weight&#39;] = &quot;normal&quot;</span>
<span class="sd">      - matplotlib.rcParams[&#39;font.family&#39;] = &#39;sans-serif&#39;</span>
<span class="sd">      - matplotlib.rcParams[&#39;font.sans-serif&#39;] = &#39;Arial&#39;</span>
<span class="sd">      - matplotlib.rcParams[&#39;mathtext.fontset&#39;] = &#39;custom&#39;</span>
<span class="sd">      - matplotlib.rcParams[&#39;mathtext.rm&#39;] = &#39;sans&#39;</span>
<span class="sd">      - matplotlib.rcParams[&#39;mathtext.it&#39;] = &#39;sans:italic&#39;</span>
<span class="sd">      - matplotlib.rcParams[&#39;mathtext.default&#39;] = &#39;it&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;normal&quot;</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;sans-serif&#39;</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.sans-serif&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Arial&#39;</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;mathtext.fontset&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;custom&#39;</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;mathtext.rm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;sans&#39;</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;mathtext.it&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;sans:italic&#39;</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;mathtext.default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;it&#39;</span>
    <span class="k">return</span></div>


<div class="viewcode-block" id="update_alias_docstring"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.update_alias_docstring">[docs]</a><span class="k">def</span> <span class="nf">update_alias_docstring</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Use an existing docstring as template and replace &#39;Alias function of &lt;alias&gt;&#39; part</span>

<span class="sd">      - determine docstring template based on length</span>
<span class="sd">      - test if docstring template contains &quot;Alias function of &lt;alias&gt;&quot;</span>
<span class="sd">      - copy and replace alias such that:</span>
<span class="sd">      | f1 docstring contains: Alias function of &lt;f2.__name__&gt;</span>
<span class="sd">      | f2 docstring contains: Alias function of &lt;f1.__name__&gt;</span>

<span class="sd">    Args:</span>
<span class="sd">        f1 (function): function with docstring (template)</span>
<span class="sd">        f2 (function): function with no/short docstring (replace with updated template)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span> <span class="s1">&#39;__call__&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">f2</span><span class="p">,</span> <span class="s1">&#39;__call__&#39;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span><span class="s2">&quot;f1 and f2 must be functions.&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="n">f1</span><span class="o">.</span><span class="vm">__doc__</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">f1</span><span class="p">,</span> <span class="n">f2</span> <span class="o">=</span> <span class="n">f2</span><span class="p">,</span> <span class="n">f1</span>
    <span class="k">if</span> <span class="n">f1</span><span class="o">.</span><span class="vm">__doc__</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span><span class="s2">&quot;f1 and f2 are both without docstring.&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">f1</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">f2</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">):</span>
            <span class="n">f1</span><span class="p">,</span> <span class="n">f2</span> <span class="o">=</span> <span class="n">f2</span><span class="p">,</span> <span class="n">f1</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="n">f2</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">f1</span><span class="o">.</span><span class="vm">__doc__</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Alias function of </span><span class="si">{</span><span class="n">f2</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Alias function of </span><span class="si">{</span><span class="n">f1</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="sa">f</span><span class="s2">&quot;Alias function of </span><span class="si">{</span><span class="n">f2</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">f1</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">f1</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> docstring does not contain &#39;Alias function of </span><span class="si">{</span><span class="n">f2</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="sa">f</span><span class="s2">&quot;Alias function of </span><span class="si">{</span><span class="n">f1</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">f2</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">f2</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> docstring does not contain &#39;Alias function of </span><span class="si">{</span><span class="n">f1</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
    <span class="k">return</span></div>


<span class="c1">################################################################################</span>
<span class="c1">################################################################################</span>
<span class="c1">### CUSTOM CLASSES</span>

<div class="viewcode-block" id="Error"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.Error">[docs]</a><span class="k">class</span> <span class="nc">Error</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for exceptions&quot;&quot;&quot;</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="dtypeError"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.dtypeError">[docs]</a><span class="k">class</span> <span class="nc">dtypeError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class for dtype exceptions</span>

<span class="sd">    Example:</span>
<span class="sd">        | &gt;&gt; misc.dtypeError(&quot;source&quot;, &quot;str&quot;)</span>
<span class="sd">        | TypeError: &lt;source&gt; must be str</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">dtype</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;dtypeError class usage: &lt;arg&gt; must be str&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;dtypeError class usage: &lt;dtype&gt; must be str&quot;</span><span class="p">)</span>

        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&lt;</span><span class="si">{</span><span class="n">arg</span><span class="si">}</span><span class="s2">&gt; must be </span><span class="si">{</span><span class="n">dtype</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="HiddenPrints"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.HiddenPrints">[docs]</a><span class="k">class</span> <span class="nc">HiddenPrints</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to hide print commands.</span>

<span class="sd">    Args:</span>
<span class="sd">        verbose (bool):</span>

<span class="sd">          | True: show prints</span>
<span class="sd">          | False: hide prints (default)</span>

<span class="sd">    Example:</span>
<span class="sd">        | with HiddenPrints():</span>
<span class="sd">        |   print(&quot;This print is hidden&quot;)</span>
<span class="sd">        | with HiddenPrints(verbose=True):</span>
<span class="sd">        |   print(&quot;This print is shown&quot;)</span>
<span class="sd">        | This print is shown</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_original_stdout</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">devnull</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">,</span> <span class="n">exc_tb</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_original_stdout</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="HiddenPrints_ALL"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.HiddenPrints_ALL">[docs]</a><span class="k">class</span> <span class="nc">HiddenPrints_ALL</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to hide all stdout and stderr prints.</span>

<span class="sd">    Args:</span>
<span class="sd">        verbose (bool):</span>
<span class="sd">          | True: show prints</span>
<span class="sd">          | False: hide prints (default)</span>

<span class="sd">    Example:</span>
<span class="sd">        | with HiddenPrints_ALL():</span>
<span class="sd">        |   print(&quot;This print is hidden&quot;)</span>
<span class="sd">        | with HiddenPrints(verbose=True):</span>
<span class="sd">        |   print(&quot;This print is shown&quot;)</span>
<span class="sd">        | This print is shown</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_original_stdout</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_original_stderr</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">devnull</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">devnull</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">,</span> <span class="n">exc_tb</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_original_stdout</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_original_stderr</span>

        <span class="k">return</span></div>


<div class="viewcode-block" id="CONFIG"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.CONFIG">[docs]</a><span class="k">class</span> <span class="nc">CONFIG</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to store config data.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dict_</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Init config object by passing a dict, kwargs or both.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">dict_</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dict_</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Alias of print_config() method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">print_config</span><span class="p">()</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set config object key via [] ~ backets, e.g. cfg[&quot;key&quot;] = value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="fm">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete config object key via [] ~ backets, e.g. del cfg[&quot;key&quot;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="fm">__delattr__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Make class objects subscriptable, i.e. access data via [] ~ brackets.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span>

<div class="viewcode-block" id="CONFIG.deepcopy"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.CONFIG.deepcopy">[docs]</a>    <span class="k">def</span> <span class="nf">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return deep copy of object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="CONFIG.deepcopy_without"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.CONFIG.deepcopy_without">[docs]</a>    <span class="k">def</span> <span class="nf">deepcopy_without</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keys</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return deep copy of cfg object but without passed keys.</span>

<span class="sd">        Args:</span>
<span class="sd">            keys (str, list, tuple):</span>
<span class="sd">              | str: single key</span>
<span class="sd">              | list, tuple: multiple keys</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="c1"># case 1: keys is a single key ~str</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">obj</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="c1"># case 2: keys is a list of keys</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">obj</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">pass</span>
        <span class="k">return</span> <span class="n">obj</span></div>

<div class="viewcode-block" id="CONFIG.keys"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.CONFIG.keys">[docs]</a>    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return dict keys.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span></div>

<div class="viewcode-block" id="CONFIG.values"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.CONFIG.values">[docs]</a>    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return dict values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">values</span><span class="p">()</span></div>

<div class="viewcode-block" id="CONFIG.items"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.CONFIG.items">[docs]</a>    <span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return dict items (key-value pairs).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span></div>

<div class="viewcode-block" id="CONFIG.update_config"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.CONFIG.update_config">[docs]</a>    <span class="k">def</span> <span class="nf">update_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dict_</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update config object by passing a dict, kwargs or both.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">dict_</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dict_</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="CONFIG.update_by_alias"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.CONFIG.update_by_alias">[docs]</a>    <span class="k">def</span> <span class="nf">update_by_alias</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alias</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">key_ndx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update key value for an alias if alias is in kwargs.</span>

<span class="sd">        Detailed Example:</span>
<span class="sd">          | default = {&quot;colors&quot;: [&quot;g&quot;, &quot;r&quot;],</span>
<span class="sd">          |            &quot;ms&quot;: 1}</span>
<span class="sd">          | alias_dict = {&quot;color_positive&quot;: &quot;teal&quot;,</span>
<span class="sd">          |               &quot;color_negative&quot;: &quot;orange&quot;,</span>
<span class="sd">          |               &quot;markersize&quot;: 5}</span>
<span class="sd">          | cfg = misc.CONFIG(default, **alias_dict)</span>
<span class="sd">          | cfg.print_config()</span>
<span class="sd">          | &gt;&gt;  key                 value</span>
<span class="sd">          |     colors              [&#39;g&#39;, &#39;r&#39;]</span>
<span class="sd">          |     ms                  1</span>
<span class="sd">          |     color_positive      teal</span>
<span class="sd">          |     color_negative      orange</span>
<span class="sd">          |     markersize          5</span>
<span class="sd">          |</span>
<span class="sd">          | cfg.update_by_alias(alias=&quot;markersize&quot;, key=&quot;ms&quot;, **alias_dict)</span>
<span class="sd">          | cfg.update_by_alias(alias=&quot;color_positive&quot;, key=&quot;colors&quot;, key_ndx=0, **alias_dict)</span>
<span class="sd">          | cfg.update_by_alias(alias=&quot;color_negative&quot;, key=&quot;colors&quot;, key_ndx=1, **alias_dict)</span>
<span class="sd">          | cfg.print_config()</span>
<span class="sd">          | &gt;&gt;  key                 value</span>
<span class="sd">          |     colors              [&#39;teal&#39;, &#39;orange&#39;]</span>
<span class="sd">          |     ms                  5</span>
<span class="sd">          |     color_positive      teal</span>
<span class="sd">          |     color_negative      orange</span>
<span class="sd">          |     markersize          5</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">alias</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key_ndx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">alias</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="n">key_ndx</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">alias</span><span class="p">]</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="CONFIG.pop"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.CONFIG.pop">[docs]</a>    <span class="k">def</span> <span class="nf">pop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        remove key from dict and return its value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></div>

<div class="viewcode-block" id="CONFIG.print_config"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.CONFIG.print_config">[docs]</a>    <span class="k">def</span> <span class="nf">print_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Print and return stored data in table format with &quot;key&quot; and &quot;value&quot; columns.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;key&#39;</span><span class="si">:</span><span class="s2">20</span><span class="si">}{</span><span class="s1">&#39;value&#39;</span><span class="si">:</span><span class="s2">20</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">&quot;</span>

        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">20</span><span class="si">}{</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">_str</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">_str</span></div></div>


<span class="c1">################################################################################</span>
<span class="c1">################################################################################</span>
<span class="c1">### timer stuff</span>


<div class="viewcode-block" id="TIMER"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.TIMER">[docs]</a><span class="k">class</span> <span class="nc">TIMER</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">_get_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span></div>


<div class="viewcode-block" id="timeit"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.timeit">[docs]</a><span class="k">def</span> <span class="nf">timeit</span><span class="p">(</span><span class="n">timer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;elapsed time:&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Test elapsed time of a process</span>

<span class="sd">    Args:</span>
<span class="sd">        timer (None, TIMER CLASS)</span>
<span class="sd">        msg (str): message</span>

<span class="sd">    Returns:</span>
<span class="sd">        timer (TIMER CLASS)</span>

<span class="sd">    Example:</span>

<span class="sd">      | t = TIMER()</span>
<span class="sd">      | timeit(t)</span>
<span class="sd">      | &lt;code&gt;</span>
<span class="sd">      | timeit(t)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">timer</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">timer</span> <span class="o">=</span> <span class="n">TIMER</span><span class="p">()</span>
        <span class="n">timer</span><span class="o">.</span><span class="n">t0</span> <span class="o">=</span> <span class="n">timer</span><span class="o">.</span><span class="n">_get_time</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">timer</span><span class="o">.</span><span class="n">t0</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">timer</span><span class="o">.</span><span class="n">t0</span> <span class="o">=</span> <span class="n">timer</span><span class="o">.</span><span class="n">_get_time</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">timer</span><span class="o">.</span><span class="n">t0</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">timer</span><span class="o">.</span><span class="n">t1</span> <span class="o">=</span> <span class="n">timer</span><span class="o">.</span><span class="n">_get_time</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">t1</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">t_diff</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">timer</span><span class="o">.</span><span class="n">t1</span> <span class="o">-</span> <span class="n">timer</span><span class="o">.</span><span class="n">t0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">t_diff</span><span class="si">}</span><span class="s2"> s&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">timer</span></div>


<span class="c1">################################################################################</span>
<span class="c1">################################################################################</span>
<span class="c1">### linux-like cmds ~ os package</span>

<div class="viewcode-block" id="cwd"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.cwd">[docs]</a><span class="k">def</span> <span class="nf">cwd</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Alias function of pwd(). Get/Print current working directory.</span>

<span class="sd">    Args:</span>
<span class="sd">        verbose (bool): print cwd</span>

<span class="sd">    Returns:</span>
<span class="sd">        cwd (str)</span>
<span class="sd">            current working directory</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="n">cprint</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;cwd: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span></div>


<div class="viewcode-block" id="pwd"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.pwd">[docs]</a><span class="k">def</span> <span class="nf">pwd</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">cwd</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span></div>


<span class="n">update_alias_docstring</span><span class="p">(</span><span class="n">cwd</span><span class="p">,</span> <span class="n">pwd</span><span class="p">)</span>


<div class="viewcode-block" id="isdir"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.isdir">[docs]</a><span class="k">def</span> <span class="nf">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return true if the path refers to an existing directory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></div>


<div class="viewcode-block" id="isfile"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.isfile">[docs]</a><span class="k">def</span> <span class="nf">isfile</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return true if the path refers to an existing file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></div>


<div class="viewcode-block" id="pathexists"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.pathexists">[docs]</a><span class="k">def</span> <span class="nf">pathexists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return true if path exists.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></div>


<div class="viewcode-block" id="realpath"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.realpath">[docs]</a><span class="k">def</span> <span class="nf">realpath</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return realpath.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></div>


<div class="viewcode-block" id="relpath"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.relpath">[docs]</a><span class="k">def</span> <span class="nf">relpath</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return relative path.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></div>


<div class="viewcode-block" id="dirpath"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.dirpath">[docs]</a><span class="k">def</span> <span class="nf">dirpath</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">realpath</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Alias function of get_filedir(). Get realpath or relpath of the last directory of &lt;path&gt;.</span>

<span class="sd">    Args:</span>
<span class="sd">        path (str)</span>

<span class="sd">    Returns:</span>
<span class="sd">        dirpath (str)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">realpath</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">path</span><span class="p">))</span></div>


<span class="c1">### Alias function of dirpath</span>
<div class="viewcode-block" id="get_filedir"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.get_filedir">[docs]</a><span class="k">def</span> <span class="nf">get_filedir</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">realpath</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">dirpath</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">realpath</span><span class="o">=</span><span class="n">realpath</span><span class="p">)</span></div>


<span class="n">update_alias_docstring</span><span class="p">(</span><span class="n">dirpath</span><span class="p">,</span> <span class="n">get_filedir</span><span class="p">)</span>


<div class="viewcode-block" id="get_filename"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.get_filename">[docs]</a><span class="k">def</span> <span class="nf">get_filename</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">search_file</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    get filename (removes prefix of realpath of &lt;path&gt;).</span>

<span class="sd">    Args:</span>
<span class="sd">        path (str)</span>
<span class="sd">        search_file (bool):</span>
<span class="sd">          | True: use &lt;path&gt; as search pattern to search for existing file</span>
<span class="sd">          | -&gt; remove prefix if only 1 match found to obtain existing filename</span>
<span class="sd">          | False: just remove prefix of given &lt;path&gt;</span>

<span class="sd">    Returns</span>
<span class="sd">        filename (str)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">search_file</span><span class="p">:</span>
        <span class="n">file_list</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">file_list</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">path</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">real_path</span> <span class="o">=</span> <span class="n">realpath</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">dir_path</span> <span class="o">=</span> <span class="n">dirpath</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">real_path</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">dir_path</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">return</span> <span class="n">filename</span></div>


<div class="viewcode-block" id="joinpath"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.joinpath">[docs]</a><span class="k">def</span> <span class="nf">joinpath</span><span class="p">(</span><span class="n">filedir</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">create_dir</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">realpath</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns joined path of (filedir + filename).</span>

<span class="sd">    Special case:</span>
<span class="sd">        filename contains relative or absolute path: ignore filedir input</span>

<span class="sd">    Reason:</span>
<span class="sd">        intention is to save/load file under the path &quot;filename&quot;</span>


<span class="sd">    Args:</span>
<span class="sd">        filedir (str): relative or absolute path of file directory</span>
<span class="sd">        filename (str): filename or relative/absolute filepath</span>
<span class="sd">        create_dir (bool): create filedir (w/o creating parent directories)</span>
<span class="sd">        realpath (bool): return realpath</span>

<span class="sd">    Returns:</span>
<span class="sd">        file_path (str)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;/&quot;</span> <span class="ow">in</span> <span class="n">filename</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">realpath</span><span class="p">:</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filedir</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">filename</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filedir</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">filename</span><span class="p">)))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">realpath</span><span class="p">:</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filedir</span><span class="p">,</span> <span class="n">filename</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filedir</span><span class="p">,</span> <span class="n">filename</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">create_dir</span><span class="p">:</span>
        <span class="c1"># filedir: passed file directory</span>
        <span class="c1"># dirname: dirname of file_path after joining (filedir + filename)</span>
        <span class="c1">#          SPECIAL CASE: filedir ignored if filename contains rel. or abs. path</span>
        <span class="c1">#          -&gt; dirname is not always equal to filedir</span>
        <span class="n">dirname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">file_path</span><span class="p">))</span>
        <span class="n">mkdir</span><span class="p">(</span><span class="n">dirname</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">file_path</span></div>


<div class="viewcode-block" id="mkdir"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.mkdir">[docs]</a><span class="k">def</span> <span class="nf">mkdir</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Make directory.</span>

<span class="sd">    Args:</span>
<span class="sd">        path (str): directory path</span>
<span class="sd">        verbose (bool): print message (&#39;New folder created: ...&#39;)</span>

<span class="sd">    Returns:</span>
<span class="sd">        realpath (str)</span>
<span class="sd">            realpath to new directory</span>

<span class="sd">    Example:</span>
<span class="sd">        | &gt;&gt; cwd = /home/user/</span>
<span class="sd">        | &gt;&gt; mkdir(&#39;Test1&#39;)</span>
<span class="sd">        | New folder created: /home/user/Test1</span>
<span class="sd">        | &gt;&gt;mkdir(&#39;../Test2&#39;)</span>
<span class="sd">        | New folder created: /home/Test2</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">realpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">realpath</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">realpath</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="n">cprint</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;New folder created: </span><span class="si">{</span><span class="n">realpath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">realpath</span></div>


<div class="viewcode-block" id="cd"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.cd">[docs]</a><span class="k">def</span> <span class="nf">cd</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Change directory.</span>

<span class="sd">    Args:</span>
<span class="sd">        path (str): directory path</span>
<span class="sd">        verbose (bool): print message (&#39;Changed directory to: ...&#39;)</span>

<span class="sd">    Returns:</span>
<span class="sd">        realpath (str)</span>
<span class="sd">            realpath of changed directory</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">realpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">realpath</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="n">cprint</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Changed directory to: </span><span class="si">{</span><span class="n">realpath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">realpath</span></div>


<div class="viewcode-block" id="cp"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.cp">[docs]</a><span class="k">def</span> <span class="nf">cp</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">create_dir</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Copy file(s) from &lt;source&gt; to &lt;target&gt;. Will overwrite existing files and directories.</span>

<span class="sd">    Args:</span>
<span class="sd">        source (str, list, array): source path or list of source paths</span>
<span class="sd">        target (str): target path</span>
<span class="sd">        create_dir (bool)</span>
<span class="sd">        verbose (bool)</span>

<span class="sd">    Returns:</span>
<span class="sd">        target (str)</span>
<span class="sd">            target realpath</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">dtypeError</span><span class="p">(</span><span class="s2">&quot;Wrong datatype: &lt;target&gt; must be str (path/realpath).&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;*&quot;</span> <span class="ow">in</span> <span class="n">source</span><span class="p">:</span>
        <span class="n">source</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
    <span class="n">target</span> <span class="o">=</span> <span class="n">realpath</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">copytree</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">dirs_exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="n">cprint</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Copied source files to: </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="n">cprint</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Copied source file to: </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">create_dir</span><span class="p">:</span>
            <span class="n">mkdir</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">source</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
                <span class="n">shutil</span><span class="o">.</span><span class="n">copytree</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">dirs_exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="n">cprint</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Copied source files to: </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">dtypeError</span><span class="p">(</span><span class="s2">&quot;source&quot;</span><span class="p">,</span> <span class="s2">&quot;str or list of str&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">target</span></div>


<div class="viewcode-block" id="rm"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.rm">[docs]</a><span class="k">def</span> <span class="nf">rm</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Alias function of remove(). Remove file(s) from path.</span>

<span class="sd">    .. Note:: pattern can be implemented into path variable directly.</span>

<span class="sd">    Args:</span>
<span class="sd">        path (str): directory path</span>
<span class="sd">        pattern (None, str):</span>
<span class="sd">          | pattern</span>
<span class="sd">          | None: check for files with path only</span>
<span class="sd">          | str:  check for files with joined path of path + pattern</span>
<span class="sd">        verbose (bool): print message (&#39;removed file: ... &#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">pattern</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">realpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">realpath</span> <span class="o">=</span> <span class="n">joinpath</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">pattern</span><span class="p">)</span>

    <span class="c1"># remove files</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">realpath</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="n">cprint</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;removed file: </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;red&quot;</span><span class="p">)</span>
    <span class="k">return</span></div>


<span class="c1">### Alias function of rm()</span>
<div class="viewcode-block" id="remove"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.remove">[docs]</a><span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">rm</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span></div>


<span class="n">update_alias_docstring</span><span class="p">(</span><span class="n">rm</span><span class="p">,</span> <span class="n">remove</span><span class="p">)</span>


<div class="viewcode-block" id="bash_cmd"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.bash_cmd">[docs]</a><span class="k">def</span> <span class="nf">bash_cmd</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Execute any bash command via python.</span>

<span class="sd">    .. Note:: works with pipe.</span>

<span class="sd">    Args:</span>
<span class="sd">        cmd (str): bash cmd</span>
<span class="sd">        verbose (bool): print executed shell command</span>

<span class="sd">    Example:</span>
<span class="sd">        | &gt;&gt; bash_cmd(&quot;ls&quot;)</span>
<span class="sd">        | &gt;&gt; bash_cmd(&quot;touch test&quot;)</span>
<span class="sd">        | &gt;&gt; bash_cmd(&quot;ls&quot;)</span>
<span class="sd">        | test</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;executing shell command:&quot;</span><span class="p">,</span> <span class="n">cmd</span><span class="p">)</span>

    <span class="n">p</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">stdin</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># wait until subprocess is finished</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">p</span><span class="o">.</span><span class="n">poll</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">returncode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="n">p</span><span class="o">.</span><span class="n">returncode</span></div>


<span class="c1">################################################################################</span>
<span class="c1">################################################################################</span>
<span class="c1">### pillow/PIL stuff</span>


<div class="viewcode-block" id="convert_image"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.convert_image">[docs]</a><span class="k">def</span> <span class="nf">convert_image</span><span class="p">(</span><span class="n">fin</span><span class="p">,</span> <span class="n">fout</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts image type. Currently ONLY tested for</span>

<span class="sd">        - pdf -&gt; png</span>
<span class="sd">        - png -&gt; tiff</span>
<span class="sd">        - tiff -&gt; png</span>


<span class="sd">    Args:</span>
<span class="sd">        fin (str): file path for file in (including extension)</span>
<span class="sd">        fout (str): file path for file out (including extension)</span>
<span class="sd">        format (str):</span>
<span class="sd">          | fout format/extension</span>
<span class="sd">          | &quot;auto&quot;</span>
<span class="sd">          | &quot;png&quot;</span>

<span class="sd">    Keyword Args:</span>
<span class="sd">        dpi (tuple): dpi for each direction</span>
<span class="sd">        quality (int): compression quality:  0 to 100</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">default</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;dpi&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span>
               <span class="s2">&quot;quality&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">}</span>
    <span class="n">cfg</span> <span class="o">=</span> <span class="n">CONFIG</span><span class="p">(</span><span class="n">default</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1">###############################</span>
    <span class="k">if</span> <span class="s2">&quot;pdf&quot;</span> <span class="ow">in</span> <span class="n">fin</span><span class="p">:</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">pdf2image</span><span class="o">.</span><span class="n">convert_from_path</span><span class="p">(</span><span class="n">fin</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">PIL</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fin</span><span class="p">)</span>
        <span class="n">image</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;RGB&quot;</span><span class="p">)</span>
    <span class="c1"># output format</span>
    <span class="k">if</span> <span class="nb">format</span> <span class="o">==</span> <span class="s2">&quot;auto&quot;</span><span class="p">:</span>
        <span class="nb">format</span> <span class="o">=</span> <span class="n">get_extension</span><span class="p">(</span><span class="n">fout</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="n">image</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">fout</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="nb">format</span><span class="p">,</span> <span class="o">**</span><span class="n">cfg</span><span class="p">)</span>
    <span class="k">return</span></div>


<div class="viewcode-block" id="convert_multiple_images"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.convert_multiple_images">[docs]</a><span class="k">def</span> <span class="nf">convert_multiple_images</span><span class="p">(</span><span class="n">folder_in</span><span class="p">,</span> <span class="n">folder_out</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    convert multiple images. Currently ONLY tested for</span>

<span class="sd">        - pdf -&gt; png</span>
<span class="sd">        - png -&gt; tiff</span>
<span class="sd">        - tiff -&gt; png</span>

<span class="sd">    Args:</span>
<span class="sd">        folder_in (str):  file path for folder with input  images</span>
<span class="sd">        folder_out (str): file path for folder with output images</span>
<span class="sd">        format (str):</span>
<span class="sd">          | fout format/extension</span>
<span class="sd">          | &quot;auto&quot;</span>
<span class="sd">          | &quot;png&quot;</span>

<span class="sd">    Keyword Args:</span>
<span class="sd">        dpi (tuple): dpi for each direction</span>
<span class="sd">        quality (int): compression quality:  0 to 100</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">default</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;dpi&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span>
               <span class="s2">&quot;quality&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">}</span>
    <span class="n">cfg</span> <span class="o">=</span> <span class="n">CONFIG</span><span class="p">(</span><span class="n">default</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1">###############################</span>
    <span class="n">images</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder_in</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">folder_in</span><span class="p">)</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder_in</span><span class="p">,</span> <span class="n">file</span><span class="p">))]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">images</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">get_base</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">name_out</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">folder_out</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="nb">format</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">convert_image</span><span class="p">(</span><span class="n">fin</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">fout</span><span class="o">=</span><span class="n">name_out</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="nb">format</span><span class="p">,</span> <span class="o">**</span><span class="n">cfg</span><span class="p">)</span>
    <span class="k">return</span></div>


<span class="c1">################################################################################</span>
<span class="c1">################################################################################</span>
<span class="c1">### misc</span>

<div class="viewcode-block" id="cprint"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.cprint">[docs]</a><span class="k">def</span> <span class="nf">cprint</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Alias function of termcolor.cprint(). Apply colored print.</span>

<span class="sd">    Args:</span>
<span class="sd">        msg (str)</span>
<span class="sd">        color (None, str): &quot;grey&quot;, &quot;red&quot;, &quot;green&quot;, &quot;yellow&quot;, &quot;blue&quot;, &quot;magenta&quot;, &quot;cyan&quot;, &quot;white&quot;</span>
<span class="sd">        on_color (None, str): &quot;on_grey&quot;, &quot;on_red&quot;, &quot;on_green&quot;, &quot;on_yellow&quot;, &quot;on_blue&quot;, &quot;on_magenta&quot;, &quot;on_cyan&quot;, &quot;on_white&quot;</span>
<span class="sd">        attr (None, list):</span>
<span class="sd">          | attributes list</span>
<span class="sd">          | bold, dark, underline, blink, reverse, concealed</span>

<span class="sd">    Keyword Args:</span>
<span class="sd">        cprint_color (None, str): alias for color (with higher priority)</span>
<span class="sd">        sep (str): string inserted between values, default a space.</span>
<span class="sd">        end (str): string appended after the last value, default a newline.</span>
<span class="sd">        file (str): a file-like object (stream); defaults to the current sys.stdout.</span>
<span class="sd">        flush (bool): whether to forcibly flush the stream.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;cprint_color&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;cprint_color&quot;</span><span class="p">]</span>
        <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;cprint_color&quot;</span><span class="p">]</span>
    <span class="n">termcolor</span><span class="o">.</span><span class="n">cprint</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">on_color</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span></div>


<div class="viewcode-block" id="UNZIP"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.UNZIP">[docs]</a><span class="k">def</span> <span class="nf">UNZIP</span><span class="p">(</span><span class="n">iterable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    alias function of zip(\*iterable)</span>

<span class="sd">    Args:</span>
<span class="sd">        iterable</span>

<span class="sd">    Returns:</span>
<span class="sd">        zip(\*iterable)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">iterable</span><span class="p">)</span></div>


<div class="viewcode-block" id="unzip"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.unzip">[docs]</a><span class="k">def</span> <span class="nf">unzip</span><span class="p">(</span><span class="n">iterable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Unzips iterable into two objects.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">A</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">UNZIP</span><span class="p">(</span><span class="n">iterable</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">B</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">UNZIP</span><span class="p">(</span><span class="n">iterable</span><span class="p">))[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span></div>


<div class="viewcode-block" id="get_python_version"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.get_python_version">[docs]</a><span class="k">def</span> <span class="nf">get_python_version</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns python version.</span>

<span class="sd">    Returns:</span>
<span class="sd">        version (str):</span>
<span class="sd">            python version in format major.minor.micro (e.g. 3.8.5)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">major</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">minor</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">micro</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">version</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">major</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">minor</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">micro</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="n">version</span></div>


<div class="viewcode-block" id="percent"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.percent">[docs]</a><span class="k">def</span> <span class="nf">percent</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">div</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the percentage of num/div as float</span>

<span class="sd">    Args:</span>
<span class="sd">        num (int): numerator</span>
<span class="sd">        div (int): divisor</span>
<span class="sd">        prec (None, int): rounding precision</span>

<span class="sd">    Returns:</span>
<span class="sd">        p (float)</span>
<span class="sd">            p = 100 * num/div</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">num</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
    <span class="n">div</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">div</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">div</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">0.0</span>             <span class="c1"># no division by zero</span>
    <span class="n">p</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">num</span> <span class="o">/</span> <span class="n">div</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">p</span></div>


<div class="viewcode-block" id="round_down"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.round_down">[docs]</a><span class="k">def</span> <span class="nf">round_down</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        number (float/int)</span>
<span class="sd">        base (float/int)</span>

<span class="sd">    Example:</span>
<span class="sd">      | for i in range(11):</span>
<span class="sd">      |     print(i, round_down(i,5))</span>
<span class="sd">      | (0, 0)</span>
<span class="sd">      | (1, 0)</span>
<span class="sd">      | (2, 0)</span>
<span class="sd">      | (3, 0)</span>
<span class="sd">      | (4, 0)</span>
<span class="sd">      | (5, 5)   # does not round down if remainder is zero</span>
<span class="sd">      | (6, 5)</span>
<span class="sd">      | (7, 5)</span>
<span class="sd">      | (8, 5)</span>
<span class="sd">      | (9, 5)</span>
<span class="sd">      | (10, 10)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">number</span> <span class="o">-</span> <span class="p">(</span><span class="n">number</span> <span class="o">%</span> <span class="n">base</span><span class="p">)</span></div>


<div class="viewcode-block" id="round_up"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.round_up">[docs]</a><span class="k">def</span> <span class="nf">round_up</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        number (float/int)</span>
<span class="sd">        base (float/int)</span>

<span class="sd">    Example:</span>
<span class="sd">      | for i in range(11):</span>
<span class="sd">      |     print(i, round_up(i,5))</span>
<span class="sd">      | (0, 0)</span>
<span class="sd">      | (1, 5)</span>
<span class="sd">      | (2, 5)</span>
<span class="sd">      | (3, 5)</span>
<span class="sd">      | (4, 5)</span>
<span class="sd">      | (5, 5)   # does not round up if remainder is zero</span>
<span class="sd">      | (6, 10)</span>
<span class="sd">      | (7, 10)</span>
<span class="sd">      | (8, 10)</span>
<span class="sd">      | (9, 10)</span>
<span class="sd">      | (10, 10)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">number</span> <span class="o">%</span> <span class="n">base</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">number</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">number</span> <span class="o">+</span> <span class="n">base</span> <span class="o">-</span> <span class="p">(</span><span class="n">number</span> <span class="o">%</span> <span class="n">base</span><span class="p">)</span></div>


<div class="viewcode-block" id="round_to_base"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.round_to_base">[docs]</a><span class="k">def</span> <span class="nf">round_to_base</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Round up or down depending on smallest difference to base.</span>

<span class="sd">    Args:</span>
<span class="sd">        number (float/int)</span>
<span class="sd">        base (float/int)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">up</span> <span class="o">=</span> <span class="n">round_up</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
    <span class="n">down</span> <span class="o">=</span> <span class="n">round_down</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">up</span><span class="o">-</span><span class="n">number</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">abs</span><span class="p">(</span><span class="n">number</span><span class="o">-</span><span class="n">down</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">up</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">down</span></div>


<div class="viewcode-block" id="round_object"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.round_object">[docs]</a><span class="k">def</span> <span class="nf">round_object</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        object (list, array):</span>
<span class="sd">          | single list/array</span>
<span class="sd">          | list of lists/arrays</span>
<span class="sd">          | array of lists/arrays</span>
<span class="sd">        prec (int): rounding precision</span>
<span class="sd">        dtype (None, dtype): return object values as specific data type</span>

<span class="sd">    Returns:</span>
<span class="sd">        new_object (list, array)</span>
<span class="sd">            same structure as object, but with rounded values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># single list/array (if error occurs, maybe add more np.&lt;data types&gt; to this case)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">object</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)):</span>
        <span class="n">new_object</span> <span class="o">=</span> <span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">object</span><span class="p">]</span>

    <span class="c1"># list of lists</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">object</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">new_object</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="nb">object</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sublist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
                <span class="n">new_sublist</span> <span class="o">=</span> <span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span>
                <span class="n">new_object</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_sublist</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_object</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sublist</span><span class="p">)</span>

    <span class="c1"># list of arrays</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">object</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">new_object</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">subarray</span> <span class="ow">in</span> <span class="nb">object</span><span class="p">:</span>
            <span class="n">new_subarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">subarray</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span>
            <span class="n">new_object</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_subarray</span><span class="p">)</span>

    <span class="c1"># array of lists/arrays: convert outer list to array</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">new_object</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">new_object</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">new_object</span></div>


<div class="viewcode-block" id="get_substrings"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.get_substrings">[docs]</a><span class="k">def</span> <span class="nf">get_substrings</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">seperators</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="s2">&quot;;&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    get substrings of string by removing each seperator.</span>

<span class="sd">    Args:</span>
<span class="sd">        string (str)</span>
<span class="sd">        seperators (list)</span>
<span class="sd">        reverse (bool): return substrings in reversed order</span>

<span class="sd">    Returns:</span>
<span class="sd">        substrings (list)</span>
<span class="sd">            list of substrings</span>

<span class="sd">    Example:</span>
<span class="sd">        | &gt;&gt; get_substrings(&quot;split/this_string.into:parts&quot;)</span>
<span class="sd">        | [&#39;split&#39;, &#39;this&#39;, &#39;string&#39;, &#39;into&#39;, &#39;parts&#39;]</span>
<span class="sd">        | &gt;&gt; get_substrings(&quot;split/this_string.into:parts&quot;, reverse=True)</span>
<span class="sd">        | [&#39;parts&#39;, &#39;into&#39;, &#39;string&#39;, &#39;this&#39;, &#39;split&#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">sep</span> <span class="ow">in</span> <span class="n">seperators</span><span class="p">:</span>
        <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">sep</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
    <span class="n">substrings</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">reverse</span><span class="p">:</span>
        <span class="n">substrings</span> <span class="o">=</span> <span class="n">substrings</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">substrings</span></div>


<div class="viewcode-block" id="split_lists"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.split_lists">[docs]</a><span class="k">def</span> <span class="nf">split_lists</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">remap</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    split list A into two lists B1 and B2 according to A = B1 + B2,</span>
<span class="sd">    where B2 contains every n-th element of A.</span>

<span class="sd">    Args:</span>
<span class="sd">        A (int, list, array):</span>
<span class="sd">          | int: initialize A according to: A = list(range(A))</span>
<span class="sd">          | list, array: input list A which should be split</span>
<span class="sd">        n (int): split every n-th element of A into B2</span>
<span class="sd">        remap (bool): remap Bi according to: Bi = range(0, len(Bi))</span>

<span class="sd">    Returns:</span>
<span class="sd">        A (list)</span>
<span class="sd">            input list A</span>
<span class="sd">        B1 (list)</span>
<span class="sd">            partial list B1</span>
<span class="sd">        B2 (list)</span>
<span class="sd">            partial list B2 (contains every n-th element of A)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">A</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span> <span class="nb">type</span><span class="p">((</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">))))):</span>
        <span class="n">A</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;A has to be int, list/np.array or range/generator.&quot;</span><span class="p">)</span>

    <span class="n">B1</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">B2</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">remap</span><span class="p">:</span>
        <span class="n">B1</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">B1</span><span class="p">)))</span>
        <span class="n">B2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">B2</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">A</span><span class="p">,</span> <span class="n">B1</span><span class="p">,</span> <span class="n">B2</span></div>


<div class="viewcode-block" id="flatten_array"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.flatten_array">[docs]</a><span class="k">def</span> <span class="nf">flatten_array</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns flattened array of x.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (array, array of arrays)</span>

<span class="sd">    Returns:</span>
<span class="sd">        flattened_array (array)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">flattened_array</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">x</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sub</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="n">flattened_array</span> <span class="o">=</span> <span class="n">x</span>
    <span class="k">return</span> <span class="n">flattened_array</span></div>


<div class="viewcode-block" id="norm_array"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.norm_array">[docs]</a><span class="k">def</span> <span class="nf">norm_array</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">start_value</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    norm array</span>

<span class="sd">      - starts with &lt;start_value&gt;</span>
<span class="sd">      - deltaValue is fixed to 1 (i.e. array[i]- array[i+1] = 1)</span>

<span class="sd">    Args:</span>
<span class="sd">        array (list, array)</span>

<span class="sd">    Returns:</span>
<span class="sd">        normed_array (list, array)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
    <span class="n">normed_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">l</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">normed_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">normed_array</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
        <span class="n">normed_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">start_value</span>
    <span class="k">return</span> <span class="n">normed_array</span></div>


<div class="viewcode-block" id="get_precision"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.get_precision">[docs]</a><span class="k">def</span> <span class="nf">get_precision</span><span class="p">(</span><span class="n">number</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns leading precision of number.</span>

<span class="sd">      - convert float to string</span>
<span class="sd">      - find position of decimal point relative to the length of the string</span>

<span class="sd">    Args:</span>
<span class="sd">        number (int, float)</span>

<span class="sd">    Returns:</span>
<span class="sd">        precision (int)</span>

<span class="sd">    Example:</span>
<span class="sd">        | &gt;&gt; get_precision(5.00000)</span>
<span class="sd">        | 1</span>
<span class="sd">        | &gt;&gt; get_precision(5.12300)</span>
<span class="sd">        | 3</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">number</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">number</span> <span class="o">=</span> <span class="n">number</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>
    <span class="n">precision</span> <span class="o">=</span> <span class="n">s</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">precision</span></div>


<div class="viewcode-block" id="get_base"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.get_base">[docs]</a><span class="k">def</span> <span class="nf">get_base</span><span class="p">(</span><span class="n">_str</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get base (i.e. everything except extension) of string &quot;_str&quot;.</span>

<span class="sd">    Args:</span>
<span class="sd">        _str (str)</span>

<span class="sd">    Returns:</span>
<span class="sd">        base (str)</span>
<span class="sd">            base of _str</span>

<span class="sd">    Example:</span>
<span class="sd">        | &gt;&gt; get_base(&quot;random_plot.png&quot;)</span>
<span class="sd">        | &quot;random_plot&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">_str</span><span class="p">)</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">base</span> <span class="o">=</span> <span class="n">_str</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">base</span></div>


<div class="viewcode-block" id="get_extension"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.get_extension">[docs]</a><span class="k">def</span> <span class="nf">get_extension</span><span class="p">(</span><span class="n">_str</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get &quot;.ext&quot; (extension) of string &quot;_str&quot;.</span>

<span class="sd">    Args:</span>
<span class="sd">        _str (str)</span>

<span class="sd">    Returns:</span>
<span class="sd">        ext (str)</span>
<span class="sd">            extension of _str</span>

<span class="sd">    Example:</span>
<span class="sd">        | &gt;&gt; get_extension(&quot;random_plot.png&quot;)</span>
<span class="sd">        | &quot;.png&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">_str</span><span class="p">)</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">ext</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="o">+</span><span class="n">_str</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">ext</span></div>


<div class="viewcode-block" id="insert_str"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.insert_str">[docs]</a><span class="k">def</span> <span class="nf">insert_str</span><span class="p">(</span><span class="n">str1</span><span class="p">,</span> <span class="n">str2</span><span class="p">,</span> <span class="n">sep</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;after&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Insert str2 in str1.</span>

<span class="sd">    Args:</span>
<span class="sd">        str1 (str): base string</span>
<span class="sd">        str2 (str): append string</span>
<span class="sd">        sep (str): seperator</span>
<span class="sd">        loc (str): insert location: &#39;before&#39; or &#39;after&#39; first seperator in str1</span>

<span class="sd">    Returns:</span>
<span class="sd">        _str (str)</span>

<span class="sd">            new string</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">loc</span> <span class="o">==</span> <span class="s2">&quot;after&quot;</span><span class="p">:</span>
        <span class="n">_str</span> <span class="o">=</span> <span class="n">str1</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">sep</span> <span class="o">+</span> <span class="n">str2</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sep</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">str1</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="k">elif</span> <span class="n">loc</span> <span class="o">==</span> <span class="s2">&quot;before&quot;</span><span class="p">:</span>
        <span class="n">_str</span> <span class="o">=</span> <span class="n">str1</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">str2</span> <span class="o">+</span> <span class="n">sep</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sep</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">str1</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span><span class="s2">&quot;loc argument must be either &#39;before&#39; or &#39;after&#39;.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_str</span></div>


<div class="viewcode-block" id="autodetect_header"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.autodetect_header">[docs]</a><span class="k">def</span> <span class="nf">autodetect_header</span><span class="p">(</span><span class="n">fin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Autodetects header.</span>

<span class="sd">    Args:</span>
<span class="sd">        fin (str): input file (path)</span>

<span class="sd">    Returns:</span>
<span class="sd">        header_rows (int)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">header_rows</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">extension</span> <span class="o">=</span> <span class="n">get_extension</span><span class="p">(</span><span class="n">fin</span><span class="p">)</span>
    <span class="n">CHAR_SET</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2"> .,0123456789&quot;</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fin</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="n">n_lines</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">extension</span> <span class="o">==</span> <span class="s2">&quot;.pdb&quot;</span><span class="p">:</span>
                <span class="n">l</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                <span class="k">if</span> <span class="n">l</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">():</span>
                    <span class="k">break</span>
                <span class="k">if</span> <span class="s2">&quot;ATOM&quot;</span> <span class="ow">in</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]:</span>
                    <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">header_rows</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">l</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">l</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">CHAR_SET</span><span class="p">):</span>
                    <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">header_rows</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># check if header was found</span>
        <span class="k">if</span> <span class="n">n_lines</span> <span class="o">==</span> <span class="n">header_rows</span><span class="p">:</span>
            <span class="n">header_rows</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="n">header_rows</span></div>


<div class="viewcode-block" id="read_file"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.read_file">[docs]</a><span class="k">def</span> <span class="nf">read_file</span><span class="p">(</span><span class="n">fin</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">n_rows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Read file and return tuple of np.arrays with data for specified columns.</span>

<span class="sd">    Args:</span>
<span class="sd">        fin (str): input file (path)</span>
<span class="sd">        sep (None, str):</span>
<span class="sd">          | seperator of columns.</span>
<span class="sd">          | None: whitespace</span>
<span class="sd">        usecols (int, sequence): data columns</span>
<span class="sd">        n_rows (None, int): lenght of returned data (AFTER skipping rows)</span>
<span class="sd">        skiprows (None, &#39;auto&#39;, int):</span>
<span class="sd">          | ignore header rows of fin</span>
<span class="sd">          | &#39;auto&#39; or -1: auto detect</span>
<span class="sd">        dtype (dtype cls, list, tuple):</span>
<span class="sd">          | data type of returned np.array</span>
<span class="sd">          | dtype cls: all data types are same</span>
<span class="sd">          | list/tuple of dtype cls: specify dtype of each data column</span>
<span class="sd">          |</span>
<span class="sd">          | valid dtypes:</span>
<span class="sd">          |     str, int, float, complex</span>

<span class="sd">    Returns:</span>
<span class="sd">        data_array (array)</span>
<span class="sd">            if usecols is int ~ data of one column specified in usecols</span>
<span class="sd">        data_list (list)</span>
<span class="sd">            if usecols is list ~ data of each column specified in usecols</span>

<span class="sd">    Example:</span>
<span class="sd">        | # single columns per fin</span>
<span class="sd">        | X = read_file(&#39;data.txt&#39;, usecols=0)</span>
<span class="sd">        | Y = read_file(&#39;data.txt&#39;, usecols=1)</span>
<span class="sd">        | # multiple columns per fin</span>
<span class="sd">        | X,Y = read_file(&#39;data.txt&#39;, usecols=(0,1))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">skiprows</span> <span class="o">==</span> <span class="s2">&quot;auto&quot;</span> <span class="ow">or</span> <span class="n">skiprows</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">skiprows</span> <span class="o">=</span> <span class="n">autodetect_header</span><span class="p">(</span><span class="n">fin</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">skiprows</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">skiprows</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">usecols</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">fin</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="n">sep</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="n">skiprows</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="n">usecols</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">col</span><span class="p">[:</span><span class="n">n_rows</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">col</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">DATA</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">usecols</span><span class="p">)):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                <span class="n">col</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">fin</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="n">sep</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="n">skiprows</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="n">usecols</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">col</span> <span class="o">=</span> <span class="n">col</span><span class="p">[:</span><span class="n">n_rows</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">col</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">fin</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="n">sep</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="n">skiprows</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="n">usecols</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
                <span class="n">col</span> <span class="o">=</span> <span class="n">col</span><span class="p">[:</span><span class="n">n_rows</span><span class="p">]</span>
            <span class="n">DATA</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">DATA</span></div>


<div class="viewcode-block" id="read_DCA_file"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.read_DCA_file">[docs]</a><span class="k">def</span> <span class="nf">read_DCA_file</span><span class="p">(</span><span class="n">DCA_fin</span><span class="p">,</span> <span class="n">n_DCA</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">skiprows</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">filter_DCA</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">RES_range</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Read DCA file and return DCA pairs IJ.</span>

<span class="sd">    Args:</span>
<span class="sd">        DCA_fin (str): DCA input file (path)</span>
<span class="sd">        n_DCA (int): number of used DCA contacts</span>
<span class="sd">        usecols (tuple, list): columns containing the RES pairs in DCA_fin</span>
<span class="sd">        skiprows (&#39;auto&#39;, int):</span>
<span class="sd">          | ignore header rows of DCA_fin</span>
<span class="sd">          | &#39;auto&#39; or -1: auto detect</span>
<span class="sd">        filter_DCA (bool):</span>
<span class="sd">          | True: ignore DCA pairs with abs(i-j) &lt; 4</span>
<span class="sd">          | False: use all DCA pairs w/o applying filter</span>
<span class="sd">        RES_range (None):</span>
<span class="sd">          | Use RES within [RES_min, RES_max] range.</span>
<span class="sd">          | None: do not narrow down RES range</span>

<span class="sd">    Returns:</span>
<span class="sd">        DCA_PAIRS (list)</span>
<span class="sd">            DCA pairs IJ</span>
<span class="sd">        DCA_PAIRS_RES_range (list)</span>
<span class="sd">            [RES_min, RES_max] of DCA_PAIRS (not input RES_range values)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">I</span><span class="p">,</span> <span class="n">J</span> <span class="o">=</span> <span class="n">read_file</span><span class="p">(</span><span class="n">DCA_fin</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="n">usecols</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="n">skiprows</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int_</span><span class="p">)</span>
    <span class="n">DCA_PAIRS</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">RES_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">RES_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">I</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">J</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">RES_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">RES_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">I</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">J</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">I</span><span class="p">)):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">DCA_PAIRS</span><span class="p">)</span> <span class="o">==</span> <span class="n">n_DCA</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">if</span> <span class="n">filter_DCA</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">I</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">J</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
                <span class="k">pass</span>    <span class="c1"># ignore sites with indexdiff &lt; 4</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">I</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">RES_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">J</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">RES_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">DCA_PAIRS</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">I</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">J</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">DCA_PAIRS</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">I</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">J</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>

        <span class="n">DCA_PAIRS_RES_range</span> <span class="o">=</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">I</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">J</span><span class="p">)),</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">I</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">J</span><span class="p">))]</span>
    <span class="k">return</span> <span class="n">DCA_PAIRS</span><span class="p">,</span> <span class="n">DCA_PAIRS_RES_range</span></div>


<div class="viewcode-block" id="get_PDBid"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.get_PDBid">[docs]</a><span class="k">def</span> <span class="nf">get_PDBid</span><span class="p">(</span><span class="n">ref</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Obtains PDB id from ref by splitting its path and searching for alpha numerical (alnum) strings with length 4.</span>

<span class="sd">    Args:</span>
<span class="sd">        ref (str, universe, atomgrp): reference structure</span>

<span class="sd">    Returns:</span>
<span class="sd">        PDBid (str)</span>
<span class="sd">            if ref path contains one unique alnum string with length 4</span>
<span class="sd">        PDBid (list)</span>
<span class="sd">            if ref path contains multiple unique alnum strings with length 4</span>
<span class="sd">        None (None)</span>
<span class="sd">            else</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">ref</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span>
        <span class="n">ref</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span>
        <span class="n">split</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ref</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ref</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">universe</span><span class="o">.</span><span class="n">filename</span>
            <span class="n">ref</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span>
            <span class="n">ref</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span>
            <span class="n">split</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ref</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)]</span>

        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;get_PDBid(ref): AttributeError</span><span class="se">\</span>
<span class="s2">                 </span><span class="se">\n</span><span class="s2">Can&#39;t obtain PDBid since ref is neither a path nor a MDA universe/atomgrp with the attribute ref.universe.filename&quot;</span><span class="p">)</span>
            <span class="k">return</span>

    <span class="n">PDBid</span> <span class="o">=</span> <span class="p">[]</span>   <span class="c1"># list for guessed PDBids</span>
    <span class="n">split</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">split</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;logs&quot;</span><span class="p">,</span> <span class="s2">&quot;used&quot;</span><span class="p">,</span> <span class="s2">&quot;from&quot;</span><span class="p">,</span> <span class="s2">&quot;with&quot;</span><span class="p">,</span> <span class="s2">&quot;home&quot;</span><span class="p">]]</span>   <span class="c1"># filter guessed PDBids</span>

    <span class="c1"># search algorithm</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">split</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span> <span class="ow">and</span> <span class="n">item</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">and</span> <span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">PDBid</span><span class="p">:</span>
            <span class="n">PDBid</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">PDBid</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">PDBid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">PDBid</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;get_PDBid(ref): Warning</span><span class="se">\</span>
<span class="s2">             </span><span class="se">\n</span><span class="s2">Found multiple possible PDB ids by splitting the ref path.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">PDBid</span><span class="p">)</span>
        <span class="n">PDBid</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;Enter correct PDB id:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">PDBid</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;get_PDBid(ref): Warning</span><span class="se">\</span>
<span class="s2">             </span><span class="se">\n</span><span class="s2">No PDB id was found by splitting the ref path.&quot;</span><span class="p">)</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="print_table"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.print_table">[docs]</a><span class="k">def</span> <span class="nf">print_table</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[],</span> <span class="n">prec</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose_stop</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">warn</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Prints each item of &quot;data&quot; elementwise next to each other as a table.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (list of lists): table content, where each list corresponds to one column</span>
<span class="sd">        prec (None, int):</span>
<span class="sd">          | None: rounding off</span>
<span class="sd">          | int:  rounding on</span>
<span class="sd">        spacing (int):</span>
<span class="sd">          | spacing between columns (via &quot;&quot;.expandtabs(spacing))</span>
<span class="sd">          | 8: default \\t width</span>
<span class="sd">        dtype (None, dtype): dtype of table values after rounding</span>
<span class="sd">        verbose (bool): print table</span>
<span class="sd">        verbose_stop (None, int): stop printing after N lines.</span>
<span class="sd">        warn (bool): print/supress message  &quot;misc.print_table(): printed only N entries (set by verbose_stop parameter).&quot;</span>

<span class="sd">    Returns:</span>
<span class="sd">        table_str (str)</span>
<span class="sd">            table formatted string. Can be used to save log files.</span>

<span class="sd">    Example:</span>
<span class="sd">        | letters = [&quot;A&quot;, &quot;B&quot;, &quot;C&quot;]</span>
<span class="sd">        | numbers = [1, 2, 3]</span>
<span class="sd">        | table = misc.print_table([letters, numbers])</span>
<span class="sd">        | &gt;&gt;  A   1</span>
<span class="sd">        |     B   2</span>
<span class="sd">        |     C   3</span>
<span class="sd">        |</span>
<span class="sd">        | # save table as log file:</span>
<span class="sd">        | with open(&quot;table.log&quot;, &quot;w&quot;) as fout:</span>
<span class="sd">        |     fout.write(table)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># apply precision to input</span>
    <span class="k">if</span> <span class="n">prec</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">round_object</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="n">prec</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

    <span class="n">table_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">table_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ndx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">table_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">ndx</span><span class="p">])</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ndx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">table_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                               <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">ndx</span><span class="p">])</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ndx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">table_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                   <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">ndx</span><span class="p">])</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ndx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">table_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                       <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                       <span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="n">ndx</span><span class="p">])</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ndx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">table_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                           <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                           <span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="n">ndx</span><span class="p">])</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ndx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">table_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                               <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                               <span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                               <span class="n">data</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="n">ndx</span><span class="p">])</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ndx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">table_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                                   <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                                   <span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                                   <span class="n">data</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="n">ndx</span><span class="p">])</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ndx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">table_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                                       <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                                       <span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                                       <span class="n">data</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                                       <span class="n">data</span><span class="p">[</span><span class="mi">8</span><span class="p">][</span><span class="n">ndx</span><span class="p">])</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ndx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">table_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                                       <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                                       <span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                                       <span class="n">data</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                                       <span class="n">data</span><span class="p">[</span><span class="mi">8</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">9</span><span class="p">][</span><span class="n">ndx</span><span class="p">])</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Extend code of </span><span class="si">{</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">print_table</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">() to work with more than 10 elements.&quot;</span><span class="p">)</span>

    <span class="n">table_str</span> <span class="o">=</span> <span class="n">table_str</span><span class="o">.</span><span class="n">expandtabs</span><span class="p">(</span><span class="n">spacing</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">table_str</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()[:</span><span class="n">verbose_stop</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose_stop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">table_str</span><span class="o">.</span><span class="n">splitlines</span><span class="p">())</span> <span class="o">&gt;=</span> <span class="n">verbose_stop</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">warn</span><span class="p">:</span>
                    <span class="n">cprint</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;misc.print_table(): printed only </span><span class="si">{</span><span class="n">verbose_stop</span><span class="si">}</span><span class="s2"> entries (set by verbose_stop parameter).&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">table_str</span></div>


<div class="viewcode-block" id="save_table"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.save_table">[docs]</a><span class="k">def</span> <span class="nf">save_table</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[],</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">default_dir</span><span class="o">=</span><span class="s2">&quot;./logs&quot;</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose_stop</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Executes misc.print_table() and saves the returned table string as a log file.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (list of lists): table content, where each list corresponds to one column</span>
<span class="sd">        filename (str): filename or realpath</span>
<span class="sd">        header (str): header for log file, e.g. column descriptions</span>
<span class="sd">        default_dir (str)</span>
<span class="sd">        prec (None, int):</span>
<span class="sd">          | None: rounding off</span>
<span class="sd">          | int:  rounding on</span>
<span class="sd">        verbose (bool)</span>
<span class="sd">        verbose_stop (None, int)</span>

<span class="sd">    Keyword Args:</span>
<span class="sd">        save_as (str): alias of filename</span>

<span class="sd">    Return:</span>
<span class="sd">        realpath (str)</span>
<span class="sd">            path to log file</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;save_as&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;save_as&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">filename</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;misc.save_table(): missing 1 required argument: &#39;filename&#39; or &#39;save_as&#39;&quot;</span><span class="p">)</span>

    <span class="n">ext</span> <span class="o">=</span> <span class="n">get_extension</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ext</span> <span class="o">!=</span> <span class="s2">&quot;.log&quot;</span><span class="p">:</span>
        <span class="n">filename</span> <span class="o">+=</span> <span class="s2">&quot;.log&quot;</span>
    <span class="n">realpath</span> <span class="o">=</span> <span class="n">joinpath</span><span class="p">(</span><span class="n">default_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">create_dir</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">realpath</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fout</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">header</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">fout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">header</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">ref_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">!=</span> <span class="n">ref_shape</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s1">&#39;save_table(): data consists of lists with unequal lengths.&#39;</span><span class="p">)</span>

        <span class="n">table_str</span> <span class="o">=</span> <span class="n">print_table</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">prec</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose_stop</span><span class="o">=</span><span class="n">verbose_stop</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">fout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">table_str</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="n">cprint</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saved logfile as: </span><span class="si">{</span><span class="n">realpath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">realpath</span></div>


<div class="viewcode-block" id="get_slice_indices"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.get_slice_indices">[docs]</a><span class="k">def</span> <span class="nf">get_slice_indices</span><span class="p">(</span><span class="n">list1</span><span class="p">,</span> <span class="n">list2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get slice indices of two lists (mainlist and sublist) where sublist is a</span>
<span class="sd">    slice of mainlist, e.g:</span>
<span class="sd">    sublist = mainlist[slice_ndx1:slice_ndx2]</span>

<span class="sd">    Args:</span>
<span class="sd">        list1 (list, array): mainlist or sublist</span>
<span class="sd">        list2 (list, array): mainlist or sublist</span>

<span class="sd">    Returns:</span>
<span class="sd">        slice_ndx1 (int)</span>
<span class="sd">            first slice index (&quot;start&quot;)</span>
<span class="sd">        slice_ndx2 (int)</span>
<span class="sd">            second slice index (&quot;end&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">list1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">list2</span><span class="p">):</span>
        <span class="n">mainlist</span> <span class="o">=</span> <span class="n">list1</span>
        <span class="n">sublist</span> <span class="o">=</span> <span class="n">list2</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">mainlist</span> <span class="o">=</span> <span class="n">list2</span>
        <span class="n">sublist</span> <span class="o">=</span> <span class="n">list1</span>

    <span class="c1"># find potential starting indices</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mainlist</span><span class="p">)</span>
    <span class="n">test_ndx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">test</span> <span class="o">==</span> <span class="n">sublist</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">ndx</span> <span class="ow">in</span> <span class="n">test_ndx</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">sublist</span> <span class="o">==</span> <span class="n">mainlist</span><span class="p">[</span><span class="n">ndx</span><span class="p">:</span><span class="n">ndx</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">sublist</span><span class="p">)]:</span>
            <span class="n">slice_ndx1</span> <span class="o">=</span> <span class="n">ndx</span>
            <span class="n">slice_ndx2</span> <span class="o">=</span> <span class="n">ndx</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">sublist</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">slice_ndx1</span><span class="p">,</span> <span class="n">slice_ndx2</span><span class="p">)</span>
    <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span><span class="s2">&quot;There is no sublist between list1 and list2. Slicing is not possible.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="get_cutoff_array"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.get_cutoff_array">[docs]</a><span class="k">def</span> <span class="nf">get_cutoff_array</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">cut_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cut_max</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies cutoff on array and returns array with values within cutoff range</span>
<span class="sd">    as well as the corresponding indices.</span>

<span class="sd">    Args:</span>
<span class="sd">        array (array/list)</span>
<span class="sd">        cut_min (None, int, float): min value for cutoff</span>
<span class="sd">        cut_max (None, int, float): max value for cutoff</span>

<span class="sd">    Returns:</span>
<span class="sd">        cutoff_array (array, list)</span>
<span class="sd">            array with values within cutoff</span>
<span class="sd">        cutoff_array_ndx (array, list)</span>
<span class="sd">            coresponding indices to map correctly</span>

<span class="sd">    Example:</span>
<span class="sd">        | array = list(range(10,20))</span>
<span class="sd">        | cut_min, cut_max = 12, 16</span>
<span class="sd">        | cutoff_array, cutoff_array_ndx = misc.get_cutoff_array(array, cut_min, cut_max)</span>
<span class="sd">        | print(cutoff_array)</span>
<span class="sd">        | &gt;&gt; [12, 13, 14, 15, 16]</span>
<span class="sd">        | print(cutoff_array_ndx)</span>
<span class="sd">        | &gt;&gt; [2, 3, 4, 5, 6]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># no cutoff</span>
    <span class="k">if</span> <span class="n">cut_min</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">cut_max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cutoff_array</span> <span class="o">=</span> <span class="n">array</span>
        <span class="n">cutoff_array_ndx</span> <span class="o">=</span> <span class="p">[</span><span class="n">ndx</span> <span class="k">for</span> <span class="n">ndx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">array</span><span class="p">)]</span>

    <span class="c1"># with cutoff</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">cut_min</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cut_min</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cut_max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cut_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
        <span class="n">cutoff_array</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">array</span> <span class="k">if</span> <span class="n">item</span> <span class="o">&gt;=</span> <span class="n">cut_min</span> <span class="k">if</span> <span class="n">item</span> <span class="o">&lt;=</span> <span class="n">cut_max</span><span class="p">]</span>
        <span class="n">cutoff_array_ndx</span> <span class="o">=</span> <span class="p">[</span><span class="n">ndx</span> <span class="k">for</span> <span class="n">ndx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="k">if</span> <span class="n">item</span> <span class="o">&gt;=</span> <span class="n">cut_min</span> <span class="k">if</span> <span class="n">item</span> <span class="o">&lt;=</span> <span class="n">cut_max</span><span class="p">]</span>

    <span class="c1"># convert output to array if input was array</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">cutoff_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cutoff_array</span><span class="p">)</span>
        <span class="n">cutoff_array_ndx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cutoff_array_ndx</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">cutoff_array</span><span class="p">,</span> <span class="n">cutoff_array_ndx</span><span class="p">)</span></div>


<div class="viewcode-block" id="get_subarray_start_ndx"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.get_subarray_start_ndx">[docs]</a><span class="k">def</span> <span class="nf">get_subarray_start_ndx</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">subarray</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns start index of &lt;array&gt; at which &lt;subarray&gt; matches.</span>

<span class="sd">    Args:</span>
<span class="sd">        array (list, array)</span>
<span class="sd">        subarray (list, arr)</span>

<span class="sd">    Returns:</span>
<span class="sd">        start_ndx (None, int)</span>
<span class="sd">          | None: arrays do not match</span>
<span class="sd">          | int: starting index of &lt;array&gt; at which &lt;subarray&gt; matches</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">subarray</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;get_subarray_start(array, subarray): lenght(array) &lt; length(subarray).&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">array</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">subarray</span> <span class="o">=</span> <span class="n">subarray</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="n">ndx_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">))</span> <span class="k">if</span> <span class="n">array</span><span class="p">[</span><span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">subarray</span><span class="p">)]</span> <span class="o">==</span> <span class="n">subarray</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ndx_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">start_ndx</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">start_ndx</span> <span class="o">=</span> <span class="n">ndx_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">start_ndx</span></div>


<div class="viewcode-block" id="get_subarray"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.get_subarray">[docs]</a><span class="k">def</span> <span class="nf">get_subarray</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">ndx_sel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns subarray of &lt;array&gt; for items with indices &lt;ndx_sel&gt;.</span>

<span class="sd">    Args:</span>
<span class="sd">        array (array, list): array-like object</span>
<span class="sd">        ndx_sel (array, list): index selection</span>

<span class="sd">    Returns:</span>
<span class="sd">        subarray (array)</span>
<span class="sd">            subarray of array</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">subarray</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ndx</span> <span class="ow">in</span> <span class="n">ndx_sel</span><span class="p">:</span>
        <span class="n">subarray</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">ndx</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">subarray</span><span class="p">)</span></div>


<div class="viewcode-block" id="get_sorted_array"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.get_sorted_array">[docs]</a><span class="k">def</span> <span class="nf">get_sorted_array</span><span class="p">(</span><span class="n">array</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns sorted array (increasing order) and the coresponding element indices</span>
<span class="sd">    of the input array.</span>

<span class="sd">    Args:</span>
<span class="sd">        array (array, list): array-like object</span>

<span class="sd">    Returns:</span>
<span class="sd">        SORTED_VALUES (array)</span>
<span class="sd">            sorted array</span>
<span class="sd">        SORTED_NDX (array)</span>
<span class="sd">            corresponding indices</span>

<span class="sd">    Example:</span>
<span class="sd">        | &gt;&gt; A = np.array([1, 3, 2, 4])</span>
<span class="sd">        | &gt;&gt; get_sorted_array(A)</span>
<span class="sd">        | (array([1, 2, 3, 4]), array([0, 2, 1, 3]))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>

    <span class="n">SORTED_ARRAY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
    <span class="n">SORTED_NDX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">SORTED_ARRAY</span><span class="p">,</span> <span class="n">SORTED_NDX</span><span class="p">)</span></div>


<div class="viewcode-block" id="get_ranked_array"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.get_ranked_array">[docs]</a><span class="k">def</span> <span class="nf">get_ranked_array</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns ranked array (decreasing order) and the corresponding element indices of the input array.</span>

<span class="sd">    Args:</span>
<span class="sd">        array (array, list): array-like object</span>
<span class="sd">        reverse (bool):</span>
<span class="sd">          | True:  ascending ranking order (low to high)</span>
<span class="sd">          | False: decending ranking order (high to low)</span>
<span class="sd">        verbose (bool): print table with RANKED_VALUES, RANKED_NDX</span>

<span class="sd">    Keyword Args:</span>
<span class="sd">        prec(None, int):</span>
<span class="sd">          | None: rounding off</span>
<span class="sd">          | int:  rounding on</span>
<span class="sd">        spacing (int):</span>
<span class="sd">          | spacing between columns (via &quot;&quot;.expandtabs(spacing))</span>
<span class="sd">          | 8: default \\t width</span>
<span class="sd">        verbose_stop (None, int): stop printing after N lines</span>

<span class="sd">    Returns:</span>
<span class="sd">        RANKED_VALUES (array)</span>
<span class="sd">            ranked values</span>
<span class="sd">        RANKED_NDX (array)</span>
<span class="sd">            corresponding indices</span>

<span class="sd">    Example:</span>
<span class="sd">        | &gt;&gt; A = np.array([1, 3, 2, 4])</span>
<span class="sd">        | &gt;&gt; get_ranked_array(A, verbose=False)</span>
<span class="sd">        | (array([4, 3, 2, 1]), array([3, 1, 2, 0]))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">reverse</span><span class="p">:</span>
        <span class="n">RANKED_ARRAY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
        <span class="n">RANKED_NDX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">RANKED_ARRAY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">array</span><span class="p">))</span>
        <span class="n">RANKED_NDX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">array</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="n">print_table</span><span class="p">([</span><span class="n">RANKED_ARRAY</span><span class="p">,</span> <span class="n">RANKED_NDX</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">RANKED_ARRAY</span><span class="p">,</span> <span class="n">RANKED_NDX</span><span class="p">)</span></div>


<div class="viewcode-block" id="get_quantile"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.get_quantile">[docs]</a><span class="k">def</span> <span class="nf">get_quantile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Alias function of np.quantile(). Get value (or score) below which p% of the</span>
<span class="sd">    observations may be found.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (array-like)</span>
<span class="sd">        p (int, float): percent value ~ range 0-1</span>
<span class="sd">        prec (None, int): rounding precision</span>

<span class="sd">    Returns:</span>
<span class="sd">        quantile (int, float)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">quantile</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">prec</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">quantile</span></div>


<div class="viewcode-block" id="get_percentile"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.get_percentile">[docs]</a><span class="k">def</span> <span class="nf">get_percentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Alias function of np.percentile(). Get value (or score) below which p% of</span>
<span class="sd">    the observations may be found.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (array-like)</span>
<span class="sd">        p (int, float): percent value ~ range 0-100</span>
<span class="sd">        prec (None, int): rounding precision</span>

<span class="sd">    Returns:</span>
<span class="sd">        percentile (int, float)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">percentile</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">prec</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">percentile</span></div>
<span class="c1">################################################################################</span>
<span class="c1">################################################################################</span>
<span class="c1">### custom plt.figure()</span>


<div class="viewcode-block" id="figure"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.figure">[docs]</a><span class="k">def</span> <span class="nf">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">6.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">hr</span><span class="o">=</span><span class="p">[],</span> <span class="n">wr</span><span class="o">=</span><span class="p">[],</span>
           <span class="n">palette</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
           <span class="n">context</span><span class="o">=</span><span class="s1">&#39;notebook&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">,</span> <span class="n">font_scale</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
           <span class="n">despine</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Top level container for all the plot elements. Modified version of plt.figure()</span>
<span class="sd">    with gridspec and seaborn elements. &quot;Example&quot; below shows how to plot data</span>
<span class="sd">    by using misc.figure() and plt.sca() # set current axis</span>

<span class="sd">    Args:</span>
<span class="sd">        num (int): figure.number (to reuse the figure canvas)</span>
<span class="sd">        figsize (tuple)</span>
<span class="sd">        dpi (None, int):</span>
<span class="sd">          | dpi settings of figure</span>
<span class="sd">          | if monitor dpi is 100 and figure dpi is 300, then figure will be displayed</span>
<span class="sd">          | on the monitor 3x larger (compared to printed version with e.g. 300 dpi printer).</span>
<span class="sd">        grid (list): nrows, ncols ~ height x width</span>
<span class="sd">        hr (list): height ratio of rows</span>
<span class="sd">        wr (list) width ratio of columns</span>
<span class="sd">        font_scale (float)</span>
<span class="sd">        palette (None, str, list, tuple):</span>
<span class="sd">          | None: use current palette</span>
<span class="sd">          | str: name of the palette, see seaborn documentation</span>
<span class="sd">          | list: list of colors</span>
<span class="sd">          | tuple: tuple of colors</span>
<span class="sd">        n_colors (None, int):</span>
<span class="sd">          | None: use default number of color cycles based on palette</span>
<span class="sd">          | int: remap number of color cycles for the palette</span>
<span class="sd">        context (None, dict, str):</span>
<span class="sd">          | Affects sizes and widths of the plot, e.g. labelsize,</span>
<span class="sd">          | linesize, etc. See return values of sns.plotting_context() to get</span>
<span class="sd">          | all valid dict settings.</span>
<span class="sd">          | str:&#39;notebook&#39;: scaled by 1.0</span>
<span class="sd">          |     &#39;paper&#39;: scaled by 0.8</span>
<span class="sd">          |     &#39;talk&#39;: scaled by 1.3</span>
<span class="sd">          |     &#39;poster&#39;: scaled by 1.6</span>
<span class="sd">        style (None, dict, str):</span>
<span class="sd">          | Affects aesthetic style of the plots, e.g. axes color,</span>
<span class="sd">          | grid display, etc. See return values of sns.axes_style() to get all</span>
<span class="sd">          | valid dict settings.</span>
<span class="sd">          | str:&#39;ticks&#39;, &#39;dark&#39;, &#39;white&#39;, &#39;darkgrid&#39;, &#39;whitegrid&#39;</span>
<span class="sd">        despine (bool):</span>
<span class="sd">          | Remove the top and right spines from all axes. See sns.despine()</span>
<span class="sd">          | documentation for individual axis spine removal.</span>
<span class="sd">        offset (dict/int):</span>
<span class="sd">          | Absolute distance of spines. Use a dict to offset individual spines,</span>
<span class="sd">          | e.g. offset={&quot;bottom&quot;:0, &quot;left&quot;:20}.</span>

<span class="sd">    Returns:</span>
<span class="sd">        fig (class)</span>
<span class="sd">            matplotlib.figure.Figure</span>
<span class="sd">        ax (class, list)</span>
<span class="sd">            ax or list of axes ~ matplotlib.axes._subplots.Axes</span>

<span class="sd">    Example:</span>
<span class="sd">        | fig, ax = misc.figure(grid=[2,2], hr=[1,1], wr=[2,1])</span>
<span class="sd">        | plt.sca(ax[0])</span>
<span class="sd">        | plt.plot([0,1,2], [0,4,4])</span>
<span class="sd">        | plt.plot([0,1,2], [0,10,10])</span>
<span class="sd">        | plt.sca(ax[2])</span>
<span class="sd">        | plt.plot([0,-1,-2], [0,-4,-4])</span>
<span class="sd">        | plt.plot([0,-1,-2], [0,-10,-10])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">hr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">wr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">grid</span> <span class="o">!=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">hr</span> <span class="o">==</span> <span class="p">[]:</span>
        <span class="n">hr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">grid</span> <span class="o">!=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">wr</span> <span class="o">==</span> <span class="p">[]:</span>
        <span class="n">wr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">font_scale</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">)</span>  <span class="c1"># context scales font elements by default</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span> <span class="n">font_scale</span><span class="o">=</span><span class="n">font_scale</span><span class="p">)</span>  <span class="c1"># double scaling with font_scale</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">palette</span><span class="p">,</span> <span class="n">n_colors</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">num</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">num</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>

    <span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">width_ratios</span><span class="o">=</span><span class="n">wr</span><span class="p">,</span> <span class="n">height_ratios</span><span class="o">=</span><span class="n">hr</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">gs_item</span> <span class="ow">in</span> <span class="n">gs</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs_item</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">despine</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">(</span><span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="c1">#plt.show()</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></div>


<div class="viewcode-block" id="set_pad"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.set_pad">[docs]</a><span class="k">def</span> <span class="nf">set_pad</span><span class="p">(</span><span class="n">fig_or_ax</span><span class="p">,</span> <span class="n">xpad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ypad</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set pad (spacing) between axis and axis labels</span>

<span class="sd">    Args:</span>
<span class="sd">        fig_or_ax (matplotlib.figure.Figure/matplotlib.axes._subplots.Axes)</span>
<span class="sd">        xpad (None, float):</span>
<span class="sd">          | spacing between xaxis and its labels</span>
<span class="sd">          | None: use current settings</span>
<span class="sd">        ypad (None, float):</span>
<span class="sd">          | spacing between yaxis and its labels</span>
<span class="sd">          | None: use current settings</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">default</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;xpad&quot;</span><span class="p">:</span> <span class="mf">3.5</span><span class="p">,</span>
               <span class="s2">&quot;ypad&quot;</span><span class="p">:</span> <span class="mf">3.5</span><span class="p">}</span>
    <span class="n">cfg</span> <span class="o">=</span> <span class="n">CONFIG</span><span class="p">(</span><span class="n">default</span><span class="p">,</span> <span class="n">xpad</span><span class="o">=</span><span class="n">xpad</span><span class="p">,</span> <span class="n">ypad</span><span class="o">=</span><span class="n">ypad</span><span class="p">)</span>
    <span class="c1">############################################################################</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fig_or_ax</span><span class="p">,</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">Figure</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fig_or_ax</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="p">[</span><span class="n">fig_or_ax</span><span class="o">.</span><span class="n">axes</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">fig_or_ax</span><span class="o">.</span><span class="n">axes</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fig_or_ax</span><span class="p">,</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">Axes</span><span class="p">):</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="p">[</span><span class="n">fig_or_ax</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fig_or_ax</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig_or_ax</span>

    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xpad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">get_major_ticks</span><span class="p">():</span>
                <span class="n">tick</span><span class="o">.</span><span class="n">set_pad</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">xpad</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ypad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">get_major_ticks</span><span class="p">():</span>
                <span class="n">tick</span><span class="o">.</span><span class="n">set_pad</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">ypad</span><span class="p">)</span>
    <span class="k">return</span></div>


<div class="viewcode-block" id="legend"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.legend">[docs]</a><span class="k">def</span> <span class="nf">legend</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">],</span> <span class="n">handlecolors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">],</span> <span class="n">handlelength</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">handletextpad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Alias function of plt.legend() with most frequently used parameters.</span>

<span class="sd">    Args:</span>
<span class="sd">        labels (sequence of strings)</span>
<span class="sd">        handlescolors (list)</span>
<span class="sd">        handlelength (None/int/float)</span>
<span class="sd">        handletextpad (None/int/float)</span>
<span class="sd">        loc (str):</span>
<span class="sd">          | Location String   Location Code</span>
<span class="sd">          | -------------------------------</span>
<span class="sd">          | &#39;best&#39;            0</span>
<span class="sd">          | &#39;upper right&#39;     1</span>
<span class="sd">          | &#39;upper left&#39;      2</span>
<span class="sd">          | &#39;lower left&#39;      3</span>
<span class="sd">          | &#39;lower right&#39;     4</span>
<span class="sd">          | &#39;right&#39;           5</span>
<span class="sd">          | &#39;center left&#39;     6</span>
<span class="sd">          | &#39;center right&#39;    7</span>
<span class="sd">          | &#39;lower center&#39;    8</span>
<span class="sd">          | &#39;upper center&#39;    9</span>
<span class="sd">          | &#39;center&#39;          10</span>

<span class="sd">    Keyword Args:</span>
<span class="sd">        title (str)</span>
<span class="sd">        edgecolor (str)</span>
<span class="sd">        fancybox (bool):</span>
<span class="sd">          | True:  legendbox with round edges</span>
<span class="sd">          | False: legendbox with normal edges</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">legend</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
                        <span class="n">handlelength</span><span class="o">=</span><span class="n">handlelength</span><span class="p">,</span>
                        <span class="n">handletextpad</span><span class="o">=</span><span class="n">handletextpad</span><span class="p">,</span>
                        <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">handlecolors</span> <span class="o">!=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">ndx</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">handlecolors</span><span class="p">):</span>
            <span class="n">legend</span><span class="o">.</span><span class="n">legendHandles</span><span class="p">[</span><span class="n">ndx</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
    <span class="k">return</span></div>


<div class="viewcode-block" id="savefig"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.savefig">[docs]</a><span class="k">def</span> <span class="nf">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">filedir</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">create_dir</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    general helpfunction</span>

<span class="sd">      - save current figure</span>
<span class="sd">      - print message &quot;Saved figure as: ...&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (None, str):</span>
<span class="sd">          | None: do not save figure</span>
<span class="sd">          | str: file name or realpath to file</span>
<span class="sd">        filedir (str): file directory</span>
<span class="sd">        create_dir (bool): create directory if it does not exist yet</span>
<span class="sd">        dpi (int): dpi settings</span>

<span class="sd">    Returns:</span>
<span class="sd">        realpath (str)</span>
<span class="sd">            realpath to saved figure</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">filename</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="n">filedir</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="n">realpath</span> <span class="o">=</span> <span class="n">joinpath</span><span class="p">(</span><span class="n">filedir</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">create_dir</span><span class="o">=</span><span class="n">create_dir</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">realpath</span> <span class="o">=</span> <span class="n">joinpath</span><span class="p">(</span><span class="s2">&quot;./&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">create_dir</span><span class="o">=</span><span class="n">create_dir</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">realpath</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Saved figure as:&quot;</span><span class="p">,</span> <span class="n">realpath</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">realpath</span></div>


<span class="c1">### alias function</span>
<span class="n">save_fig</span> <span class="o">=</span> <span class="n">savefig</span>


<div class="viewcode-block" id="autoapply_limits"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.autoapply_limits">[docs]</a><span class="k">def</span> <span class="nf">autoapply_limits</span><span class="p">(</span><span class="n">fig_or_ax</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply plt.xlim() and plt.ylim() on each axis object based on its xmin, xmax,</span>
<span class="sd">    ymin, ymax values.</span>

<span class="sd">    .. NOTE::</span>

<span class="sd">      - use only after plotting data</span>
<span class="sd">      - currently works only with Line2D data</span>

<span class="sd">    Args:</span>
<span class="sd">        fig_or_ax (matplotlib.figure.Figure/matplotlib.axes._subplots.Axes)</span>
<span class="sd">        margin (float): extra margin on upper limits, where margin=0.01 equals 1% of xmax and ymax</span>

<span class="sd">    Returns:</span>
<span class="sd">        xlim (list)</span>
<span class="sd">            if fig_or_ax is axis</span>
<span class="sd">        ylim (list)</span>
<span class="sd">            if fig_or_ax is axis</span>
<span class="sd">        XLIM (list of lists)</span>
<span class="sd">            if fig_or_ax is figure</span>
<span class="sd">        YLIM (list of lists)</span>
<span class="sd">            if fig_or_ax is figure</span>

<span class="sd">    Example:</span>
<span class="sd">        | &gt;&gt; fig, ax = misc.figure(grid=[2,2], hr=[1,1], wr=[2,1])</span>
<span class="sd">        | &gt;&gt; plt.sca(ax[0])</span>
<span class="sd">        | &gt;&gt; plt.plot([0,1,2], [0,4,4])</span>
<span class="sd">        | &gt;&gt; plt.plot([0,1,2], [0,10,10])</span>
<span class="sd">        | &gt;&gt; autoapply_limits(fig, margin=0.05)</span>
<span class="sd">        | ([[0, 2.1], [0, 0], [0, 0], [0, 0]],</span>
<span class="sd">        | [[0,10.5], [0, 0], [0, 0], [0, 0]])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Test if object is figure or axis</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fig_or_ax</span><span class="p">,</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">Figure</span><span class="p">):</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="n">fig_or_ax</span><span class="o">.</span><span class="n">get_axes</span><span class="p">()</span>
    <span class="k">if</span> <span class="s2">&quot;axes&quot;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">():</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">fig_or_ax</span><span class="p">]</span>

    <span class="c1"># get and apply limits</span>
    <span class="n">XLIM</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">YLIM</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
        <span class="n">xlim</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">Axes</span><span class="p">):</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_lines</span><span class="p">()</span>

            <span class="c1"># if Line2D data does not exist</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">XLIM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
                <span class="n">YLIM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>

            <span class="c1"># if Line2D data does exist</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
                    <span class="n">xdata</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">get_xdata</span><span class="p">()</span>
                    <span class="n">ydata</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">get_ydata</span><span class="p">()</span>
                    <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="n">xdata</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">xdata</span><span class="p">)</span>
                    <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="n">ydata</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">ydata</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">xmin</span> <span class="o">&lt;</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                        <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">xmin</span>
                    <span class="k">if</span> <span class="n">xmax</span> <span class="o">&gt;</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">xmax</span>
                    <span class="k">if</span> <span class="n">ymin</span> <span class="o">&lt;</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                        <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">ymin</span>
                    <span class="k">if</span> <span class="n">ymax</span> <span class="o">&gt;</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">ymax</span>

                <span class="c1"># save limits for each axis object</span>
                <span class="k">if</span> <span class="n">margin</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">margin</span><span class="o">*</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">margin</span><span class="o">*</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
                <span class="n">XLIM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
                <span class="n">YLIM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">XLIM</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">XLIM</span><span class="p">,</span> <span class="n">YLIM</span><span class="p">)</span></div>

<span class="c1">################################################################################</span>
<span class="c1">################################################################################</span>
<span class="c1"># pickle functions</span>


<div class="viewcode-block" id="pickle_dump"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.pickle_dump">[docs]</a><span class="k">def</span> <span class="nf">pickle_dump</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">pickledir</span><span class="o">=</span><span class="s1">&#39;./pickle&#39;</span><span class="p">,</span>
                <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    bug: can&#39;t dump figures which used the misc.add_cbar() or misc.add_cbar_ax() function</span>
<span class="sd">         because of the use of ax.inset_axes().</span>

<span class="sd">    Create pickle directory and pickle.dump object as &quot;&lt;pickledir&gt;/&lt;filename&gt;.pickle&quot;</span>

<span class="sd">    Special cases:</span>

<span class="sd">      - filename contains relative path: ignores pickledir input</span>
<span class="sd">      - filename contains absolute path: ignores pickledir input</span>

<span class="sd">    Reason:</span>

<span class="sd">        intention is to dump file under the path &quot;filename&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        obj (matplotlib.figure.Figure/&lt;any object&gt;)</span>
<span class="sd">        filename (str):</span>
<span class="sd">          | filename, hardcoded to add &quot;.pickle&quot; extension.</span>
<span class="sd">          | Can be relative or absolute path including the filename.</span>
<span class="sd">        pickledir (str): default pickle directory</span>
<span class="sd">        overwrite (bool): overwrite pickle dumped file if it already exists</span>
<span class="sd">        verbose (bool)</span>

<span class="sd">    Keyword Args:</span>
<span class="sd">        save_as (str): alias of filename</span>

<span class="sd">    Returns:</span>
<span class="sd">        filepath (str)</span>
<span class="sd">            realpath of dumped .pickle file</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;save_as&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;save_as&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">filename</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;misc.pickle_dump(): missing 1 required argument: &#39;filename&#39; or &#39;save_as&#39;&quot;</span><span class="p">)</span>
    <span class="c1"># convention: save files with &#39;.pickle&#39; ending</span>
    <span class="k">if</span> <span class="n">filename</span><span class="p">[</span><span class="o">-</span><span class="mi">7</span><span class="p">:]</span> <span class="o">!=</span> <span class="s2">&quot;.pickle&quot;</span><span class="p">:</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span><span class="o">+</span><span class="s2">&quot;.pickle&quot;</span>

    <span class="n">filepath</span> <span class="o">=</span> <span class="n">joinpath</span><span class="p">(</span><span class="n">filedir</span><span class="o">=</span><span class="n">pickledir</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">create_dir</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">overwrite</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">pl</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">Figure</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;pickle.dumped figure as:&quot;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">filepath</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;pickle.dumped object as:&quot;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">filepath</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">filepath</span></div>


<span class="k">def</span> <span class="nf">_pickle_get_ax_type</span><span class="p">(</span><span class="n">fig_or_ax</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get axis type by counting &lt;matplotlib.lines.Line2D&gt; and &lt;matplotlib.patches.Rectangle&gt; objects.</span>
<span class="sd">    Additionally checks the ratio of Rectangle height:width to detect if barplot was created using</span>
<span class="sd">    plt.bar() or plt.barh().</span>

<span class="sd">    Args:</span>
<span class="sd">        fig_or_ax (matplotlib.figure.Figure/matplotlib.axes._subplots.Axes)</span>

<span class="sd">    Returns:</span>
<span class="sd">        ax_type (str)</span>
<span class="sd">            | &quot;line plot&quot; ~ ax was created using plt.plot()</span>
<span class="sd">            | &quot;bar plot&quot;  ~ ax was created using plt.bar()</span>
<span class="sd">            | &quot;barh plot&quot; ~ ax was created using plt.barh()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">artists</span> <span class="o">=</span> <span class="n">fig_or_ax</span><span class="o">.</span><span class="n">get_default_bbox_extra_artists</span><span class="p">()</span>

    <span class="n">n_lines</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">n_rectangles</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">maxh</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">maxw</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">artists</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">Line2D</span><span class="p">):</span>
            <span class="n">n_lines</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">):</span>
            <span class="n">n_rectangles</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">h</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span>
            <span class="n">w</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">h</span> <span class="o">&gt;</span> <span class="n">maxh</span><span class="p">:</span>
                <span class="n">maxh</span> <span class="o">=</span> <span class="n">h</span>
            <span class="k">if</span> <span class="n">w</span> <span class="o">&gt;</span> <span class="n">maxw</span><span class="p">:</span>
                <span class="n">maxw</span> <span class="o">=</span> <span class="n">w</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">n_rectangles</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">n_rectangles</span> <span class="o">&gt;</span> <span class="n">n_lines</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">maxh</span> <span class="o">&gt;</span> <span class="n">maxw</span><span class="p">:</span>
            <span class="n">ax_type</span> <span class="o">=</span> <span class="s2">&quot;bar plot&quot;</span>
        <span class="k">if</span> <span class="n">maxw</span> <span class="o">&gt;</span> <span class="n">maxh</span><span class="p">:</span>
            <span class="n">ax_type</span> <span class="o">=</span> <span class="s2">&quot;barh plot&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax_type</span> <span class="o">=</span> <span class="s2">&quot;line plot&quot;</span>
    <span class="k">return</span> <span class="n">ax_type</span>


<span class="k">def</span> <span class="nf">_pickle_get_ax_data</span><span class="p">(</span><span class="n">fig_or_ax</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get specific axis data:</span>

<span class="sd">      - limits</span>
<span class="sd">      - scaling</span>
<span class="sd">      - ticks</span>
<span class="sd">      - ticklabels</span>

<span class="sd">    Args:</span>
<span class="sd">        fig_or_ax (matplotlib.figure.Figure/matplotlib.axes._subplots.Axes)</span>

<span class="sd">    Returns:&quot;&quot;&quot;</span>
    <span class="c1"># NOTE 1: End this docstring with |Returns:&quot;&quot;&quot;| to remove trailing newline</span>
    <span class="c1"># NOTE 2: Missing doc string part is coded right after this function.</span>
    <span class="c1">#         It will be appended once here and to other docstrings during</span>
    <span class="c1">#         the first initialization of the module.</span>
    <span class="c1">#         -&gt; see INIT_append_docstrings()</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fig_or_ax</span><span class="p">,</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">Figure</span><span class="p">):</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">fig_or_ax</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fig_or_ax</span><span class="p">,</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">Axes</span><span class="p">):</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">fig_or_ax</span><span class="o">.</span><span class="n">figure</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig_or_ax</span>

    <span class="c1">### ticklabels are &quot;complicated&quot;</span>
    <span class="n">xticklabels</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">temp</span><span class="p">:</span>
        <span class="n">xticklabels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">get_text</span><span class="p">())</span>

    <span class="n">yticklabels</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">temp</span><span class="p">:</span>
        <span class="n">yticklabels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">get_text</span><span class="p">())</span>

    <span class="n">ax_data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ax_type&quot;</span><span class="p">:</span> <span class="n">_pickle_get_ax_type</span><span class="p">(</span><span class="n">fig_or_ax</span><span class="p">),</span>
               <span class="s2">&quot;xlim&quot;</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">(),</span>
               <span class="s2">&quot;ylim&quot;</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">(),</span>
               <span class="s2">&quot;xscale&quot;</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xscale</span><span class="p">(),</span>
               <span class="s2">&quot;yscale&quot;</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_yscale</span><span class="p">(),</span>
               <span class="s2">&quot;xticks&quot;</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">(),</span>
               <span class="s2">&quot;yticks&quot;</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">(),</span>
               <span class="s2">&quot;xticklabels&quot;</span><span class="p">:</span> <span class="n">xticklabels</span><span class="p">,</span>
               <span class="s2">&quot;yticklabels&quot;</span><span class="p">:</span> <span class="n">yticklabels</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">ax_data</span>


<span class="n">__pickle_get_ax_data___append_doc__</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        ax_data (dict)</span>
<span class="s2">            dictionary containing specific axis data, see table below</span>

<span class="s2">            +-------------+--------------+-------------------------------------+</span>
<span class="s2">            | key         | value        | description                         |</span>
<span class="s2">            +-------------+--------------+-------------------------------------+</span>
<span class="s2">            |ax_type (str)| &quot;line plot&quot;  | ax was created using plt.plot()     |</span>
<span class="s2">            +             +--------------+-------------------------------------+</span>
<span class="s2">            |             | &quot;bar plot&quot;   | ax was created using plt.bar()      |</span>
<span class="s2">            +             +--------------+-------------------------------------+</span>
<span class="s2">            |             | &quot;barh plot&quot;  | ax was created using plt.barh()     |</span>
<span class="s2">            +-------------+--------------+-------------------------------------+</span>
<span class="s2">            |xlim/ylim    | tuple        | content of ax.get_xlim()            |</span>
<span class="s2">            +-------------+--------------+-------------------------------------+</span>
<span class="s2">            |xscale/yscale| str          | content of ax.get_xscale()          |</span>
<span class="s2">            +-------------+--------------+-------------------------------------+</span>
<span class="s2">            |xticks/yticks| array        | content of ax.get_xticks()          |</span>
<span class="s2">            +-------------+--------------+-------------------------------------+</span>
<span class="s2">            |x/yticklabels| list         | text content of ax.get_xticklabels()|</span>
<span class="s2">            +-------------+--------------+-------------------------------------+</span>
<span class="s2">&quot;&quot;&quot;</span>


<span class="k">def</span> <span class="nf">_pickle_get_line_data</span><span class="p">(</span><span class="n">fig_or_ax</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get &lt;matplotlib.lines.Line2D&gt; objects data of figure/axis.</span>

<span class="sd">    Args:</span>
<span class="sd">        fig_or_ax (matplotlib.figure.Figure/matplotlib.axes._subplots.Axes)</span>

<span class="sd">    Returns:&quot;&quot;&quot;</span>
    <span class="c1"># NOTE 1: End this docstring with |Returns:&quot;&quot;&quot;| to remove trailing newline</span>
    <span class="c1"># NOTE 2: Missing doc string part is coded right after this function.</span>
    <span class="c1">#         It will be appended once here and to other docstrings during</span>
    <span class="c1">#         the first initialization of the module.</span>
    <span class="c1">#         -&gt; see INIT_append_docstrings()</span>

    <span class="n">artists</span> <span class="o">=</span> <span class="n">fig_or_ax</span><span class="o">.</span><span class="n">get_default_bbox_extra_artists</span><span class="p">()</span>
    <span class="n">line_data</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">artists</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">Line2D</span><span class="p">):</span>
            <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;__description__&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;line data ~ plt.plot()&quot;</span>
            <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_alpha</span><span class="p">()</span>
            <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_color</span><span class="p">()</span>
            <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span>
            <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;ls&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_linestyle</span><span class="p">()</span>
            <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;lw&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_linewidth</span><span class="p">()</span>
            <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;marker&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_marker</span><span class="p">()</span>
            <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;mec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_mec</span><span class="p">()</span>
            <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;mfc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_mfc</span><span class="p">()</span>
            <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;ms&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_markersize</span><span class="p">()</span>
            <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;xdata&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_xdata</span><span class="p">()</span>
            <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;ydata&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_ydata</span><span class="p">()</span>
            <span class="n">line_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">line_data</span>


<span class="n">__pickle_get_line_data___append_doc__</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        line_data (list)</span>
<span class="s2">            list of dicts, which contain data about &lt;matplotlib.lines.Line2D&gt;</span>
<span class="s2">            objects with viable Keyword Args as shown in the table below</span>

<span class="s2">            +---------+----------------+-------------------------+--------+</span>
<span class="s2">            | alpha   | ls (linestyle) | mac (marker edgecolor)  | xdata  |</span>
<span class="s2">            +---------+----------------+-------------------------+--------+</span>
<span class="s2">            | color   | lw (linewidth) | mfc (marker facecolor)  | ydata  |</span>
<span class="s2">            +---------+----------------+-------------------------+--------+</span>
<span class="s2">            | label   | marker         | ms (markersize)         |        |</span>
<span class="s2">            +---------+----------------+-------------------------+--------+</span>
<span class="s2">&quot;&quot;&quot;</span>


<span class="k">def</span> <span class="nf">_pickle_get_rectangle_data</span><span class="p">(</span><span class="n">fig_or_ax</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get &lt;matplotlib.patches.Rectangle&gt; objects data of figure/axis.</span>

<span class="sd">    Args:</span>
<span class="sd">        fig_or_ax (matplotlib.figure.Figure/matplotlib.axes._subplots.Axes)</span>

<span class="sd">    Returns:&quot;&quot;&quot;</span>
    <span class="c1"># NOTE 1: End this docstring with |Returns:&quot;&quot;&quot;| to remove trailing newline</span>
    <span class="c1"># NOTE 2: Missing doc string part is coded right after this function.</span>
    <span class="c1">#         It will be appended once here and to other docstrings during</span>
    <span class="c1">#         the first initialization of the module.</span>
    <span class="c1">#         -&gt; see INIT_append_docstrings()</span>

    <span class="n">artists</span> <span class="o">=</span> <span class="n">fig_or_ax</span><span class="o">.</span><span class="n">get_default_bbox_extra_artists</span><span class="p">()</span>
    <span class="n">rect_data</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">artists</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">):</span>
            <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;__description__&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;rectangle data ~ plt.bar() or plt.barh()&quot;</span>
            <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_alpha</span><span class="p">()</span>
            <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;bbox&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_bbox</span><span class="p">()</span>
            <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;bbox_points&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_bbox</span><span class="p">()</span><span class="o">.</span><span class="n">get_points</span><span class="p">()</span>
            <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;ec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_ec</span><span class="p">()</span>
            <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;fc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_fc</span><span class="p">()</span>
            <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;fill&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_fill</span><span class="p">()</span>
            <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span>
            <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span>
            <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;ls&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_ls</span><span class="p">()</span>
            <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;lw&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_lw</span><span class="p">()</span>
            <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span>
            <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;xy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_xy</span><span class="p">()</span>

            <span class="c1"># ignore figure canvas rectangle</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;bbox_points&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])):</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rect_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rect_data</span>


<span class="n">__pickle_get_rectangle_data___append_doc__</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        rect_data (list)</span>
<span class="s2">            list of dicts, which contain data about &lt;matplotlib.patches.Rectangle&gt;</span>
<span class="s2">            objects with viable Keyword Args as shown in the table below</span>

<span class="s2">            +----------------+--------+--------+</span>
<span class="s2">            | alpha          | fill   | width  |</span>
<span class="s2">            +----------------+--------+--------+</span>
<span class="s2">            | bbox           | height |  xy    |</span>
<span class="s2">            +----------------+--------+--------+</span>
<span class="s2">            | bbox_points    | label  |        |</span>
<span class="s2">            +----------------+--------+--------+</span>
<span class="s2">            | ec (edgecolor) | ls (linestyle)  |</span>
<span class="s2">            +----------------+-----------------+</span>
<span class="s2">            | fc (facecolor) | lw (linewidth)  |</span>
<span class="s2">            +----------------+-----------------+</span>

<span class="s2">        .. Hint:: xy are the userland coordinates starting from bottom left</span>
<span class="s2">           rectangle corner (rectangle is defined by xy, width, height)</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">__pickle_get_rectangle_data___bugs_doc__</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Current bugs/problems:</span>
<span class="s2">        EDGECOLOR:</span>
<span class="s2">        case 1) if plt.bar(..., ec=&#39;None&#39;, alpha=0.6) was used, then item.get_ec()</span>
<span class="s2">                returns array for black color but with alpha value of 0</span>
<span class="s2">        case 2) if figure is pickle.dumped and then loaded, the edgecolor values</span>
<span class="s2">                are displayed correct (i.e. black with alpha of 0)</span>
<span class="s2">        case 3) if plt.bar(...,ec=&lt;read value&gt; , alpha=0.6) is used, all edge</span>
<span class="s2">                colors get an alpha value of 0.6</span>

<span class="s2">        Although this is somehow expected, but case 1) and case 3) should still</span>
<span class="s2">        yield the same results.</span>

<span class="s2">        -&gt; workaround is coded in misc.pickle_plot()</span>
<span class="s2">    &quot;&quot;&quot;</span>


<div class="viewcode-block" id="pickle_load"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.pickle_load">[docs]</a><span class="k">def</span> <span class="nf">pickle_load</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">pickledir</span><span class="o">=</span><span class="s2">&quot;./pickle&quot;</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    pickle.load figure from &quot;&lt;pickledir&gt;/&lt;filename&gt;.pickle&quot;. If the pickle file</span>
<span class="sd">    contains figure data, auto detects the figure type (i.e. it created using</span>
<span class="sd">    plt.plot(), plt.bar() or plt.barh()).</span>

<span class="sd">    .. Warning:: %matplotlib notebook backend leaves empty space below figure in</span>
<span class="sd">       jupyter notebook when closing figs which were loaded via pickle files.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename (str): realpath to .pickle file or filename within pickledir</span>
<span class="sd">        pickledir (str): default pickle directory</span>
<span class="sd">        plot (bool)</span>

<span class="sd">    Returns:</span>
<span class="sd">        ax_data (dict)</span>
<span class="sd">            if pickle file is a figure object</span>
<span class="sd">        line_data (list)</span>
<span class="sd">            if pickle file is a figure object</span>
<span class="sd">        rect_data (list)</span>
<span class="sd">            if pickle file is a figure object</span>
<span class="sd">        object (?)</span>
<span class="sd">            else</span>

<span class="sd">    .. Note ::&quot;&quot;&quot;</span>
    <span class="c1"># NOTE 1: End this docstring with |Notes:&quot;&quot;&quot;| to remove trailing newline</span>
    <span class="c1"># NOTE 2: Missing doc string part is coded right after this function.</span>
    <span class="c1">#         It will be appended once here and to other docstrings during</span>
    <span class="c1">#         the first initialization of the module.</span>
    <span class="c1">#         -&gt; see INIT_append_docstrings()</span>

    <span class="c1"># test if filename is &quot;fullpath&quot; or &quot;relative path to pickle_dir&quot;</span>
    <span class="n">filepath</span> <span class="o">=</span> <span class="n">joinpath</span><span class="p">(</span><span class="n">filedir</span><span class="o">=</span><span class="n">pickledir</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">create_dir</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">Figure</span><span class="p">):</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">obj</span>
            <span class="n">ax_data</span> <span class="o">=</span> <span class="n">_pickle_get_ax_data</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
            <span class="n">line_data</span> <span class="o">=</span> <span class="n">_pickle_get_line_data</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
            <span class="n">rect_data</span> <span class="o">=</span> <span class="n">_pickle_get_rectangle_data</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">plot</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">ax_data</span><span class="p">,</span> <span class="n">line_data</span><span class="p">,</span> <span class="n">rect_data</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">obj</span></div>


<span class="n">__pickle_load___append_doc__</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Example:</span>
<span class="s2">        | ax_data, line_data, rect_data = pickle_load( &lt; filename &gt; )</span>
<span class="s2">        |  # acces data</span>
<span class="s2">        | line_data[0][&quot;xdata&quot;]</span>
<span class="s2">        | line_data[0][&quot;color&quot;]</span>
<span class="s2">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="pickle_plot"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.pickle_plot">[docs]</a><span class="k">def</span> <span class="nf">pickle_plot</span><span class="p">(</span><span class="n">pickle_files</span><span class="o">=</span><span class="p">[],</span> <span class="n">import_settings</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xscale</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
                <span class="n">align_ylim</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">hist_minorticks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates multifigure from loading pickle_files</span>

<span class="sd">    .. Warning:: data is first loaded -&gt; creates a figure -&gt; closed. However in</span>
<span class="sd">       jupyter %matplotlib notebook backend leaves empty space below figure when</span>
<span class="sd">       closing figs which were loaded via pickle. The empty space is only visible</span>
<span class="sd">       in the notebook (i.e. saving a pickle_plot figure is working fine.)</span>

<span class="sd">    .. Note: Code for &quot;align&quot; parameter is currently only intended for figures with</span>
<span class="sd">        grid = [&lt;any&gt;, 2], i.e. width of 2 figures.</span>

<span class="sd">    Args:</span>
<span class="sd">        pickle_files (str,list of str): path to pickle file(s) containing the (sub)figure data</span>
<span class="sd">        import_settings (bool): apply settings (for line and rectangle objects) from imported pickle_files</span>
<span class="sd">        xscale (str):</span>
<span class="sd">          | &#39;auto&#39;, &#39;linear&#39;, &#39;log&#39;, &#39;symlog&#39;, &#39;logit&#39;</span>
<span class="sd">          | &#39;auto&#39;: apply xscale of the used pickle_files</span>
<span class="sd">        yscale (str):</span>
<span class="sd">          | &#39;auto&#39;, &#39;linear&#39;, &#39;log&#39;, &#39;symlog&#39;, &#39;logit&#39;</span>
<span class="sd">          | &#39;auto&#39;: apply yscale of the used pickle_files</span>
<span class="sd">        align_ylim (bool): align y axis limits of figures on the same row</span>
<span class="sd">        hist_minorticks (bool): turns minorticks (~logscale) for hist figure on/off</span>

<span class="sd">    .. Hint:: Args and Keyword Args of misc.figure() are valid.</span>

<span class="sd">    Returns:</span>
<span class="sd">        fig (class)</span>
<span class="sd">            matplotlib.figure.Figure</span>
<span class="sd">        ax (class, list)</span>
<span class="sd">            ax or list of axes ~ matplotlib.axes._subplots.Axes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">default</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;grid&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]}</span>
    <span class="n">cfg</span> <span class="o">=</span> <span class="n">CONFIG</span><span class="p">(</span><span class="n">default</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pickle_files</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="s2">&quot;grid&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">round_up</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pickle_files</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">ncols</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="p">[</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pickle_files</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">pickle_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">pickle_files</span><span class="p">]</span>

    <span class="k">elif</span> <span class="n">pickle_files</span> <span class="o">==</span> <span class="p">[]</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pickle_files</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">exec</span><span class="p">(</span><span class="s2">&quot;help(pickle_plot)&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Invalid type of &#39;pickle_files&#39;. Read the docstring above.&quot;</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="o">**</span><span class="n">cfg</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ndx</span><span class="p">,</span> <span class="n">pickle</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pickle_files</span><span class="p">):</span>
        <span class="c1"># skip pickle_files with empty path string</span>
        <span class="k">if</span> <span class="n">pickle</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="k">continue</span>  <span class="c1"># python: continue with NEXT loop iteration</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pickle_files</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="n">ndx</span><span class="p">])</span>
            <span class="k">pass</span>  <span class="c1"># python: continue with CURRENT loop iteration aka &quot;do nothing&quot;</span>

        <span class="n">ax_data</span><span class="p">,</span> <span class="n">line_data</span><span class="p">,</span> <span class="n">rect_data</span> <span class="o">=</span> <span class="n">pickle_load</span><span class="p">(</span><span class="n">pickle</span><span class="p">)</span>

        <span class="c1">### reconstruct figure</span>
        <span class="k">if</span> <span class="n">ax_data</span><span class="p">[</span><span class="s2">&quot;ax_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;line plot&quot;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">line_data</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">import_settings</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;xdata&quot;</span><span class="p">],</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;ydata&quot;</span><span class="p">],</span>
                             <span class="n">alpha</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span>
                             <span class="n">label</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">],</span> <span class="n">ls</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;ls&quot;</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;lw&quot;</span><span class="p">],</span>
                             <span class="n">marker</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;marker&quot;</span><span class="p">],</span> <span class="n">ms</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;ms&quot;</span><span class="p">],</span>
                             <span class="n">mec</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;mec&quot;</span><span class="p">],</span> <span class="n">mfc</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;mfc&quot;</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;xdata&quot;</span><span class="p">],</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;ydata&quot;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">ax_data</span><span class="p">[</span><span class="s2">&quot;ax_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;bar plot&quot;</span> <span class="ow">or</span> <span class="n">ax_data</span><span class="p">[</span><span class="s2">&quot;ax_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;barh plot&quot;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">rect_data</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">import_settings</span><span class="p">:</span>
                    <span class="c1">### workaround start: weird bug with edge colors not properly importing the alpha value</span>
                    <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;ec&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
                        <span class="n">temp_ec</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">temp_ec</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;ec&quot;</span><span class="p">]</span>
                    <span class="c1">### workaround end</span>

                    <span class="k">if</span> <span class="n">ax_data</span><span class="p">[</span><span class="s2">&quot;ax_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;bar plot&quot;</span><span class="p">:</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;xy&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">height</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">],</span>
                                <span class="n">fc</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;fc&quot;</span><span class="p">],</span> <span class="n">ec</span><span class="o">=</span><span class="n">temp_ec</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">],</span>
                                <span class="n">fill</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;fill&quot;</span><span class="p">],</span> <span class="n">ls</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;ls&quot;</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;lw&quot;</span><span class="p">])</span>
                    <span class="k">elif</span> <span class="n">ax_data</span><span class="p">[</span><span class="s2">&quot;ax_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;barh plot&quot;</span><span class="p">:</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;xy&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">height</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">],</span>
                                 <span class="n">fc</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;fc&quot;</span><span class="p">],</span> <span class="n">ec</span><span class="o">=</span><span class="n">temp_ec</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">],</span>
                                 <span class="n">fill</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;fill&quot;</span><span class="p">],</span> <span class="n">ls</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;ls&quot;</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;lw&quot;</span><span class="p">])</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">import_settings</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">ax_data</span><span class="p">[</span><span class="s2">&quot;ax_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;bar plot&quot;</span><span class="p">:</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;xy&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">height</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">])</span>
                    <span class="k">elif</span> <span class="n">ax_data</span><span class="p">[</span><span class="s2">&quot;ax_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;barh plot&quot;</span><span class="p">:</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;xy&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">height</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="n">item</span><span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">])</span>

        <span class="c1">### general settings</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">ax_data</span><span class="p">[</span><span class="s2">&quot;xlim&quot;</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ax_data</span><span class="p">[</span><span class="s2">&quot;ylim&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">xscale</span> <span class="o">==</span> <span class="s2">&quot;auto&quot;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="n">ax_data</span><span class="p">[</span><span class="s2">&quot;xscale&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="n">xscale</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">yscale</span> <span class="o">==</span> <span class="s2">&quot;auto&quot;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="n">ax_data</span><span class="p">[</span><span class="s2">&quot;yscale&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="n">yscale</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">align_ylim</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">axes</span>
        <span class="k">for</span> <span class="n">ndx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">cfg</span><span class="o">.</span><span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">ndx</span> <span class="o">%</span> <span class="n">cfg</span><span class="o">.</span><span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ref_ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">ndx</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">target_ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">ndx</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">ndx</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">align_limits</span><span class="p">(</span><span class="n">ref_ax</span><span class="o">=</span><span class="n">ref_ax</span><span class="p">,</span> <span class="n">target_ax</span><span class="o">=</span><span class="n">target_ax</span><span class="p">,</span> <span class="n">apply_on</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
        <span class="c1"># &quot;&quot;&quot;</span>
        <span class="c1"># if &quot;grid&quot; in kwargs:</span>
        <span class="c1">#     for ndx in range(kwargs[&quot;grid&quot;][0]*kwargs[&quot;grid&quot;][1]):</span>
        <span class="c1">#         i = ndx//kwargs[&quot;grid&quot;][1]</span>
        <span class="c1">#         j = i + ndx % kwargs[&quot;grid&quot;][1]</span>
        <span class="c1">#         if i != j:</span>
        <span class="c1">#             align_limits(ref_ax=ax[i], target_ax=ax[j], apply_on=&#39;y&#39;)</span>
        <span class="c1"># else:</span>
        <span class="c1">#     for i in range(0, len(ax), 2):</span>
        <span class="c1">#         align_limits(ref_ax=ax[i], target_ax=ax[i+1], apply_on=&#39;y&#39;)</span>
        <span class="c1"># &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">hist_minorticks</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">minorticks_off</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1">#fig = plt.gcf()</span>
    <span class="c1">#ax = fig.axes</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></div>


<div class="viewcode-block" id="hide_figure"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.hide_figure">[docs]</a><span class="k">def</span> <span class="nf">hide_figure</span><span class="p">(</span><span class="n">fig_or_ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">close</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Alias function of hide_plot(). &quot;Hide&quot; figure by setting its size to (0, 0)</span>
<span class="sd">    inches. If number is passed, apply on figure with that number.</span>

<span class="sd">    Args:</span>
<span class="sd">        fig_or_ax (None, matplotlib.figure.Figure/matplotlib.axes._subplots.Axes)</span>
<span class="sd">        num (None, int): if integer is passed, hide figure with this number</span>
<span class="sd">        close (bool): if True, close figure instead of just hiding</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fig_or_ax</span><span class="p">,</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">Figure</span><span class="p">):</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">fig_or_ax</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fig_or_ax</span><span class="p">,</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">Axes</span><span class="p">):</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">fig_or_ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">fig_or_ax</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">num</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">close</span> <span class="ow">and</span> <span class="n">num</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">close</span> <span class="ow">and</span> <span class="n">num</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>

    <span class="k">return</span></div>


<span class="c1"># alias function of hide_figure</span>
<div class="viewcode-block" id="hide_plot"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.hide_plot">[docs]</a><span class="k">def</span> <span class="nf">hide_plot</span><span class="p">(</span><span class="n">fig_or_ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">close</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="k">return</span><span class="p">(</span><span class="n">hide_figure</span><span class="p">(</span><span class="n">fig_or_ax</span><span class="o">=</span><span class="n">fig_or_ax</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">num</span><span class="p">,</span> <span class="n">close</span><span class="o">=</span><span class="n">close</span><span class="p">))</span></div>


<span class="n">update_alias_docstring</span><span class="p">(</span><span class="n">hide_plot</span><span class="p">,</span> <span class="n">hide_figure</span><span class="p">)</span>


<span class="c1">#################################################################################</span>
<span class="c1">################################################################################</span>
<span class="c1">### limits, ticks and labels functions for plot aesthetics of gridplots</span>

<div class="viewcode-block" id="align_limits"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.align_limits">[docs]</a><span class="k">def</span> <span class="nf">align_limits</span><span class="p">(</span><span class="n">ref_ax</span><span class="p">,</span> <span class="n">target_ax</span><span class="p">,</span> <span class="n">apply_on</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">new_lim</span><span class="o">=</span><span class="p">[]):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    - Read limits of ref_ax and asign them to target_ax</span>
<span class="sd">    - if &quot;new_lim&quot; is passed: assign new values to both ref_ax and target_ax</span>

<span class="sd">    Args:</span>
<span class="sd">        ref_ax (matplotlib.axes._subplots.Axes)</span>
<span class="sd">        target_ax (matplotlib.axes._subplots.Axes)</span>
<span class="sd">        apply_on (str): &#39;x&#39;, &#39;y&#39;, &#39;xy&#39;</span>
<span class="sd">        new_lim (list): assign new values to both ref_ax and target_ax</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ax_data</span> <span class="o">=</span> <span class="n">_pickle_get_ax_data</span><span class="p">(</span><span class="n">ref_ax</span><span class="p">)</span>
    <span class="c1">##################################################</span>
    <span class="c1"># nested functions</span>

    <span class="k">def</span> <span class="nf">_apply_on_x</span><span class="p">(</span><span class="n">ax</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">new_lim</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">ax_data</span><span class="p">[</span><span class="s2">&quot;xlim&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">new_lim</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_apply_on_y</span><span class="p">(</span><span class="n">ax</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">new_lim</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ax_data</span><span class="p">[</span><span class="s2">&quot;ylim&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">new_lim</span><span class="p">)</span>
    <span class="c1">##################################################</span>
    <span class="k">if</span> <span class="s2">&quot;x&quot;</span> <span class="ow">in</span> <span class="n">apply_on</span><span class="p">:</span>
        <span class="n">_apply_on_x</span><span class="p">(</span><span class="n">ref_ax</span><span class="p">)</span>
        <span class="n">_apply_on_x</span><span class="p">(</span><span class="n">target_ax</span><span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;y&quot;</span> <span class="ow">in</span> <span class="n">apply_on</span><span class="p">:</span>
        <span class="n">_apply_on_y</span><span class="p">(</span><span class="n">ref_ax</span><span class="p">)</span>
        <span class="n">_apply_on_y</span><span class="p">(</span><span class="n">target_ax</span><span class="p">)</span>
    <span class="k">return</span></div>


<div class="viewcode-block" id="align_ticks"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.align_ticks">[docs]</a><span class="k">def</span> <span class="nf">align_ticks</span><span class="p">(</span><span class="n">ref_ax</span><span class="p">,</span> <span class="n">target_ax</span><span class="p">,</span> <span class="n">apply_on</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">new_ticks</span><span class="o">=</span><span class="p">[]):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    - Read ticks of ref_ax and asign them to target_ax</span>
<span class="sd">    - if &quot;new_ticks&quot; is passed: assign new values to both ref_ax and target_ax</span>

<span class="sd">    Args:</span>
<span class="sd">        ref_ax (matplotlib.axes._subplots.Axes)</span>
<span class="sd">        target_ax (matplotlib.axes._subplots.Axes)</span>
<span class="sd">        apply_on (str): &#39;x&#39;, &#39;y&#39;, &#39;xy&#39;</span>
<span class="sd">        new_ticks (list): assign new values to both ref_ax and target_ax</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ax_data</span> <span class="o">=</span> <span class="n">_pickle_get_ax_data</span><span class="p">(</span><span class="n">ref_ax</span><span class="p">)</span>
    <span class="c1">##################################################</span>
    <span class="c1"># nested functions</span>

    <span class="k">def</span> <span class="nf">_apply_on_x</span><span class="p">(</span><span class="n">ax</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">new_ticks</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ax_data</span><span class="p">[</span><span class="s2">&quot;xticks&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">new_ticks</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_apply_on_y</span><span class="p">(</span><span class="n">ax</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">new_ticks</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">ax_data</span><span class="p">[</span><span class="s2">&quot;yticks&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">new_ticks</span><span class="p">)</span>
    <span class="c1">##################################################</span>
    <span class="k">if</span> <span class="s2">&quot;x&quot;</span> <span class="ow">in</span> <span class="n">apply_on</span><span class="p">:</span>
        <span class="n">_apply_on_x</span><span class="p">(</span><span class="n">ref_ax</span><span class="p">)</span>
        <span class="n">_apply_on_x</span><span class="p">(</span><span class="n">target_ax</span><span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;y&quot;</span> <span class="ow">in</span> <span class="n">apply_on</span><span class="p">:</span>
        <span class="n">_apply_on_y</span><span class="p">(</span><span class="n">ref_ax</span><span class="p">)</span>
        <span class="n">_apply_on_y</span><span class="p">(</span><span class="n">target_ax</span><span class="p">)</span>
    <span class="k">return</span></div>


<div class="viewcode-block" id="align_ticklabels"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.align_ticklabels">[docs]</a><span class="k">def</span> <span class="nf">align_ticklabels</span><span class="p">(</span><span class="n">ref_ax</span><span class="p">,</span> <span class="n">target_ax</span><span class="p">,</span> <span class="n">apply_on</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">new_ticklabels</span><span class="o">=</span><span class="p">[]):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    - Read ticklabels of ref_ax and asign them to target_ax</span>
<span class="sd">    - if &quot;new_ticklabels&quot; is passed: assign new values to both ref_ax and target_ax</span>

<span class="sd">    Args:</span>
<span class="sd">        ref_ax (matplotlib.axes._subplots.Axes)</span>
<span class="sd">        target_ax (matplotlib.axes._subplots.Axes)</span>
<span class="sd">        apply_on (str): &#39;x&#39;, &#39;y&#39;, &#39;xy&#39;</span>
<span class="sd">        new_ticklabels (list): assign new values to both ref_ax and target_ax</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ax_data</span> <span class="o">=</span> <span class="n">_pickle_get_ax_data</span><span class="p">(</span><span class="n">ref_ax</span><span class="p">)</span>
    <span class="c1">##################################################</span>
    <span class="c1"># nested functions</span>

    <span class="k">def</span> <span class="nf">_apply_on_x</span><span class="p">(</span><span class="n">ax</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">new_ticklabels</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">ax_data</span><span class="p">[</span><span class="s2">&quot;xticklabels&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">new_ticklabels</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_apply_on_y</span><span class="p">(</span><span class="n">ax</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">new_ticklabels</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">ax_data</span><span class="p">[</span><span class="s2">&quot;yticklabels&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">new_ticklabels</span><span class="p">)</span>
    <span class="c1">##################################################</span>
    <span class="k">if</span> <span class="s2">&quot;x&quot;</span> <span class="ow">in</span> <span class="n">apply_on</span><span class="p">:</span>
        <span class="n">_apply_on_x</span><span class="p">(</span><span class="n">ref_ax</span><span class="p">)</span>
        <span class="n">_apply_on_x</span><span class="p">(</span><span class="n">target_ax</span><span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;y&quot;</span> <span class="ow">in</span> <span class="n">apply_on</span><span class="p">:</span>
        <span class="n">_apply_on_y</span><span class="p">(</span><span class="n">ref_ax</span><span class="p">)</span>
        <span class="n">_apply_on_y</span><span class="p">(</span><span class="n">target_ax</span><span class="p">)</span>
    <span class="k">return</span></div>


<div class="viewcode-block" id="apply_shared_axes"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.apply_shared_axes">[docs]</a><span class="k">def</span> <span class="nf">apply_shared_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">grid</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    - removes xticklabels of all axes except for bottom row.</span>
<span class="sd">    - removes yticklabels of all axes except for left column.</span>

<span class="sd">    Args:</span>
<span class="sd">        ax (class, list)</span>
<span class="sd">            ax or list of axes ~ matplotlib.axes._subplots.Axes</span>
<span class="sd">        grid (list)</span>
<span class="sd">            grid of figure (example: grid=[2,2] for 2x2 figure or grid =[3,2] for 3x2 figure)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ndx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

    <span class="c1"># grid indices of left column</span>
    <span class="n">ndx_left</span> <span class="o">=</span> <span class="n">ndx</span><span class="p">[::</span><span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="c1"># grid indices of bottom row</span>
    <span class="n">ndx_bottom</span> <span class="o">=</span> <span class="n">ndx</span><span class="p">[</span><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]:]</span>

    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ndx</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">ndx_left</span><span class="p">)]:</span>
        <span class="n">item</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ndx</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">ndx_bottom</span><span class="p">)]:</span>
        <span class="n">item</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
    <span class="k">return</span></div>


<div class="viewcode-block" id="convert_ticklabels"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.convert_ticklabels">[docs]</a><span class="k">def</span> <span class="nf">convert_ticklabels</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">multiplier</span><span class="p">,</span> <span class="n">apply_on</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Read ticklabels of axes and multiply with &quot;multiplier&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        axes (list of matplotlib.axes._subplots.Axes)</span>
<span class="sd">        multiplier (int/float): multiplier for conversion, ie: new_tickvalue = multiplier * old_tickvalue</span>
<span class="sd">        apply_on (str): &#39;x&#39;, &#39;y&#39;, &#39;xy&#39;</span>
<span class="sd">        prec (int):</span>
<span class="sd">          | precision</span>
<span class="sd">          | 0: use integers with no decimal precision</span>
<span class="sd">          | n: float with n decimal precision</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;x&quot;</span> <span class="ow">in</span> <span class="n">apply_on</span><span class="p">:</span>
            <span class="c1"># read</span>
            <span class="n">xticklabels</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">temp</span><span class="p">:</span>
                <span class="n">xticklabels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">get_text</span><span class="p">())</span>
            <span class="c1"># convert</span>
            <span class="k">if</span> <span class="n">prec</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">xticklabels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="o">*</span><span class="n">multiplier</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">xticklabels</span> <span class="k">if</span> <span class="n">item</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">prec</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">xticklabels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="o">*</span><span class="n">multiplier</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">xticklabels</span> <span class="k">if</span> <span class="n">item</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">xticklabels</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;y&quot;</span> <span class="ow">in</span> <span class="n">apply_on</span><span class="p">:</span>
            <span class="c1"># read</span>
            <span class="n">yticklabels</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">temp</span><span class="p">:</span>
                <span class="n">yticklabels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">get_text</span><span class="p">())</span>

            <span class="c1"># convert</span>
            <span class="k">if</span> <span class="n">prec</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">yticklabels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="o">*</span><span class="n">multiplier</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">yticklabels</span> <span class="k">if</span> <span class="n">item</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">prec</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">yticklabels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="o">*</span><span class="n">multiplier</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">yticklabels</span> <span class="k">if</span> <span class="n">item</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">yticklabels</span><span class="p">)</span>
    <span class="k">return</span></div>


<div class="viewcode-block" id="number_base_factorization"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.number_base_factorization">[docs]</a><span class="k">class</span> <span class="nc">number_base_factorization</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to get 10base factorization of any number,</span>
<span class="sd">    e.g. 123 = 3*10^0 + 2*10^1 + 1*10^2</span>

<span class="sd">    Example:</span>
<span class="sd">      | &gt;&gt; x = number_base_factorization(123)</span>
<span class="sd">      | &gt;&gt; x() # show content of x</span>
<span class="sd">      | self.number: 123</span>
<span class="sd">      | self.sign: +</span>
<span class="sd">      | self.digits: [1, 2, 3]</span>
<span class="sd">      | self.pos_base10_factors: [3, 2, 1]</span>
<span class="sd">      | self.neg_base10_factors: None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">get_sign</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            signum function</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="n">num</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;+&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;-&quot;</span>

        <span class="k">def</span> <span class="nf">get_digits</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Convert &lt;num&gt; into list of digits.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">digits</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">if</span> <span class="n">d</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="s2">&quot;-.&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="p">)]</span>
            <span class="k">if</span> <span class="s2">&quot;-&quot;</span> <span class="ow">in</span> <span class="n">digits</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">digits</span><span class="p">[</span><span class="n">digits</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)]</span>
            <span class="k">return</span> <span class="n">digits</span>

        <span class="k">def</span> <span class="nf">base10_factorize</span><span class="p">(</span><span class="n">digits</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            get base10 factorization of a list with digits.</span>

<span class="sd">            Args:</span>
<span class="sd">                digits (list)</span>

<span class="sd">            Returns:</span>
<span class="sd">                pos_base10_factors (list)</span>
<span class="sd">                    list with positive factors</span>
<span class="sd">                neg_base10_factors (list)</span>
<span class="sd">                    list with negative factors</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="s2">&quot;.&quot;</span> <span class="ow">in</span> <span class="n">digits</span><span class="p">:</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="n">digits</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
                <span class="n">pos_base10_factors</span> <span class="o">=</span> <span class="n">digits</span><span class="p">[:</span><span class="n">temp</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">neg_base10_factors</span> <span class="o">=</span> <span class="n">digits</span><span class="p">[</span><span class="n">temp</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pos_base10_factors</span> <span class="o">=</span> <span class="n">digits</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">neg_base10_factors</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">return</span> <span class="n">pos_base10_factors</span><span class="p">,</span> <span class="n">neg_base10_factors</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="n">num</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sign</span> <span class="o">=</span> <span class="n">get_sign</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">digits</span> <span class="o">=</span> <span class="n">get_digits</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">base10_factorize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">digits</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos_base10_factors</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">neg_base10_factors</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Print class content.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;self.number:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;self.sign:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sign</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;self.digits:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">digits</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;self.pos_base10_factors:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos_base10_factors</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;self.neg_base10_factors:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">neg_base10_factors</span><span class="p">)</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="setup_ticks"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.setup_ticks">[docs]</a><span class="k">def</span> <span class="nf">setup_ticks</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">major_base</span><span class="p">,</span> <span class="n">minor_base</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Setup axis ticks of a plot in vmin &lt;= ticks &lt;= vmax.</span>

<span class="sd">    Args:</span>
<span class="sd">        vmin (int, float)</span>
<span class="sd">        vmax (int, float)</span>
<span class="sd">        major_base (int, float)</span>
<span class="sd">        minor_base (int, float)</span>

<span class="sd">    Returns:</span>
<span class="sd">        majorticks (list)</span>
<span class="sd">            list with majorticks</span>
<span class="sd">        minorticks (list)</span>
<span class="sd">            list with minorticks</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">min_</span> <span class="o">=</span> <span class="n">round_down</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="n">major_base</span><span class="p">)</span>
    <span class="n">max_</span> <span class="o">=</span> <span class="n">round_up</span><span class="p">(</span><span class="n">vmax</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="n">major_base</span><span class="p">)</span>

    <span class="n">majorticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">min_</span><span class="p">,</span> <span class="n">max_</span><span class="o">+</span><span class="n">major_base</span><span class="p">,</span> <span class="n">major_base</span><span class="p">)</span>
    <span class="n">majorticks</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">majorticks</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">vmin</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">vmax</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">minor_base</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">minorticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">min_</span><span class="o">+</span><span class="n">minor_base</span><span class="p">,</span> <span class="n">max_</span><span class="p">,</span> <span class="n">minor_base</span><span class="p">)</span>
        <span class="n">minorticks</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">minorticks</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">majorticks</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">minorticks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">majorticks</span><span class="p">,</span> <span class="n">minorticks</span></div>


<div class="viewcode-block" id="setup_logscale_ticks"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.setup_logscale_ticks">[docs]</a><span class="k">def</span> <span class="nf">setup_logscale_ticks</span><span class="p">(</span><span class="n">vmax</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Setup majorticks and minorticks for logscale with ticks &lt;= vmax.</span>

<span class="sd">    Args:</span>
<span class="sd">        vmax (int, float)</span>

<span class="sd">    Returns:</span>
<span class="sd">        majorticks (list)</span>
<span class="sd">            ticks at 1, 10, 100, 1000, etc.</span>
<span class="sd">        minorticks (list):</span>
<span class="sd">            ticks at 2, 3, 4,..., 8, 9, 20,30,40,...,80,90, etc.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">vmax_factorized</span> <span class="o">=</span> <span class="n">number_base_factorization</span><span class="p">(</span><span class="n">vmax</span><span class="p">)</span>
    <span class="n">majorticks</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">minorticks</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">ndx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vmax_factorized</span><span class="o">.</span><span class="n">pos_base10_factors</span><span class="p">):</span>
        <span class="n">major</span><span class="p">,</span> <span class="n">minor</span> <span class="o">=</span> <span class="n">setup_ticks</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="n">ndx</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">ndx</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">major_base</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">ndx</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">minor_base</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="n">ndx</span><span class="p">)</span>
        <span class="n">majorticks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">major</span><span class="p">)</span>
        <span class="n">minorticks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">minor</span><span class="p">)</span>

    <span class="n">majorticks</span> <span class="o">=</span> <span class="n">flatten_array</span><span class="p">(</span><span class="n">majorticks</span><span class="p">)</span>
    <span class="n">minorticks</span> <span class="o">=</span> <span class="n">flatten_array</span><span class="p">(</span><span class="n">minorticks</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">majorticks</span><span class="p">,</span> <span class="n">minorticks</span></div>


<div class="viewcode-block" id="set_logscale_ticks"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.set_logscale_ticks">[docs]</a><span class="k">def</span> <span class="nf">set_logscale_ticks</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">apply_on</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">minorticks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply logscale ticks on ax. If vmax is specified, sets vmax as upper limit.</span>

<span class="sd">    Args:</span>
<span class="sd">        ax (matplotlib.axes._subplots.Axes)</span>
<span class="sd">        apply_on (str): &quot;x&quot;, &quot;y&quot;, &quot;xy&quot;</span>
<span class="sd">        vmin (None, int, float): highest logscale tick value</span>
<span class="sd">        minorticks (bool): display minorticks on/off</span>

<span class="sd">    Keyword Args:</span>
<span class="sd">        xmin (None, int, float)</span>
<span class="sd">        xmax (None, int, float)</span>
<span class="sd">        ymin (None, int, float)</span>
<span class="sd">        ymax (None, int, float)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">default</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="n">vmax</span><span class="p">,</span>
               <span class="s2">&quot;xmin&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
               <span class="s2">&quot;xmax&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
               <span class="s2">&quot;ymin&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
               <span class="s2">&quot;ymax&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
    <span class="n">cfg</span> <span class="o">=</span> <span class="n">CONFIG</span><span class="p">(</span><span class="n">default</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot;x&quot;</span> <span class="ow">in</span> <span class="n">apply_on</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">vmax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
        <span class="n">major</span><span class="p">,</span> <span class="n">minor</span> <span class="o">=</span> <span class="n">setup_logscale_ticks</span><span class="p">(</span><span class="n">vmax</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">xmin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cfg</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">xmax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">xmax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([],</span> <span class="n">minor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">major</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">minorticks</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">minor</span><span class="p">,</span> <span class="n">minor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># set upper limit via vmax (not cfg.vmax)</span>
        <span class="k">if</span> <span class="n">vmax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">xmax</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot;y&quot;</span> <span class="ow">in</span> <span class="n">apply_on</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">vmax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">major</span><span class="p">,</span> <span class="n">minor</span> <span class="o">=</span> <span class="n">setup_logscale_ticks</span><span class="p">(</span><span class="n">vmax</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">ymin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cfg</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">ymax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">ymax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([],</span> <span class="n">minor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">major</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">minorticks</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">minor</span><span class="p">,</span> <span class="n">minor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># set upper limit via vmax (not cfg.vmax)</span>
        <span class="k">if</span> <span class="n">vmax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">ymax</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">)</span>

    <span class="k">return</span></div>

<span class="c1">#################################################################################</span>
<span class="c1">################################################################################</span>
<span class="c1">### colorbar functions</span>


<div class="viewcode-block" id="create_cmap"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.create_cmap">[docs]</a><span class="k">def</span> <span class="nf">create_cmap</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a LinearSegmentedColormap</span>

<span class="sd">    Args:</span>
<span class="sd">        seq (sequence): sequence of color strings and floats. The floats describe the color thresholds and</span>
<span class="sd">           should be increasing and in the interval (0,1).</span>
<span class="sd">        vmin (float): min value of cmap</span>
<span class="sd">        vmax (float): max value of cmap</span>
<span class="sd">        ax (None, ax): figure ax for adding colorbar</span>

<span class="sd">    Returns:</span>
<span class="sd">        cmap (LinearSegmentedColormap)</span>

<span class="sd">    Example:</span>
<span class="sd">        seq = [&quot;lightblue&quot;, 2/6, &quot;lightgreen&quot;, 3/6, &quot;yellow&quot;, 4/6, &quot;orange&quot;, 5/6, &quot;red&quot;]</span>
<span class="sd">        cmap = misc.create_cmap(seq, vmin=0, vmax=12)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">ndx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">seq</span><span class="p">[</span><span class="n">ndx</span><span class="p">]</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">ColorConverter</span><span class="p">()</span><span class="o">.</span><span class="n">to_rgb</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="n">seq</span> <span class="o">=</span> <span class="p">[(</span><span class="kc">None</span><span class="p">,)</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="p">(</span><span class="kc">None</span><span class="p">,)</span> <span class="o">*</span> <span class="mi">3</span><span class="p">]</span>
    <span class="n">cdict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;red&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;green&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;blue&#39;</span><span class="p">:</span> <span class="p">[]}</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="n">r1</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">b1</span> <span class="o">=</span> <span class="n">seq</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">r2</span><span class="p">,</span> <span class="n">g2</span><span class="p">,</span> <span class="n">b2</span> <span class="o">=</span> <span class="n">seq</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">cdict</span><span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">item</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">])</span>
            <span class="n">cdict</span><span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">item</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g2</span><span class="p">])</span>
            <span class="n">cdict</span><span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">item</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">])</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LinearSegmentedColormap</span><span class="p">(</span><span class="s1">&#39;CustomMap&#39;</span><span class="p">,</span> <span class="n">cdict</span><span class="p">)</span>

    <span class="c1"># add colorbar if ax is passed</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">vmin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">vmax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">vmax</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">_norm</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">_norm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cmap</span></div>


<div class="viewcode-block" id="add_cbar_ax"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.add_cbar_ax">[docs]</a><span class="k">def</span> <span class="nf">add_cbar_ax</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add colorbar ax relative to existing ax.</span>

<span class="sd">    Args:</span>
<span class="sd">        ax (matplotlib.axes._subplots.Axes)</span>
<span class="sd">        bounds (str,list):</span>
<span class="sd">          | str: &quot;auto&quot;: apply bounds based on kws &#39;orientation&#39; and &#39;location&#39;.</span>
<span class="sd">          | list: [x0, y0, height, width] using axes coordinates.</span>
<span class="sd">          |       Ignores kws &#39;orientation&#39; and &#39;location&#39;.</span>
<span class="sd">        location (str): &quot;right&quot;, &quot;bottom&quot;, &quot;left&quot;, &quot;top&quot;</span>
<span class="sd">        orientation (str): &quot;vertical&quot;, &quot;horizontal&quot;</span>

<span class="sd">    Returns:</span>
<span class="sd">        cbar_ax (matplotlib.axes._axes.Axes)</span>
<span class="sd">            colorbar ax</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># apply passed bounds and ignore kws &#39;orientation&#39; and &#39;location&#39;</span>
    <span class="k">if</span> <span class="n">bounds</span> <span class="o">!=</span> <span class="s2">&quot;auto&quot;</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="c1"># apply bounds based on kws &#39;orientation&#39; and &#39;location&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">location</span> <span class="o">==</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span>
            <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="mf">1.05</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">location</span> <span class="o">==</span> <span class="s2">&quot;left&quot;</span><span class="p">:</span>
            <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">location</span> <span class="o">==</span> <span class="s2">&quot;top&quot;</span><span class="p">:</span>
            <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.1</span>
        <span class="k">elif</span> <span class="n">location</span> <span class="o">==</span> <span class="s2">&quot;bottom&quot;</span><span class="p">:</span>
            <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span>

        <span class="k">if</span> <span class="n">orientation</span> <span class="o">==</span> <span class="s2">&quot;horizontal&quot;</span><span class="p">:</span>
            <span class="n">h</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">orientation</span> <span class="o">==</span> <span class="s2">&quot;vertical&quot;</span><span class="p">:</span>
            <span class="n">h</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.05</span>

        <span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">]</span>

    <span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">inset_axes</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cbar_ax</span></div>


<div class="viewcode-block" id="add_cbar"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.add_cbar">[docs]</a><span class="k">def</span> <span class="nf">add_cbar</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">cbar_ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Draw colorbar relative to existing ax.</span>

<span class="sd">    Args:</span>
<span class="sd">        ax (matplotlib.axes._subplots.Axes)</span>
<span class="sd">        cbar_ax (None/matplotlib.axes._axes.Axes):</span>
<span class="sd">          | colorbar ax</span>
<span class="sd">          | None: add new cbar_ax relative to existing ax</span>
<span class="sd">          | matplotlib.axes._axes.Axes: use passed cbar_ax (can be created using misc.add_cbar_ax()).</span>
<span class="sd">        cmap (None, LinearSegmentedColormap): output of create_cmap()</span>
<span class="sd">        bounds (str, list):</span>
<span class="sd">          | str: &quot;auto&quot;: apply bounds based on kws &#39;orientation&#39; and &#39;location&#39;.</span>
<span class="sd">          | list: [x0, y0, height, width] using axes coordinates.</span>
<span class="sd">          |       Ignores kws &#39;orientation&#39; and &#39;location&#39;.</span>
<span class="sd">        location (str): &quot;right&quot;, &quot;bottom&quot;, &quot;left&quot;, &quot;top&quot;</span>
<span class="sd">        orientation (str): &quot;vertical&quot;, &quot;horizontal&quot;</span>

<span class="sd">    Keyword Args:</span>
<span class="sd">        vmin (None, float): colorbar min value</span>
<span class="sd">        vmax (None, float): colorbar max value</span>
<span class="sd">        cbar_label/label (str)</span>
<span class="sd">        cbar_fontweight/fontweight (str): &quot;normal&quot;, &quot;bold&quot;</span>
<span class="sd">        cbar_location/location (str): &quot;right&quot;, &quot;bottom&quot;, &quot;left&quot;, &quot;top&quot;</span>
<span class="sd">        cbar_orientation/orientation (str): &quot;vertical&quot;, &quot;horizontal&quot;</span>

<span class="sd">    Returns:</span>
<span class="sd">        cbar (matplotlib.colorbar.Colorbar)</span>
<span class="sd">            color bar</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">default</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;vmin&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
               <span class="s2">&quot;vmax&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
               <span class="s2">&quot;cbar_label&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
               <span class="s2">&quot;cbar_fontweight&quot;</span><span class="p">:</span> <span class="s2">&quot;normal&quot;</span><span class="p">,</span>
               <span class="s2">&quot;cbar_location&quot;</span><span class="p">:</span> <span class="n">location</span><span class="p">,</span>
               <span class="s2">&quot;cbar_orientation&quot;</span><span class="p">:</span> <span class="n">orientation</span>
               <span class="p">}</span>

    <span class="n">cfg</span> <span class="o">=</span> <span class="n">CONFIG</span><span class="p">(</span><span class="n">default</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">cfg</span><span class="o">.</span><span class="n">update_by_alias</span><span class="p">(</span><span class="n">alias</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;cbar_label&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">cfg</span><span class="o">.</span><span class="n">update_by_alias</span><span class="p">(</span><span class="n">alias</span><span class="o">=</span><span class="s2">&quot;fontweight&quot;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;cbar_fontweight&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">cbar_ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">add_cbar_ax</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span>
                              <span class="n">location</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">cbar_location</span><span class="p">,</span>
                              <span class="n">orientation</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">cbar_orientation</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_children</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">collections</span><span class="o">.</span><span class="n">QuadMesh</span><span class="p">):</span>
            <span class="n">QuadMesh</span> <span class="o">=</span> <span class="n">item</span>  <span class="c1"># QuadMesh ~ sns.heatmap() plots</span>

    <span class="k">if</span> <span class="s2">&quot;QuadMesh&quot;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">():</span>
        <span class="c1"># mappable must be matplotlib.cm.ScalarMappable ~ sns.heatmap()</span>
        <span class="c1"># see help(fig.colorbar) for more info</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">mappable</span><span class="o">=</span><span class="n">QuadMesh</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">cbar_orientation</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LinearSegmentedColormap</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">vmin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cfg</span><span class="o">.</span><span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">vmax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cfg</span><span class="o">.</span><span class="n">vmax</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">_norm</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">vmax</span><span class="p">)</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">_norm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">),</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">cbar_orientation</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#print(&quot;misc.add_cbar() works currently only with sns.heatmap() plots.&quot;)</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">cbar_orientation</span><span class="p">)</span>

    <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">cbar_label</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">cbar_fontweight</span><span class="p">)</span>
    <span class="n">cbar_set_ticks_position</span><span class="p">(</span><span class="n">cbar</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">cbar_location</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cbar</span></div>


<div class="viewcode-block" id="cbar_set_ticks_position"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.cbar_set_ticks_position">[docs]</a><span class="k">def</span> <span class="nf">cbar_set_ticks_position</span><span class="p">(</span><span class="n">cbar</span><span class="p">,</span> <span class="n">location</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set ticks position of colorbar.</span>

<span class="sd">    Args:</span>
<span class="sd">        cbar (matplotlib.colorbar.Colorbar)</span>
<span class="sd">        location (str): &quot;right&quot;, &quot;bottom&quot;, &quot;left&quot;, &quot;top&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">location</span> <span class="o">==</span> <span class="s2">&quot;top&quot;</span> <span class="ow">or</span> <span class="n">location</span> <span class="o">==</span> <span class="s2">&quot;bottom&quot;</span><span class="p">:</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">location</span> <span class="o">==</span> <span class="s2">&quot;right&quot;</span> <span class="ow">or</span> <span class="n">location</span> <span class="o">==</span> <span class="s2">&quot;left&quot;</span><span class="p">:</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
    <span class="k">return</span></div>
<span class="c1">#################################################################################</span>
<span class="c1">################################################################################</span>
<span class="c1">### complete / append docstrings</span>


<div class="viewcode-block" id="INIT_append_docstrings"><a class="viewcode-back" href="../../pyrexMD.html#pyrexMD.misc.INIT_append_docstrings">[docs]</a><span class="k">def</span> <span class="nf">INIT_append_docstrings</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Some functions in this module have split up docstrings.</span>
<span class="sd">    The intention of this design choice is to assure that docstrings which rely</span>
<span class="sd">    on each other are matching and always up to date. This function is executed</span>
<span class="sd">    ONCE upon initialization of the module and appends the missing parts.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_pickle_get_ax_data</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">+=</span> <span class="n">__pickle_get_ax_data___append_doc__</span>
    <span class="n">_pickle_get_line_data</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">+=</span> <span class="n">__pickle_get_line_data___append_doc__</span>
    <span class="n">_pickle_get_rectangle_data</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">+=</span> <span class="n">__pickle_get_rectangle_data___append_doc__</span> <span class="o">+</span> <span class="n">__pickle_get_rectangle_data___bugs_doc__</span>

    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">[</span><span class="n">__pickle_get_ax_data___append_doc__</span><span class="p">,</span>
                 <span class="n">__pickle_get_line_data___append_doc__</span><span class="p">,</span>
                 <span class="n">__pickle_get_rectangle_data___append_doc__</span><span class="p">,</span>
                 <span class="n">__pickle_load___append_doc__</span><span class="p">]:</span>
        <span class="n">pickle_load</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">+=</span> <span class="n">item</span>
    <span class="k">return</span></div>


<span class="n">INIT_append_docstrings</span><span class="p">()</span>
</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, KIT-MBS.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>