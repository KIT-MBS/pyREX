

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>pyrexMD.misc.func &mdash; pyrexMD 1.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/style.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #343131" >
          

          
            <a href="../../../index.html" class="icon icon-home"> pyrexMD
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../about_pyrexMD.html">About pyrexMD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../quick_guide.html">Quick Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">API Docs</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">pyrexMD</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>pyrexMD.misc.func</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pyrexMD.misc.func</h1><div class="highlight"><pre>
<span></span><span class="c1"># @Author: Arthur Voronin &lt;arthur&gt;</span>
<span class="c1"># @Date:   26.08.2021</span>
<span class="c1"># @Filename: func.py</span>
<span class="c1"># @Last modified by:   arthur</span>
<span class="c1"># @Last modified time: 26.08.2021</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">.. hint:: This module is a collection of miscellaneous functions which are used</span>
<span class="sd">    frequently. Included functions may contain modified versions of small existing</span>
<span class="sd">    functions to extend their default behavior in order to streamline pyrexMD.</span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">termcolor</span>

<span class="kn">from</span> <span class="nn">pyrexMD.misc.classes</span> <span class="kn">import</span> <span class="n">Error</span><span class="p">,</span> <span class="n">dtypeError</span>


<span class="c1">################################################################################</span>
<span class="c1">################################################################################</span>
<span class="c1">### os-like modifications</span>


<div class="viewcode-block" id="get_filename"><a class="viewcode-back" href="../../../pyrexMD.misc.html#pyrexMD.misc.func.get_filename">[docs]</a><span class="k">def</span> <span class="nf">get_filename</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">search_file</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    get filename (removes prefix of realpath of &lt;path&gt;).</span>

<span class="sd">    Args:</span>
<span class="sd">        path (str)</span>
<span class="sd">        search_file (bool):</span>
<span class="sd">          | True: use &lt;path&gt; as search pattern to search for existing file</span>
<span class="sd">          | -&gt; remove prefix if only 1 match found to obtain existing filename</span>
<span class="sd">          | False: just remove prefix of given &lt;path&gt;</span>

<span class="sd">    Returns</span>
<span class="sd">        filename (str)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">search_file</span><span class="p">:</span>
        <span class="n">file_list</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">file_list</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">path</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">real_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">dir_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">real_path</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">dir_path</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">return</span> <span class="n">filename</span></div>


<div class="viewcode-block" id="joinpath"><a class="viewcode-back" href="../../../pyrexMD.misc.html#pyrexMD.misc.func.joinpath">[docs]</a><span class="k">def</span> <span class="nf">joinpath</span><span class="p">(</span><span class="n">filedir</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">create_dir</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">realpath</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns joined path of (filedir + filename).</span>

<span class="sd">    Special case:</span>
<span class="sd">        filename contains relative or absolute path: ignore filedir input</span>

<span class="sd">    Reason:</span>
<span class="sd">        intention is to save/load file under the path &quot;filename&quot;</span>


<span class="sd">    Args:</span>
<span class="sd">        filedir (str): relative or absolute path of file directory</span>
<span class="sd">        filename (str): filename or relative/absolute filepath</span>
<span class="sd">        create_dir (bool): create filedir (w/o creating parent directories)</span>
<span class="sd">        realpath (bool): return realpath</span>

<span class="sd">    Returns:</span>
<span class="sd">        file_path (str)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;/&quot;</span> <span class="ow">in</span> <span class="n">filename</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">realpath</span><span class="p">:</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filedir</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">filename</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filedir</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">filename</span><span class="p">)))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">realpath</span><span class="p">:</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filedir</span><span class="p">,</span> <span class="n">filename</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filedir</span><span class="p">,</span> <span class="n">filename</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">create_dir</span><span class="p">:</span>
        <span class="c1"># filedir: passed file directory</span>
        <span class="c1"># dirname: dirname of file_path after joining (filedir + filename)</span>
        <span class="c1">#          SPECIAL CASE: filedir ignored if filename contains rel. or abs. path</span>
        <span class="c1">#          -&gt; dirname is not always equal to filedir</span>
        <span class="n">dirname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">file_path</span><span class="p">))</span>
        <span class="n">mkdir</span><span class="p">(</span><span class="n">dirname</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">file_path</span></div>


<div class="viewcode-block" id="mkdir"><a class="viewcode-back" href="../../../pyrexMD.misc.html#pyrexMD.misc.func.mkdir">[docs]</a><span class="k">def</span> <span class="nf">mkdir</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Make directory.</span>

<span class="sd">    Args:</span>
<span class="sd">        path (str): directory path</span>
<span class="sd">        verbose (bool): print message (&#39;New folder created: ...&#39;)</span>

<span class="sd">    Returns:</span>
<span class="sd">        realpath (str)</span>
<span class="sd">            realpath to new directory</span>

<span class="sd">    Example:</span>
<span class="sd">        | &gt;&gt; cwd = /home/user/</span>
<span class="sd">        | &gt;&gt; mkdir(&#39;Test1&#39;)</span>
<span class="sd">        | New folder created: /home/user/Test1</span>
<span class="sd">        | &gt;&gt;mkdir(&#39;../Test2&#39;)</span>
<span class="sd">        | New folder created: /home/Test2</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">realpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">realpath</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">realpath</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="n">cprint</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;New folder created: </span><span class="si">{</span><span class="n">realpath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">realpath</span></div>


<div class="viewcode-block" id="cd"><a class="viewcode-back" href="../../../pyrexMD.misc.html#pyrexMD.misc.func.cd">[docs]</a><span class="k">def</span> <span class="nf">cd</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Change directory.</span>

<span class="sd">    Args:</span>
<span class="sd">        path (str): directory path</span>
<span class="sd">        verbose (bool): print message (&#39;Changed directory to: ...&#39;)</span>

<span class="sd">    Returns:</span>
<span class="sd">        realpath (str)</span>
<span class="sd">            realpath of changed directory</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">realpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">realpath</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="n">cprint</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Changed directory to: </span><span class="si">{</span><span class="n">realpath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">realpath</span></div>


<div class="viewcode-block" id="cp"><a class="viewcode-back" href="../../../pyrexMD.misc.html#pyrexMD.misc.func.cp">[docs]</a><span class="k">def</span> <span class="nf">cp</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">create_dir</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Copy file(s) from &lt;source&gt; to &lt;target&gt;. Will overwrite existing files and directories.</span>

<span class="sd">    Args:</span>
<span class="sd">        source (str, list, array): source path or list of source paths</span>
<span class="sd">        target (str): target path</span>
<span class="sd">        create_dir (bool)</span>
<span class="sd">        verbose (bool)</span>

<span class="sd">    Returns:</span>
<span class="sd">        target (str)</span>
<span class="sd">            target realpath</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">dtypeError</span><span class="p">(</span><span class="s2">&quot;Wrong datatype: &lt;target&gt; must be str (path/realpath).&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;*&quot;</span> <span class="ow">in</span> <span class="n">source</span><span class="p">:</span>
        <span class="n">source</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
    <span class="n">target</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">copytree</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">dirs_exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="n">cprint</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Copied source files to: </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="n">cprint</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Copied source file to: </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">create_dir</span><span class="p">:</span>
            <span class="n">mkdir</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">source</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
                <span class="n">shutil</span><span class="o">.</span><span class="n">copytree</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">dirs_exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="n">cprint</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Copied source files to: </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">dtypeError</span><span class="p">(</span><span class="s2">&quot;source&quot;</span><span class="p">,</span> <span class="s2">&quot;str or list of str&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">target</span></div>


<div class="viewcode-block" id="rm"><a class="viewcode-back" href="../../../pyrexMD.misc.html#pyrexMD.misc.func.rm">[docs]</a><span class="k">def</span> <span class="nf">rm</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Alias function of remove(). Remove file(s) from path.</span>

<span class="sd">    .. Note:: pattern can be implemented into path variable directly.</span>

<span class="sd">    Args:</span>
<span class="sd">        path (str): directory path</span>
<span class="sd">        pattern (None, str):</span>
<span class="sd">          | pattern</span>
<span class="sd">          | None: check for files with path only</span>
<span class="sd">          | str:  check for files with joined path of path + pattern</span>
<span class="sd">        verbose (bool): print message (&#39;removed file: ... &#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">pattern</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">realpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">realpath</span> <span class="o">=</span> <span class="n">joinpath</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">pattern</span><span class="p">)</span>

    <span class="c1"># remove files</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">realpath</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="n">cprint</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;removed file: </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;red&quot;</span><span class="p">)</span>
    <span class="k">return</span></div>


<span class="c1">################################################################################</span>
<span class="c1">################################################################################</span>
<span class="c1">### misc</span>

<div class="viewcode-block" id="cprint"><a class="viewcode-back" href="../../../pyrexMD.misc.html#pyrexMD.misc.func.cprint">[docs]</a><span class="k">def</span> <span class="nf">cprint</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Modified function of termcolor.cprint(). Apply colored print.</span>

<span class="sd">    Args:</span>
<span class="sd">        msg (str)</span>
<span class="sd">        color (None, str): &quot;grey&quot;, &quot;red&quot;, &quot;green&quot;, &quot;yellow&quot;, &quot;blue&quot;, &quot;magenta&quot;, &quot;cyan&quot;, &quot;white&quot;</span>
<span class="sd">        on_color (None, str): &quot;on_grey&quot;, &quot;on_red&quot;, &quot;on_green&quot;, &quot;on_yellow&quot;, &quot;on_blue&quot;, &quot;on_magenta&quot;, &quot;on_cyan&quot;, &quot;on_white&quot;</span>
<span class="sd">        attr (None, list):</span>
<span class="sd">          | attributes list</span>
<span class="sd">          | bold, dark, underline, blink, reverse, concealed</span>

<span class="sd">    Keyword Args:</span>
<span class="sd">        cprint_color (None, str): alias for color (with higher priority)</span>
<span class="sd">        sep (str): string inserted between values, default a space.</span>
<span class="sd">        end (str): string appended after the last value, default a newline.</span>
<span class="sd">        file (str): a file-like object (stream); defaults to the current sys.stdout.</span>
<span class="sd">        flush (bool): whether to forcibly flush the stream.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;cprint_color&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;cprint_color&quot;</span><span class="p">]</span>
        <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;cprint_color&quot;</span><span class="p">]</span>
    <span class="n">termcolor</span><span class="o">.</span><span class="n">cprint</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">on_color</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span></div>


<div class="viewcode-block" id="percent"><a class="viewcode-back" href="../../../pyrexMD.misc.html#pyrexMD.misc.func.percent">[docs]</a><span class="k">def</span> <span class="nf">percent</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">div</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the percentage of num/div as float</span>

<span class="sd">    Args:</span>
<span class="sd">        num (int): numerator</span>
<span class="sd">        div (int): divisor</span>
<span class="sd">        prec (None, int): rounding precision</span>

<span class="sd">    Returns:</span>
<span class="sd">        p (float)</span>
<span class="sd">            p = 100 * num/div</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">num</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
    <span class="n">div</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">div</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">div</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">0.0</span>             <span class="c1"># no division by zero</span>
    <span class="n">p</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">num</span> <span class="o">/</span> <span class="n">div</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">p</span></div>


<div class="viewcode-block" id="round_down"><a class="viewcode-back" href="../../../pyrexMD.misc.html#pyrexMD.misc.func.round_down">[docs]</a><span class="k">def</span> <span class="nf">round_down</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        number (float/int)</span>
<span class="sd">        base (float/int)</span>

<span class="sd">    Example:</span>
<span class="sd">      | for i in range(11):</span>
<span class="sd">      |     print(i, round_down(i,5))</span>
<span class="sd">      | (0, 0)</span>
<span class="sd">      | (1, 0)</span>
<span class="sd">      | (2, 0)</span>
<span class="sd">      | (3, 0)</span>
<span class="sd">      | (4, 0)</span>
<span class="sd">      | (5, 5)   # does not round down if remainder is zero</span>
<span class="sd">      | (6, 5)</span>
<span class="sd">      | (7, 5)</span>
<span class="sd">      | (8, 5)</span>
<span class="sd">      | (9, 5)</span>
<span class="sd">      | (10, 10)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">number</span> <span class="o">-</span> <span class="p">(</span><span class="n">number</span> <span class="o">%</span> <span class="n">base</span><span class="p">)</span></div>


<div class="viewcode-block" id="round_up"><a class="viewcode-back" href="../../../pyrexMD.misc.html#pyrexMD.misc.func.round_up">[docs]</a><span class="k">def</span> <span class="nf">round_up</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        number (float/int)</span>
<span class="sd">        base (float/int)</span>

<span class="sd">    Example:</span>
<span class="sd">      | for i in range(11):</span>
<span class="sd">      |     print(i, round_up(i,5))</span>
<span class="sd">      | (0, 0)</span>
<span class="sd">      | (1, 5)</span>
<span class="sd">      | (2, 5)</span>
<span class="sd">      | (3, 5)</span>
<span class="sd">      | (4, 5)</span>
<span class="sd">      | (5, 5)   # does not round up if remainder is zero</span>
<span class="sd">      | (6, 10)</span>
<span class="sd">      | (7, 10)</span>
<span class="sd">      | (8, 10)</span>
<span class="sd">      | (9, 10)</span>
<span class="sd">      | (10, 10)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">number</span> <span class="o">%</span> <span class="n">base</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">number</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">number</span> <span class="o">+</span> <span class="n">base</span> <span class="o">-</span> <span class="p">(</span><span class="n">number</span> <span class="o">%</span> <span class="n">base</span><span class="p">)</span></div>


<div class="viewcode-block" id="round_to_base"><a class="viewcode-back" href="../../../pyrexMD.misc.html#pyrexMD.misc.func.round_to_base">[docs]</a><span class="k">def</span> <span class="nf">round_to_base</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Round up or down depending on smallest difference to base.</span>

<span class="sd">    Args:</span>
<span class="sd">        number (float/int)</span>
<span class="sd">        base (float/int)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">up</span> <span class="o">=</span> <span class="n">round_up</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
    <span class="n">down</span> <span class="o">=</span> <span class="n">round_down</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">up</span><span class="o">-</span><span class="n">number</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">abs</span><span class="p">(</span><span class="n">number</span><span class="o">-</span><span class="n">down</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">up</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">down</span></div>


<div class="viewcode-block" id="round_object"><a class="viewcode-back" href="../../../pyrexMD.misc.html#pyrexMD.misc.func.round_object">[docs]</a><span class="k">def</span> <span class="nf">round_object</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        object (list, array):</span>
<span class="sd">          | single list/array</span>
<span class="sd">          | list of lists/arrays</span>
<span class="sd">          | array of lists/arrays</span>
<span class="sd">        prec (int): rounding precision</span>
<span class="sd">        dtype (None, dtype): return object values as specific data type</span>

<span class="sd">    Returns:</span>
<span class="sd">        new_object (list, array)</span>
<span class="sd">            same structure as object, but with rounded values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># single list/array (if error occurs, maybe add more np.&lt;data types&gt; to this case)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">object</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)):</span>
        <span class="n">new_object</span> <span class="o">=</span> <span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">object</span><span class="p">]</span>

    <span class="c1"># list of lists</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">object</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">new_object</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="nb">object</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sublist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
                <span class="n">new_sublist</span> <span class="o">=</span> <span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span>
                <span class="n">new_object</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_sublist</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_object</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sublist</span><span class="p">)</span>

    <span class="c1"># list of arrays</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">object</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">new_object</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">subarray</span> <span class="ow">in</span> <span class="nb">object</span><span class="p">:</span>
            <span class="n">new_subarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">subarray</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span>
            <span class="n">new_object</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_subarray</span><span class="p">)</span>

    <span class="c1"># array of lists/arrays: convert outer list to array</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">new_object</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">new_object</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">new_object</span></div>


<div class="viewcode-block" id="get_substrings"><a class="viewcode-back" href="../../../pyrexMD.misc.html#pyrexMD.misc.func.get_substrings">[docs]</a><span class="k">def</span> <span class="nf">get_substrings</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">seperators</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="s2">&quot;;&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    get substrings of string by removing each seperator.</span>

<span class="sd">    Args:</span>
<span class="sd">        string (str)</span>
<span class="sd">        seperators (list)</span>
<span class="sd">        reverse (bool): return substrings in reversed order</span>

<span class="sd">    Returns:</span>
<span class="sd">        substrings (list)</span>
<span class="sd">            list of substrings</span>

<span class="sd">    Example:</span>
<span class="sd">        | &gt;&gt; get_substrings(&quot;split/this_string.into:parts&quot;)</span>
<span class="sd">        | [&#39;split&#39;, &#39;this&#39;, &#39;string&#39;, &#39;into&#39;, &#39;parts&#39;]</span>
<span class="sd">        | &gt;&gt; get_substrings(&quot;split/this_string.into:parts&quot;, reverse=True)</span>
<span class="sd">        | [&#39;parts&#39;, &#39;into&#39;, &#39;string&#39;, &#39;this&#39;, &#39;split&#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">sep</span> <span class="ow">in</span> <span class="n">seperators</span><span class="p">:</span>
        <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">sep</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
    <span class="n">substrings</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">reverse</span><span class="p">:</span>
        <span class="n">substrings</span> <span class="o">=</span> <span class="n">substrings</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">substrings</span></div>


<div class="viewcode-block" id="split_lists"><a class="viewcode-back" href="../../../pyrexMD.misc.html#pyrexMD.misc.func.split_lists">[docs]</a><span class="k">def</span> <span class="nf">split_lists</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">remap</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    split list A into two lists B1 and B2 according to A = B1 + B2,</span>
<span class="sd">    where B2 contains every n-th element of A.</span>

<span class="sd">    Args:</span>
<span class="sd">        A (int, list, array):</span>
<span class="sd">          | int: initialize A according to: A = list(range(A))</span>
<span class="sd">          | list, array: input list A which should be split</span>
<span class="sd">        n (int): split every n-th element of A into B2</span>
<span class="sd">        remap (bool): remap Bi according to: Bi = range(0, len(Bi))</span>

<span class="sd">    Returns:</span>
<span class="sd">        A (list)</span>
<span class="sd">            input list A</span>
<span class="sd">        B1 (list)</span>
<span class="sd">            partial list B1</span>
<span class="sd">        B2 (list)</span>
<span class="sd">            partial list B2 (contains every n-th element of A)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">A</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span> <span class="nb">type</span><span class="p">((</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">))))):</span>
        <span class="n">A</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;A has to be int, list/np.array or range/generator.&quot;</span><span class="p">)</span>

    <span class="n">B1</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">B2</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">remap</span><span class="p">:</span>
        <span class="n">B1</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">B1</span><span class="p">)))</span>
        <span class="n">B2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">B2</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">A</span><span class="p">,</span> <span class="n">B1</span><span class="p">,</span> <span class="n">B2</span></div>


<div class="viewcode-block" id="flatten_array"><a class="viewcode-back" href="../../../pyrexMD.misc.html#pyrexMD.misc.func.flatten_array">[docs]</a><span class="k">def</span> <span class="nf">flatten_array</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns flattened array of x.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (array, array of arrays)</span>

<span class="sd">    Returns:</span>
<span class="sd">        flattened_array (array)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">flattened_array</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">x</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sub</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="n">flattened_array</span> <span class="o">=</span> <span class="n">x</span>
    <span class="k">return</span> <span class="n">flattened_array</span></div>


<div class="viewcode-block" id="norm_array"><a class="viewcode-back" href="../../../pyrexMD.misc.html#pyrexMD.misc.func.norm_array">[docs]</a><span class="k">def</span> <span class="nf">norm_array</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">start_value</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    norm array</span>

<span class="sd">      - starts with &lt;start_value&gt;</span>
<span class="sd">      - deltaValue is fixed to 1 (i.e. array[i]- array[i+1] = 1)</span>

<span class="sd">    Args:</span>
<span class="sd">        array (list, array)</span>

<span class="sd">    Returns:</span>
<span class="sd">        normed_array (list, array)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
    <span class="n">normed_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">l</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">normed_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">normed_array</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
        <span class="n">normed_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">start_value</span>
    <span class="k">return</span> <span class="n">normed_array</span></div>


<div class="viewcode-block" id="get_precision"><a class="viewcode-back" href="../../../pyrexMD.misc.html#pyrexMD.misc.func.get_precision">[docs]</a><span class="k">def</span> <span class="nf">get_precision</span><span class="p">(</span><span class="n">number</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns leading precision of number.</span>

<span class="sd">      - convert float to string</span>
<span class="sd">      - find position of decimal point relative to the length of the string</span>

<span class="sd">    Args:</span>
<span class="sd">        number (int, float)</span>

<span class="sd">    Returns:</span>
<span class="sd">        precision (int)</span>

<span class="sd">    Example:</span>
<span class="sd">        | &gt;&gt; get_precision(5.00000)</span>
<span class="sd">        | 1</span>
<span class="sd">        | &gt;&gt; get_precision(5.12300)</span>
<span class="sd">        | 3</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">number</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">number</span> <span class="o">=</span> <span class="n">number</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>
    <span class="n">precision</span> <span class="o">=</span> <span class="n">s</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">precision</span></div>


<div class="viewcode-block" id="get_base"><a class="viewcode-back" href="../../../pyrexMD.misc.html#pyrexMD.misc.func.get_base">[docs]</a><span class="k">def</span> <span class="nf">get_base</span><span class="p">(</span><span class="n">_str</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get base (i.e. everything except extension) of string &quot;_str&quot;.</span>

<span class="sd">    Args:</span>
<span class="sd">        _str (str)</span>

<span class="sd">    Returns:</span>
<span class="sd">        base (str)</span>
<span class="sd">            base of _str</span>

<span class="sd">    Example:</span>
<span class="sd">        | &gt;&gt; get_base(&quot;random_plot.png&quot;)</span>
<span class="sd">        | &quot;random_plot&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">_str</span><span class="p">)</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">base</span> <span class="o">=</span> <span class="n">_str</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">base</span></div>


<div class="viewcode-block" id="get_extension"><a class="viewcode-back" href="../../../pyrexMD.misc.html#pyrexMD.misc.func.get_extension">[docs]</a><span class="k">def</span> <span class="nf">get_extension</span><span class="p">(</span><span class="n">_str</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get &quot;.ext&quot; (extension) of string &quot;_str&quot;.</span>

<span class="sd">    Args:</span>
<span class="sd">        _str (str)</span>

<span class="sd">    Returns:</span>
<span class="sd">        ext (str)</span>
<span class="sd">            extension of _str</span>

<span class="sd">    Example:</span>
<span class="sd">        | &gt;&gt; get_extension(&quot;random_plot.png&quot;)</span>
<span class="sd">        | &quot;.png&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">_str</span><span class="p">)</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">ext</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="o">+</span><span class="n">_str</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">ext</span></div>


<div class="viewcode-block" id="insert_str"><a class="viewcode-back" href="../../../pyrexMD.misc.html#pyrexMD.misc.func.insert_str">[docs]</a><span class="k">def</span> <span class="nf">insert_str</span><span class="p">(</span><span class="n">str1</span><span class="p">,</span> <span class="n">str2</span><span class="p">,</span> <span class="n">sep</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;after&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Insert str2 in str1.</span>

<span class="sd">    Args:</span>
<span class="sd">        str1 (str): base string</span>
<span class="sd">        str2 (str): append string</span>
<span class="sd">        sep (str): seperator</span>
<span class="sd">        loc (str): insert location: &#39;before&#39; or &#39;after&#39; first seperator in str1</span>

<span class="sd">    Returns:</span>
<span class="sd">        _str (str)</span>

<span class="sd">            new string</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">loc</span> <span class="o">==</span> <span class="s2">&quot;after&quot;</span><span class="p">:</span>
        <span class="n">_str</span> <span class="o">=</span> <span class="n">str1</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">sep</span> <span class="o">+</span> <span class="n">str2</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sep</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">str1</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="k">elif</span> <span class="n">loc</span> <span class="o">==</span> <span class="s2">&quot;before&quot;</span><span class="p">:</span>
        <span class="n">_str</span> <span class="o">=</span> <span class="n">str1</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">str2</span> <span class="o">+</span> <span class="n">sep</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sep</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">str1</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span><span class="s2">&quot;loc argument must be either &#39;before&#39; or &#39;after&#39;.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_str</span></div>


<div class="viewcode-block" id="autodetect_header"><a class="viewcode-back" href="../../../pyrexMD.misc.html#pyrexMD.misc.func.autodetect_header">[docs]</a><span class="k">def</span> <span class="nf">autodetect_header</span><span class="p">(</span><span class="n">fin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Autodetects header.</span>

<span class="sd">    Args:</span>
<span class="sd">        fin (str): input file (path)</span>

<span class="sd">    Returns:</span>
<span class="sd">        header_rows (int)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">header_rows</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">extension</span> <span class="o">=</span> <span class="n">get_extension</span><span class="p">(</span><span class="n">fin</span><span class="p">)</span>
    <span class="n">CHAR_SET</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2"> .,0123456789&quot;</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fin</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="n">n_lines</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">extension</span> <span class="o">==</span> <span class="s2">&quot;.pdb&quot;</span><span class="p">:</span>
                <span class="n">l</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
                <span class="k">if</span> <span class="n">l</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">():</span>
                    <span class="k">break</span>
                <span class="k">if</span> <span class="s2">&quot;ATOM&quot;</span> <span class="ow">in</span> <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]:</span>
                    <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">header_rows</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">l</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">l</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">CHAR_SET</span><span class="p">):</span>
                    <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">header_rows</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># check if header was found</span>
        <span class="k">if</span> <span class="n">n_lines</span> <span class="o">==</span> <span class="n">header_rows</span><span class="p">:</span>
            <span class="n">header_rows</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="n">header_rows</span></div>


<div class="viewcode-block" id="read_file"><a class="viewcode-back" href="../../../pyrexMD.misc.html#pyrexMD.misc.func.read_file">[docs]</a><span class="k">def</span> <span class="nf">read_file</span><span class="p">(</span><span class="n">fin</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">n_rows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Read file and return tuple of np.arrays with data for specified columns.</span>

<span class="sd">    Args:</span>
<span class="sd">        fin (str): input file (path)</span>
<span class="sd">        sep (None, str):</span>
<span class="sd">          | seperator of columns.</span>
<span class="sd">          | None: whitespace</span>
<span class="sd">        usecols (int, sequence): data columns</span>
<span class="sd">        n_rows (None, int): lenght of returned data (AFTER skipping rows)</span>
<span class="sd">        skiprows (None, &#39;auto&#39;, int):</span>
<span class="sd">          | ignore header rows of fin</span>
<span class="sd">          | &#39;auto&#39; or -1: auto detect</span>
<span class="sd">        dtype (dtype cls, list, tuple):</span>
<span class="sd">          | data type of returned np.array</span>
<span class="sd">          | dtype cls: all data types are same</span>
<span class="sd">          | list/tuple of dtype cls: specify dtype of each data column</span>
<span class="sd">          |</span>
<span class="sd">          | valid dtypes:</span>
<span class="sd">          |     str, int, float, complex</span>

<span class="sd">    Returns:</span>
<span class="sd">        data_array (array)</span>
<span class="sd">            if usecols is int ~ data of one column specified in usecols</span>
<span class="sd">        data_list (list)</span>
<span class="sd">            if usecols is list ~ data of each column specified in usecols</span>

<span class="sd">    Example:</span>
<span class="sd">        | # single columns per fin</span>
<span class="sd">        | X = read_file(&#39;data.txt&#39;, usecols=0)</span>
<span class="sd">        | Y = read_file(&#39;data.txt&#39;, usecols=1)</span>
<span class="sd">        | # multiple columns per fin</span>
<span class="sd">        | X,Y = read_file(&#39;data.txt&#39;, usecols=(0,1))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">skiprows</span> <span class="o">==</span> <span class="s2">&quot;auto&quot;</span> <span class="ow">or</span> <span class="n">skiprows</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">skiprows</span> <span class="o">=</span> <span class="n">autodetect_header</span><span class="p">(</span><span class="n">fin</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">skiprows</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">skiprows</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">usecols</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">fin</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="n">sep</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="n">skiprows</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="n">usecols</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">col</span><span class="p">[:</span><span class="n">n_rows</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">col</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">DATA</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">usecols</span><span class="p">)):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                <span class="n">col</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">fin</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="n">sep</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="n">skiprows</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="n">usecols</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">col</span> <span class="o">=</span> <span class="n">col</span><span class="p">[:</span><span class="n">n_rows</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">col</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">fin</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="n">sep</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="n">skiprows</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="n">usecols</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
                <span class="n">col</span> <span class="o">=</span> <span class="n">col</span><span class="p">[:</span><span class="n">n_rows</span><span class="p">]</span>
            <span class="n">DATA</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">DATA</span></div>


<div class="viewcode-block" id="read_DCA_file"><a class="viewcode-back" href="../../../pyrexMD.misc.html#pyrexMD.misc.func.read_DCA_file">[docs]</a><span class="k">def</span> <span class="nf">read_DCA_file</span><span class="p">(</span><span class="n">DCA_fin</span><span class="p">,</span> <span class="n">n_DCA</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">skiprows</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">filter_DCA</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">RES_range</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Read DCA file and return DCA pairs IJ.</span>

<span class="sd">    Args:</span>
<span class="sd">        DCA_fin (str): DCA input file (path)</span>
<span class="sd">        n_DCA (int): number of used DCA contacts</span>
<span class="sd">        usecols (tuple, list): columns containing the RES pairs in DCA_fin</span>
<span class="sd">        skiprows (&#39;auto&#39;, int):</span>
<span class="sd">          | ignore header rows of DCA_fin</span>
<span class="sd">          | &#39;auto&#39; or -1: auto detect</span>
<span class="sd">        filter_DCA (bool):</span>
<span class="sd">          | True: ignore DCA pairs with abs(i-j) &lt; 4</span>
<span class="sd">          | False: use all DCA pairs w/o applying filter</span>
<span class="sd">        RES_range (None):</span>
<span class="sd">          | Use RES within [RES_min, RES_max] range.</span>
<span class="sd">          | None: do not narrow down RES range</span>

<span class="sd">    Returns:</span>
<span class="sd">        DCA_PAIRS (list)</span>
<span class="sd">            DCA pairs IJ</span>
<span class="sd">        DCA_PAIRS_RES_range (list)</span>
<span class="sd">            [RES_min, RES_max] of DCA_PAIRS (not input RES_range values)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">I</span><span class="p">,</span> <span class="n">J</span> <span class="o">=</span> <span class="n">read_file</span><span class="p">(</span><span class="n">DCA_fin</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="n">usecols</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="n">skiprows</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int_</span><span class="p">)</span>
    <span class="n">DCA_PAIRS</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">RES_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">RES_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">I</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">J</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">RES_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">RES_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">I</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">J</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">I</span><span class="p">)):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">DCA_PAIRS</span><span class="p">)</span> <span class="o">==</span> <span class="n">n_DCA</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">if</span> <span class="n">filter_DCA</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">I</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">J</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
                <span class="k">pass</span>    <span class="c1"># ignore sites with indexdiff &lt; 4</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">I</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">RES_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">J</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">RES_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">DCA_PAIRS</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">I</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">J</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">DCA_PAIRS</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">I</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">J</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>

        <span class="n">DCA_PAIRS_RES_range</span> <span class="o">=</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">I</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">J</span><span class="p">)),</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">I</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">J</span><span class="p">))]</span>
    <span class="k">return</span> <span class="n">DCA_PAIRS</span><span class="p">,</span> <span class="n">DCA_PAIRS_RES_range</span></div>


<div class="viewcode-block" id="get_PDBid"><a class="viewcode-back" href="../../../pyrexMD.misc.html#pyrexMD.misc.func.get_PDBid">[docs]</a><span class="k">def</span> <span class="nf">get_PDBid</span><span class="p">(</span><span class="n">ref</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Obtains PDB id from ref by splitting its path and searching for alpha numerical (alnum) strings with length 4.</span>

<span class="sd">    Args:</span>
<span class="sd">        ref (str, universe, atomgrp): reference structure</span>

<span class="sd">    Returns:</span>
<span class="sd">        PDBid (str)</span>
<span class="sd">            if ref path contains one unique alnum string with length 4</span>
<span class="sd">        PDBid (list)</span>
<span class="sd">            if ref path contains multiple unique alnum strings with length 4</span>
<span class="sd">        None (None)</span>
<span class="sd">            else</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">ref</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span>
        <span class="n">ref</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span>
        <span class="n">split</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ref</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ref</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">universe</span><span class="o">.</span><span class="n">filename</span>
            <span class="n">ref</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span>
            <span class="n">ref</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span>
            <span class="n">split</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ref</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)]</span>

        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;get_PDBid(ref): AttributeError</span><span class="se">\</span>
<span class="s2">                 </span><span class="se">\n</span><span class="s2">Can&#39;t obtain PDBid since ref is neither a path nor a MDA universe/atomgrp with the attribute ref.universe.filename&quot;</span><span class="p">)</span>
            <span class="k">return</span>

    <span class="n">PDBid</span> <span class="o">=</span> <span class="p">[]</span>   <span class="c1"># list for guessed PDBids</span>
    <span class="n">split</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">split</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;logs&quot;</span><span class="p">,</span> <span class="s2">&quot;used&quot;</span><span class="p">,</span> <span class="s2">&quot;from&quot;</span><span class="p">,</span> <span class="s2">&quot;with&quot;</span><span class="p">,</span> <span class="s2">&quot;home&quot;</span><span class="p">]]</span>   <span class="c1"># filter guessed PDBids</span>

    <span class="c1"># search algorithm</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">split</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span> <span class="ow">and</span> <span class="n">item</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">and</span> <span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">PDBid</span><span class="p">:</span>
            <span class="n">PDBid</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">PDBid</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">PDBid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">PDBid</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;get_PDBid(ref): Warning</span><span class="se">\</span>
<span class="s2">             </span><span class="se">\n</span><span class="s2">Found multiple possible PDB ids by splitting the ref path.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">PDBid</span><span class="p">)</span>
        <span class="n">PDBid</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;Enter correct PDB id:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">PDBid</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;get_PDBid(ref): Warning</span><span class="se">\</span>
<span class="s2">             </span><span class="se">\n</span><span class="s2">No PDB id was found by splitting the ref path.&quot;</span><span class="p">)</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="print_table"><a class="viewcode-back" href="../../../pyrexMD.misc.html#pyrexMD.misc.func.print_table">[docs]</a><span class="k">def</span> <span class="nf">print_table</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[],</span> <span class="n">prec</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose_stop</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">warn</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Prints each item of &quot;data&quot; elementwise next to each other as a table.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (list of lists): table content, where each list corresponds to one column</span>
<span class="sd">        prec (None, int):</span>
<span class="sd">          | None: rounding off</span>
<span class="sd">          | int:  rounding on</span>
<span class="sd">        spacing (int):</span>
<span class="sd">          | spacing between columns (via &quot;&quot;.expandtabs(spacing))</span>
<span class="sd">          | 8: default \\t width</span>
<span class="sd">        dtype (None, dtype): dtype of table values after rounding</span>
<span class="sd">        verbose (bool): print table</span>
<span class="sd">        verbose_stop (None, int): stop printing after N lines.</span>
<span class="sd">        warn (bool): print/supress message  &quot;misc.print_table(): printed only N entries (set by verbose_stop parameter).&quot;</span>

<span class="sd">    Returns:</span>
<span class="sd">        table_str (str)</span>
<span class="sd">            table formatted string. Can be used to save log files.</span>

<span class="sd">    Example:</span>
<span class="sd">        | letters = [&quot;A&quot;, &quot;B&quot;, &quot;C&quot;]</span>
<span class="sd">        | numbers = [1, 2, 3]</span>
<span class="sd">        | table = misc.print_table([letters, numbers])</span>
<span class="sd">        | &gt;&gt;  A   1</span>
<span class="sd">        |     B   2</span>
<span class="sd">        |     C   3</span>
<span class="sd">        |</span>
<span class="sd">        | # save table as log file:</span>
<span class="sd">        | with open(&quot;table.log&quot;, &quot;w&quot;) as fout:</span>
<span class="sd">        |     fout.write(table)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># apply precision to input</span>
    <span class="k">if</span> <span class="n">prec</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">round_object</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="n">prec</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

    <span class="n">table_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">table_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ndx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">table_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">ndx</span><span class="p">])</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ndx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">table_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                               <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">ndx</span><span class="p">])</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ndx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">table_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                   <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">ndx</span><span class="p">])</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ndx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">table_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                       <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                       <span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="n">ndx</span><span class="p">])</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ndx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">table_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                           <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                           <span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="n">ndx</span><span class="p">])</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ndx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">table_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                               <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                               <span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                               <span class="n">data</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="n">ndx</span><span class="p">])</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ndx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">table_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                                   <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                                   <span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                                   <span class="n">data</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="n">ndx</span><span class="p">])</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ndx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">table_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                                       <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                                       <span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                                       <span class="n">data</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                                       <span class="n">data</span><span class="p">[</span><span class="mi">8</span><span class="p">][</span><span class="n">ndx</span><span class="p">])</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ndx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">table_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                                           <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                                           <span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                                           <span class="n">data</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span>
                                                                           <span class="n">data</span><span class="p">[</span><span class="mi">8</span><span class="p">][</span><span class="n">ndx</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">9</span><span class="p">][</span><span class="n">ndx</span><span class="p">])</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Extend code of </span><span class="si">{</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">print_table</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">() to work with more than 10 elements.&quot;</span><span class="p">)</span>

    <span class="n">table_str</span> <span class="o">=</span> <span class="n">table_str</span><span class="o">.</span><span class="n">expandtabs</span><span class="p">(</span><span class="n">spacing</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">table_str</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()[:</span><span class="n">verbose_stop</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose_stop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">table_str</span><span class="o">.</span><span class="n">splitlines</span><span class="p">())</span> <span class="o">&gt;=</span> <span class="n">verbose_stop</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">warn</span><span class="p">:</span>
                    <span class="n">cprint</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;misc.print_table(): printed only </span><span class="si">{</span><span class="n">verbose_stop</span><span class="si">}</span><span class="s2"> entries (set by verbose_stop parameter).&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">table_str</span></div>


<div class="viewcode-block" id="save_table"><a class="viewcode-back" href="../../../pyrexMD.misc.html#pyrexMD.misc.func.save_table">[docs]</a><span class="k">def</span> <span class="nf">save_table</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[],</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">default_dir</span><span class="o">=</span><span class="s2">&quot;./logs&quot;</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose_stop</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Executes misc.print_table() and saves the returned table string as a log file.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (list of lists): table content, where each list corresponds to one column</span>
<span class="sd">        filename (str): filename or realpath</span>
<span class="sd">        header (str): header for log file, e.g. column descriptions</span>
<span class="sd">        default_dir (str)</span>
<span class="sd">        prec (None, int):</span>
<span class="sd">          | None: rounding off</span>
<span class="sd">          | int:  rounding on</span>
<span class="sd">        verbose (bool)</span>
<span class="sd">        verbose_stop (None, int)</span>

<span class="sd">    Keyword Args:</span>
<span class="sd">        save_as (str): alias of filename</span>

<span class="sd">    Return:</span>
<span class="sd">        realpath (str)</span>
<span class="sd">            path to log file</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;save_as&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;save_as&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">filename</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;misc.save_table(): missing 1 required argument: &#39;filename&#39; or &#39;save_as&#39;&quot;</span><span class="p">)</span>

    <span class="n">ext</span> <span class="o">=</span> <span class="n">get_extension</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ext</span> <span class="o">!=</span> <span class="s2">&quot;.log&quot;</span><span class="p">:</span>
        <span class="n">filename</span> <span class="o">+=</span> <span class="s2">&quot;.log&quot;</span>
    <span class="n">realpath</span> <span class="o">=</span> <span class="n">joinpath</span><span class="p">(</span><span class="n">default_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">create_dir</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">realpath</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fout</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">header</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">fout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">header</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">ref_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">!=</span> <span class="n">ref_shape</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s1">&#39;save_table(): data consists of lists with unequal lengths.&#39;</span><span class="p">)</span>

        <span class="n">table_str</span> <span class="o">=</span> <span class="n">print_table</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">prec</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose_stop</span><span class="o">=</span><span class="n">verbose_stop</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">fout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">table_str</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="n">cprint</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saved logfile as: </span><span class="si">{</span><span class="n">realpath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">realpath</span></div>


<div class="viewcode-block" id="get_slice_indices"><a class="viewcode-back" href="../../../pyrexMD.misc.html#pyrexMD.misc.func.get_slice_indices">[docs]</a><span class="k">def</span> <span class="nf">get_slice_indices</span><span class="p">(</span><span class="n">list1</span><span class="p">,</span> <span class="n">list2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get slice indices of two lists (mainlist and sublist) where sublist is a</span>
<span class="sd">    slice of mainlist, e.g:</span>
<span class="sd">    sublist = mainlist[slice_ndx1:slice_ndx2]</span>

<span class="sd">    Args:</span>
<span class="sd">        list1 (list, array): mainlist or sublist</span>
<span class="sd">        list2 (list, array): mainlist or sublist</span>

<span class="sd">    Returns:</span>
<span class="sd">        slice_ndx1 (int)</span>
<span class="sd">            first slice index (&quot;start&quot;)</span>
<span class="sd">        slice_ndx2 (int)</span>
<span class="sd">            second slice index (&quot;end&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">list1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">list2</span><span class="p">):</span>
        <span class="n">mainlist</span> <span class="o">=</span> <span class="n">list1</span>
        <span class="n">sublist</span> <span class="o">=</span> <span class="n">list2</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">mainlist</span> <span class="o">=</span> <span class="n">list2</span>
        <span class="n">sublist</span> <span class="o">=</span> <span class="n">list1</span>

    <span class="c1"># find potential starting indices</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mainlist</span><span class="p">)</span>
    <span class="n">test_ndx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">test</span> <span class="o">==</span> <span class="n">sublist</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">ndx</span> <span class="ow">in</span> <span class="n">test_ndx</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">sublist</span> <span class="o">==</span> <span class="n">mainlist</span><span class="p">[</span><span class="n">ndx</span><span class="p">:</span><span class="n">ndx</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">sublist</span><span class="p">)]:</span>
            <span class="n">slice_ndx1</span> <span class="o">=</span> <span class="n">ndx</span>
            <span class="n">slice_ndx2</span> <span class="o">=</span> <span class="n">ndx</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">sublist</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">slice_ndx1</span><span class="p">,</span> <span class="n">slice_ndx2</span><span class="p">)</span>
    <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span><span class="s2">&quot;There is no sublist between list1 and list2. Slicing is not possible.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="get_cutoff_array"><a class="viewcode-back" href="../../../pyrexMD.misc.html#pyrexMD.misc.func.get_cutoff_array">[docs]</a><span class="k">def</span> <span class="nf">get_cutoff_array</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">cut_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cut_max</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies cutoff on array and returns array with values within cutoff range</span>
<span class="sd">    as well as the corresponding indices.</span>

<span class="sd">    Args:</span>
<span class="sd">        array (array/list)</span>
<span class="sd">        cut_min (None, int, float): min value for cutoff</span>
<span class="sd">        cut_max (None, int, float): max value for cutoff</span>

<span class="sd">    Returns:</span>
<span class="sd">        cutoff_array (array, list)</span>
<span class="sd">            array with values within cutoff</span>
<span class="sd">        cutoff_array_ndx (array, list)</span>
<span class="sd">            coresponding indices to map correctly</span>

<span class="sd">    Example:</span>
<span class="sd">        | array = list(range(10,20))</span>
<span class="sd">        | cut_min, cut_max = 12, 16</span>
<span class="sd">        | cutoff_array, cutoff_array_ndx = misc.get_cutoff_array(array, cut_min, cut_max)</span>
<span class="sd">        | print(cutoff_array)</span>
<span class="sd">        | &gt;&gt; [12, 13, 14, 15, 16]</span>
<span class="sd">        | print(cutoff_array_ndx)</span>
<span class="sd">        | &gt;&gt; [2, 3, 4, 5, 6]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># no cutoff</span>
    <span class="k">if</span> <span class="n">cut_min</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">cut_max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cutoff_array</span> <span class="o">=</span> <span class="n">array</span>
        <span class="n">cutoff_array_ndx</span> <span class="o">=</span> <span class="p">[</span><span class="n">ndx</span> <span class="k">for</span> <span class="n">ndx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">array</span><span class="p">)]</span>

    <span class="c1"># with cutoff</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">cut_min</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cut_min</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cut_max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cut_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
        <span class="n">cutoff_array</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">array</span> <span class="k">if</span> <span class="n">item</span> <span class="o">&gt;=</span> <span class="n">cut_min</span> <span class="k">if</span> <span class="n">item</span> <span class="o">&lt;=</span> <span class="n">cut_max</span><span class="p">]</span>
        <span class="n">cutoff_array_ndx</span> <span class="o">=</span> <span class="p">[</span><span class="n">ndx</span> <span class="k">for</span> <span class="n">ndx</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="k">if</span> <span class="n">item</span> <span class="o">&gt;=</span> <span class="n">cut_min</span> <span class="k">if</span> <span class="n">item</span> <span class="o">&lt;=</span> <span class="n">cut_max</span><span class="p">]</span>

    <span class="c1"># convert output to array if input was array</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">cutoff_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cutoff_array</span><span class="p">)</span>
        <span class="n">cutoff_array_ndx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cutoff_array_ndx</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">cutoff_array</span><span class="p">,</span> <span class="n">cutoff_array_ndx</span><span class="p">)</span></div>


<div class="viewcode-block" id="get_subarray_start_ndx"><a class="viewcode-back" href="../../../pyrexMD.misc.html#pyrexMD.misc.func.get_subarray_start_ndx">[docs]</a><span class="k">def</span> <span class="nf">get_subarray_start_ndx</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">subarray</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns start index of &lt;array&gt; at which &lt;subarray&gt; matches.</span>

<span class="sd">    Args:</span>
<span class="sd">        array (list, array)</span>
<span class="sd">        subarray (list, arr)</span>

<span class="sd">    Returns:</span>
<span class="sd">        start_ndx (None, int)</span>
<span class="sd">          | None: arrays do not match</span>
<span class="sd">          | int: starting index of &lt;array&gt; at which &lt;subarray&gt; matches</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">subarray</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;get_subarray_start(array, subarray): lenght(array) &lt; length(subarray).&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">array</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">subarray</span> <span class="o">=</span> <span class="n">subarray</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="n">ndx_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">))</span> <span class="k">if</span> <span class="n">array</span><span class="p">[</span><span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">subarray</span><span class="p">)]</span> <span class="o">==</span> <span class="n">subarray</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ndx_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">start_ndx</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">start_ndx</span> <span class="o">=</span> <span class="n">ndx_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">start_ndx</span></div>


<div class="viewcode-block" id="get_subarray"><a class="viewcode-back" href="../../../pyrexMD.misc.html#pyrexMD.misc.func.get_subarray">[docs]</a><span class="k">def</span> <span class="nf">get_subarray</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">ndx_sel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns subarray of &lt;array&gt; for items with indices &lt;ndx_sel&gt;.</span>

<span class="sd">    Args:</span>
<span class="sd">        array (array, list): array-like object</span>
<span class="sd">        ndx_sel (array, list): index selection</span>

<span class="sd">    Returns:</span>
<span class="sd">        subarray (array)</span>
<span class="sd">            subarray of array</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">subarray</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ndx</span> <span class="ow">in</span> <span class="n">ndx_sel</span><span class="p">:</span>
        <span class="n">subarray</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">ndx</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">subarray</span><span class="p">)</span></div>


<div class="viewcode-block" id="get_sorted_array"><a class="viewcode-back" href="../../../pyrexMD.misc.html#pyrexMD.misc.func.get_sorted_array">[docs]</a><span class="k">def</span> <span class="nf">get_sorted_array</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns sorted array (increasing order) and the coresponding element indices</span>
<span class="sd">    of the input array.</span>

<span class="sd">    Args:</span>
<span class="sd">        array (array, list): array-like object</span>

<span class="sd">    Returns:</span>
<span class="sd">        SORTED_VALUES (array)</span>
<span class="sd">            sorted array</span>
<span class="sd">        SORTED_NDX (array)</span>
<span class="sd">            corresponding indices</span>
<span class="sd">        reverse (bool):</span>
<span class="sd">          | False: ascending ranking order (low to high)</span>
<span class="sd">          | True:  decending ranking order (high to low)</span>
<span class="sd">        verbose (bool): print table with RANKED_VALUES, RANKED_NDX</span>

<span class="sd">    Keyword Args:</span>
<span class="sd">        prec(None, int):</span>
<span class="sd">          | None: rounding off</span>
<span class="sd">          | int:  rounding on</span>
<span class="sd">        spacing (int):</span>
<span class="sd">          | spacing between columns (via &quot;&quot;.expandtabs(spacing))</span>
<span class="sd">          | 8: default \\t width</span>
<span class="sd">        verbose_stop (None, int): stop printing after N lines</span>

<span class="sd">    Example:</span>
<span class="sd">        | &gt;&gt; A = np.array([1, 3, 2, 4])</span>
<span class="sd">        | &gt;&gt; get_sorted_array(A)</span>
<span class="sd">        | (array([1, 2, 3, 4]), array([0, 2, 1, 3]))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">reverse</span><span class="p">:</span>
        <span class="n">SORTED_ARRAY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
        <span class="n">SORTED_NDX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">SORTED_ARRAY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">array</span><span class="p">))</span>
        <span class="n">SORTED_NDX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">array</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="n">print_table</span><span class="p">([</span><span class="n">SORTED_ARRAY</span><span class="p">,</span> <span class="n">SORTED_NDX</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">SORTED_ARRAY</span><span class="p">,</span> <span class="n">SORTED_NDX</span><span class="p">)</span></div>


<div class="viewcode-block" id="get_ranked_array"><a class="viewcode-back" href="../../../pyrexMD.misc.html#pyrexMD.misc.func.get_ranked_array">[docs]</a><span class="k">def</span> <span class="nf">get_ranked_array</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns ranked array (decreasing order) and the corresponding element indices of the input array.</span>

<span class="sd">    Args:</span>
<span class="sd">        array (array, list): array-like object</span>
<span class="sd">        reverse (bool):</span>
<span class="sd">          | False: decending ranking order (high to low)</span>
<span class="sd">          | True:  ascending ranking order (low to high)</span>
<span class="sd">        verbose (bool): print table with RANKED_VALUES, RANKED_NDX</span>

<span class="sd">    Keyword Args:</span>
<span class="sd">        prec(None, int):</span>
<span class="sd">          | None: rounding off</span>
<span class="sd">          | int:  rounding on</span>
<span class="sd">        spacing (int):</span>
<span class="sd">          | spacing between columns (via &quot;&quot;.expandtabs(spacing))</span>
<span class="sd">          | 8: default \\t width</span>
<span class="sd">        verbose_stop (None, int): stop printing after N lines</span>

<span class="sd">    Returns:</span>
<span class="sd">        RANKED_VALUES (array)</span>
<span class="sd">            ranked values</span>
<span class="sd">        RANKED_NDX (array)</span>
<span class="sd">            corresponding indices</span>

<span class="sd">    Example:</span>
<span class="sd">        | &gt;&gt; A = np.array([1, 3, 2, 4])</span>
<span class="sd">        | &gt;&gt; get_ranked_array(A, verbose=False)</span>
<span class="sd">        | (array([4, 3, 2, 1]), array([3, 1, 2, 0]))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">reverse</span><span class="p">:</span>
        <span class="n">RANKED_ARRAY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
        <span class="n">RANKED_NDX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">RANKED_ARRAY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">array</span><span class="p">))</span>
        <span class="n">RANKED_NDX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">array</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="n">print_table</span><span class="p">([</span><span class="n">RANKED_ARRAY</span><span class="p">,</span> <span class="n">RANKED_NDX</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">RANKED_ARRAY</span><span class="p">,</span> <span class="n">RANKED_NDX</span><span class="p">)</span></div>


<div class="viewcode-block" id="get_quantile"><a class="viewcode-back" href="../../../pyrexMD.misc.html#pyrexMD.misc.func.get_quantile">[docs]</a><span class="k">def</span> <span class="nf">get_quantile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Alias function of np.quantile(). Get value (or score) below which p% of the</span>
<span class="sd">    observations may be found.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (array-like)</span>
<span class="sd">        p (int, float): percent value ~ range 0-1</span>
<span class="sd">        prec (None, int): rounding precision</span>

<span class="sd">    Returns:</span>
<span class="sd">        quantile (int, float)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">quantile</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">prec</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">quantile</span></div>


<div class="viewcode-block" id="get_percentile"><a class="viewcode-back" href="../../../pyrexMD.misc.html#pyrexMD.misc.func.get_percentile">[docs]</a><span class="k">def</span> <span class="nf">get_percentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Alias function of np.percentile(). Get value (or score) below which p% of</span>
<span class="sd">    the observations may be found.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (array-like)</span>
<span class="sd">        p (int, float): percent value ~ range 0-100</span>
<span class="sd">        prec (None, int): rounding precision</span>

<span class="sd">    Returns:</span>
<span class="sd">        percentile (int, float)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">percentile</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">prec</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">percentile</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, KIT-MBS.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>